
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.3. Statistical Mechanics: Ensembles, Ergodicity, and Other Stuff &#8212; Atomistic Scale Simulations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/image_dark_mode.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myadmonitions.css?v=5b3d7684" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=80cd6c28" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"d": ["{\\operatorname{d}\\!{#1}}", 1], "dd": ["{\\d{}^{#1} #2 \\over \\d{#3}^{#1}}", 3], "pp": ["{\\partial^{#1} #2 \\over \\partial #3^{#1}}", 3], "td": ["{\\left(\\pp{#1}{#2}{#3} \\right)_{#4}}", 4], "ubar": ["\\underline{#1}", 1], "vv": ["\\mathbf{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'statmech-thermo/statmech-ergodicity';</script>
    <link rel="canonical" href="https://stattlab.github.io/atomistic-scale-simulations/statmech-thermo/statmech-ergodicity.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.4. Thermodyanmics Properties" href="thermodynamic-properties.html" />
    <link rel="prev" title="3.2. Thermodyanmics and Ensembles" href="ensembles.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Atomistic Scale Simulations</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/index.html">1. Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/why-atomistic-scale.html">1.1. Why are we interested in the atomistic scale?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/what-are-simulations.html">1.2. What are Simulations?</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecular-models-and-interactions/index.html">2. Molecular Models and Interactions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/molecular-models.html">2.2. Molecular Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/periodic-boundary-conditions.html">2.3. Periodic Boundary Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/intramolecular-potentials.html">2.4. Intermolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/short-ranged-potentials.html">2.5. Short-Ranged Intramolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/electrostatics.html">2.6. Long-Range Potentials</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">3. Statistical Mechanics and Thermodynamics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">3.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensembles.html">3.2. Thermodyanmics and Ensembles</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.3. Statistical Mechanics: Ensembles, Ergodicity, and Other Stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermodynamic-properties.html">3.4. Thermodyanmics Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="entropy-temperature.html">3.5. Entropy and Temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="structural-correlations.html">3.6. Structural Correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="transport-coefficients.html">3.7. Transport Coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="statistical-errors.html">3.8. Statistical Errors</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecular-dynamics/index.html">4. Molecular Dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/introduction.html">4.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/verlet-integration.html">4.2. Verlet Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/thermostats.html">4.3. Thermostats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/langevin-dynamics.html">4.4. Langevin Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/md-packages.html">4.5. Using MD Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/neighbor-list.html">4.6. Initialization and Neighbor Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/high-performance-computing.html">4.7. HPC (High-Performance Computing)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../monte-carlo/index.html">5. Monte Carlo Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/introduction.html">5.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/random-numbers.html">5.2. Random Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/monte-carlo-method.html">5.3. Monte Carlo Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/sampling.html">5.4. Sampling Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/phase-coexistence.html">5.5. Gibbs Ensemble and Phase Coexistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/finite-size.html">5.6. Phase Transitions, Finite-size Scaling and Renormalization Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/variance-reduction.html">5.7. Variance Reduction Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/metropolis.html">5.8. Metropolis Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/ising-model.html">5.9. The Ising Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/directed-mc.html">5.10. Directed Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/kinetic-mc.html">5.11. Kinetic Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/free-energy-from-sims.html">5.12. Free Energy Estimation in Simulations</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../references/references.html">6. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">7. Credits</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations/issues/new?title=Issue%20on%20page%20%2Fstatmech-thermo/statmech-ergodicity.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/statmech-thermo/statmech-ergodicity.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Statistical Mechanics: Ensembles, Ergodicity, and Other Stuff</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-macrostates-and-phase-space">3.3.1. Microstates, macrostates, and phase space</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-gas-in-a-box">3.3.1.1. Example: gas in a box</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble">3.3.1.2. Ensemble</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#density-of-states-entropy-and-temperature">3.3.2. Density of states, entropy, and temperature</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-ideal-gas-very-briefly">3.3.2.1. Example: ideal gas (very briefly)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-microcanonical-nve-ensemble">3.3.3. The microcanonical (NVE) ensemble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-nve-md-of-a-lennardjones-fluid">3.3.3.1. Example: NVE MD of a Lennard–Jones fluid</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-canonical-nvt-ensemble-and-the-partition-function">3.3.4. The canonical (NVT) ensemble and the partition function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-ideal-gas-in-the-canonical-ensemble">3.3.4.1. Example: ideal gas in the canonical ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-fluctuations-in-the-canonical-ensemble">3.3.4.2. Energy fluctuations in the canonical ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nvt-in-practice-thermostats">3.3.4.3. NVT in practice: thermostats</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-standard-ensembles">3.3.5. Other standard ensembles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#isothermalisobaric-npt-ensemble">3.3.5.1. Isothermal–isobaric (NPT) ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#npt-in-practice-barostats">3.3.5.2. NPT in practice: barostats</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grand-canonical-muvt-ensemble-very-briefly">3.3.5.3. Grand canonical (<span class="math notranslate nohighlight">\(\mu\)</span>VT) ensemble (very briefly)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classical-limit-and-maxwellboltzmann-distribution">3.3.6. Classical limit and Maxwell–Boltzmann distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-particle-velocity-distribution">3.3.6.1. One-particle velocity distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averages-vs-ensemble-averages">3.3.7. Time averages vs ensemble averages</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-average">3.3.7.1. Ensemble average</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-average">3.3.7.2. Time average</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-pressure-from-md">3.3.7.3. Example: pressure from MD</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ergodic-hypothesis">3.3.8. The ergodic hypothesis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mixing-and-decorrelation">3.3.8.1. Mixing and decorrelation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-ergodic-behavior-and-glasses">3.3.9. Non-ergodic behavior and glasses</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy-example-double-well-potential">3.3.9.1. Toy example: double-well potential</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contact-with-a-heat-bath-thermostats-and-monte-carlo">3.3.10. Contact with a heat bath: thermostats and Monte Carlo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-issues-equilibration-windowing-and-diagnostics">3.3.11. Practical issues: equilibration, windowing, and diagnostics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">3.3.12. Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">3.3.13. References</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">3.3.13.1. Further reading</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="statistical-mechanics-ensembles-ergodicity-and-other-stuff">
<h1><span class="section-number">3.3. </span>Statistical Mechanics: Ensembles, Ergodicity, and Other Stuff<a class="headerlink" href="#statistical-mechanics-ensembles-ergodicity-and-other-stuff" title="Link to this heading">#</a></h1>
<p>The physical foundation of molecular simulations is <em>statistical mechanics</em>. Without it, it would be impossible to connect small systems (at most <span class="math notranslate nohighlight">\(10^3\)</span>–<span class="math notranslate nohighlight">\(10^7\)</span> particles, simulated for nanoseconds to microseconds) to macroscopic thermodynamic quantities like pressure, temperature, or heat capacities that we measure in the lab. Statistical mechanics provides the bridge between:</p>
<ul class="simple">
<li><p><strong>Microscopic variables:</strong> positions and momenta of all particles in a simulation box.</p></li>
<li><p><strong>Macroscopic variables:</strong> <span class="math notranslate nohighlight">\(N\)</span>, <span class="math notranslate nohighlight">\(V\)</span>, <span class="math notranslate nohighlight">\(E\)</span>, <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(\mu\)</span>, etc.</p></li>
</ul>
<p>In simulations we always control a small, model system, often with periodic boundary conditions, and ask: <em>If we sample microscopic states in the right ensemble, can we recover correct thermodynamic averages?</em> In other words, can we use a few hundred or thousand atoms as a faithful representative of a macroscopic material containing Avogadro’s number of atoms?</p>
<section id="microstates-macrostates-and-phase-space">
<h2><span class="section-number">3.3.1. </span>Microstates, macrostates, and phase space<a class="headerlink" href="#microstates-macrostates-and-phase-space" title="Link to this heading">#</a></h2>
<p>Consider a classical system of <span class="math notranslate nohighlight">\(N\)</span> particles. The complete microscopic state is specified by all positions and all momenta:</p>
<div class="math notranslate nohighlight">
\[
\Gamma = (\underbrace{\mathbf{r}_1,\dots,\mathbf{r}_N}_{3N\ \text{coordinates}};\, \underbrace{\mathbf{p}_1,\dots,\mathbf{p}_N}_{3N\ \text{momenta}}),
\]</div>
<p>so the phase space has dimension <span class="math notranslate nohighlight">\(6N\)</span>. A single point <span class="math notranslate nohighlight">\(\Gamma\)</span> in this phase space is a <strong>microstate</strong>.</p>
<p>A <strong>macrostate</strong> is defined by a few thermodynamic constraints, e.g.</p>
<div class="math notranslate nohighlight">
\[
(N,V,E) \quad \text{or} \quad (N,V,T), \quad \text{etc.}
\]</div>
<p>Many different microstates <span class="math notranslate nohighlight">\(\Gamma\)</span> are compatible with the same macrostate. For example, keeping <span class="math notranslate nohighlight">\((N,V,E)\)</span> fixed, we can rearrange particles and redistribute momenta in many ways while keeping the total energy unchanged. All such microstates belong to the same <em>ensemble</em>.</p>
<section id="example-gas-in-a-box">
<h3><span class="section-number">3.3.1.1. </span>Example: gas in a box<a class="headerlink" href="#example-gas-in-a-box" title="Link to this heading">#</a></h3>
<p>Imagine <span class="math notranslate nohighlight">\(N\)</span> argon atoms in a cubic box of volume <span class="math notranslate nohighlight">\(V\)</span> with perfectly reflecting walls. Specifying the total energy <span class="math notranslate nohighlight">\(E\)</span> and the number of atoms <span class="math notranslate nohighlight">\(N\)</span> defines a macrostate <span class="math notranslate nohighlight">\((N,V,E)\)</span>. One microstate might have half the atoms on the left side and half on the right; another microstate might have a different spatial arrangement and momentum distribution, but as long as the total energy is <span class="math notranslate nohighlight">\(E\)</span>, both microstates correspond to the same macrostate.</p>
</section>
<section id="ensemble">
<h3><span class="section-number">3.3.1.2. </span>Ensemble<a class="headerlink" href="#ensemble" title="Link to this heading">#</a></h3>
<p>An ensemble is a (conceptual) collection of all microstates consistent with a specified set of macroscopic constraints (e.g. fixed <span class="math notranslate nohighlight">\(N\)</span>, <span class="math notranslate nohighlight">\(V\)</span>, <span class="math notranslate nohighlight">\(E\)</span> in the microcanonical ensemble). In a simulation, we aim to <em>sample</em> microstates from the correct ensemble, either by deterministic dynamics (MD) or stochastic algorithms (Monte Carlo, Langevin, etc.). The ensemble perspective is powerful because it allows us to replace complicated, history-dependent dynamics by simpler probabilistic descriptions.</p>
</section>
</section>
<section id="density-of-states-entropy-and-temperature">
<h2><span class="section-number">3.3.2. </span>Density of states, entropy, and temperature<a class="headerlink" href="#density-of-states-entropy-and-temperature" title="Link to this heading">#</a></h2>
<p>For a system with fixed <span class="math notranslate nohighlight">\(N\)</span> and <span class="math notranslate nohighlight">\(V\)</span>, the <strong>density of states</strong> (or number of states) at energy <span class="math notranslate nohighlight">\(E\)</span> is usually denoted by <span class="math notranslate nohighlight">\(\Omega(E)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\Omega(E) \equiv \sum_{\Gamma} \delta\bigl(E(\Gamma) - E\bigr),
\]</div>
<p>where the sum is over all microstates <span class="math notranslate nohighlight">\(\Gamma\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span> is a Dirac delta (or a Kronecker delta for discrete spectra). In words, <span class="math notranslate nohighlight">\(\Omega(E)\)</span> counts how many microstates have total energy <span class="math notranslate nohighlight">\(E\)</span>.</p>
<p>The <strong>microcanonical entropy</strong> is then defined as</p>
<div class="math notranslate nohighlight">
\[
S(E,N,V) = k_{\mathrm{B}} \ln \Omega(E,N,V),
\]</div>
<p>where <span class="math notranslate nohighlight">\(k_{\mathrm{B}}\)</span> is Boltzmann’s constant. From this, the <strong>temperature</strong> <span class="math notranslate nohighlight">\(T\)</span> follows as</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{T} = \left(\frac{\partial S}{\partial E}\right)_{N,V}.
\]</div>
<p>Intuitively:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Omega(E)\)</span> measures <em>how many</em> microstates are compatible with the macroscopic constraints.</p></li>
<li><p><span class="math notranslate nohighlight">\(S(E)\)</span> measures <em>how much uncertainty</em> we have about the microscopic configuration if we only know <span class="math notranslate nohighlight">\(E\)</span>, <span class="math notranslate nohighlight">\(N\)</span>, and <span class="math notranslate nohighlight">\(V\)</span>.</p></li>
</ul>
<section id="example-ideal-gas-very-briefly">
<h3><span class="section-number">3.3.2.1. </span>Example: ideal gas (very briefly)<a class="headerlink" href="#example-ideal-gas-very-briefly" title="Link to this heading">#</a></h3>
<p>For a monatomic ideal gas, <span class="math notranslate nohighlight">\(\Omega(E)\)</span> can be computed analytically and grows roughly like <span class="math notranslate nohighlight">\(E^{3N/2}\)</span>. Plugging this into <span class="math notranslate nohighlight">\(S(E) = k_{\mathrm{B}}\ln\Omega(E)\)</span> and differentiating with respect to <span class="math notranslate nohighlight">\(E\)</span> directly gives the familiar relation</p>
<div class="math notranslate nohighlight">
\[
U = \langle E \rangle = \frac{3}{2} N k_{\mathrm{B}} T,
\]</div>
<p>which is the equipartition result for an ideal gas.</p>
</section>
</section>
<section id="the-microcanonical-nve-ensemble">
<h2><span class="section-number">3.3.3. </span>The microcanonical (NVE) ensemble<a class="headerlink" href="#the-microcanonical-nve-ensemble" title="Link to this heading">#</a></h2>
<p>The simplest ensemble, and the easiest one to simulate, is the microcanonical or NVE ensemble:</p>
<div class="math notranslate nohighlight">
\[
N = \text{const}, \quad V = \text{const}, \quad E = \text{const}.
\]</div>
<p>Think of an isolated system: fixed number of particles, fixed volume, and fixed energy. At thermodynamic equilibrium, <em>all accessible microstates with the same total energy are (assumed to be) equally likely</em>. This is the fundamental postulate of the microcanonical ensemble.</p>
<p>Mathematically, the microcanonical partition function (often denoted <span class="math notranslate nohighlight">\(\Omega\)</span>) is</p>
<div class="math notranslate nohighlight">
\[
\Omega(E,N,V) = \sum_{\Gamma} \delta\bigl(E(\Gamma) - E\bigr),
\]</div>
<p>and the probability of a microstate <span class="math notranslate nohighlight">\(\Gamma\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
P(\Gamma) = 
\begin{cases}
  \dfrac{1}{\Omega(E,N,V)}, &amp; \text{if } E(\Gamma) = E,\\[6pt]
  0, &amp; \text{otherwise}.
\end{cases}
\end{split}\]</div>
<p>An ensemble average of an observable <span class="math notranslate nohighlight">\(A(\Gamma)\)</span> is then</p>
<div class="math notranslate nohighlight">
\[
\langle A \rangle_{\mathrm{NVE}} 
= \frac{1}{\Omega(E,N,V)}\sum_{\Gamma} A(\Gamma)\,\delta\bigl(E(\Gamma) - E\bigr).
\]</div>
<p>In molecular dynamics, a pure NVE simulation corresponds to integrating Newton’s equations of motion with no thermostat or barostat, so that total energy is (up to numerical error) conserved.</p>
<section id="example-nve-md-of-a-lennardjones-fluid">
<h3><span class="section-number">3.3.3.1. </span>Example: NVE MD of a Lennard–Jones fluid<a class="headerlink" href="#example-nve-md-of-a-lennardjones-fluid" title="Link to this heading">#</a></h3>
<p>A standard textbook example is a box of particles interacting via the Lennard–Jones potential. After an initial equilibration, one can switch to an NVE run and monitor the total energy <span class="math notranslate nohighlight">\(E = K + U\)</span>:</p>
<ul class="simple">
<li><p>The kinetic energy <span class="math notranslate nohighlight">\(K\)</span> and potential energy <span class="math notranslate nohighlight">\(U\)</span> fluctuate in time.</p></li>
<li><p>The <em>sum</em> <span class="math notranslate nohighlight">\(E\)</span> remains constant, showing that the dynamics stays on the constant-energy surface in phase space.</p></li>
<li><p>Time averages of observables (pressure, structure factor, etc.) estimate microcanonical ensemble averages.</p></li>
</ul>
</section>
</section>
<section id="the-canonical-nvt-ensemble-and-the-partition-function">
<h2><span class="section-number">3.3.4. </span>The canonical (NVT) ensemble and the partition function<a class="headerlink" href="#the-canonical-nvt-ensemble-and-the-partition-function" title="Link to this heading">#</a></h2>
<p>Most real systems are not isolated; they are in contact with a <em>heat bath</em> that can exchange energy, but not particles, with the system. This motivates the canonical (NVT) ensemble:</p>
<div class="math notranslate nohighlight">
\[
N = \text{const}, \quad V = \text{const}, \quad T = \text{const}.
\]</div>
<p>Consider a small system (our simulation box) weakly coupled to a large heat bath. If the total energy is <span class="math notranslate nohighlight">\(E_{\mathrm{tot}} = E_{\mathrm{sys}} + E_{\mathrm{bath}}\)</span>, then the probability that the system is in a microstate <span class="math notranslate nohighlight">\(i\)</span> with energy <span class="math notranslate nohighlight">\(E_i\)</span> is proportional to the number of bath states compatible with <span class="math notranslate nohighlight">\(E_{\mathrm{bath}} = E_{\mathrm{tot}} - E_i\)</span>. Maximizing the total entropy of system + bath leads to the <strong>Boltzmann distribution</strong>:</p>
<div class="math notranslate nohighlight">
\[
P_i = \frac{\exp(-\beta E_i)}{Z},
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
\beta = \frac{1}{k_{\mathrm{B}}T}, 
\qquad 
Z = \sum_{i} \exp(-\beta E_i)
\]</div>
<p>is the <strong>canonical partition function</strong>.</p>
<p>The partition function <span class="math notranslate nohighlight">\(Z\)</span> plays several roles:</p>
<ul class="simple">
<li><p>It is a <em>normalization constant</em>: <span class="math notranslate nohighlight">\(\sum_i P_i = 1.\)</span></p></li>
<li><p>It encodes the density of states and the Boltzmann weights of all microstates.</p></li>
<li><p>From <span class="math notranslate nohighlight">\(Z\)</span>, one can compute almost all thermodynamic properties.</p></li>
</ul>
<p>For an observable <span class="math notranslate nohighlight">\(A\)</span> that takes the value <span class="math notranslate nohighlight">\(A_i\)</span> in microstate <span class="math notranslate nohighlight">\(i\)</span>, the canonical ensemble average is</p>
<div class="math notranslate nohighlight">
\[
\langle A \rangle_{\mathrm{NVT}}
= \sum_{i} P_i A_i
= \frac{1}{Z}\sum_{i} A_i \exp(-\beta E_i).
\]</div>
<p>It is often more convenient to work with the <strong>Helmholtz free energy</strong></p>
<div class="math notranslate nohighlight">
\[
F(N,V,T) = -k_{\mathrm{B}} T \ln Z,
\]</div>
<p>which is an <em>extensive</em> quantity (scales with system size) and is directly related to <span class="math notranslate nohighlight">\(Z\)</span>. Thermodynamic quantities follow from derivatives of <span class="math notranslate nohighlight">\(F\)</span>, e.g.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
p &amp;= -\left(\frac{\partial F}{\partial V}\right)_{N,T},\\
S &amp;= -\left(\frac{\partial F}{\partial T}\right)_{N,V},\\
\mu &amp;= \left(\frac{\partial F}{\partial N}\right)_{V,T}.
\end{aligned}
\end{split}\]</div>
<section id="example-ideal-gas-in-the-canonical-ensemble">
<h3><span class="section-number">3.3.4.1. </span>Example: ideal gas in the canonical ensemble<a class="headerlink" href="#example-ideal-gas-in-the-canonical-ensemble" title="Link to this heading">#</a></h3>
<p>For a monatomic ideal gas of identical particles with mass <span class="math notranslate nohighlight">\(m\)</span>, the canonical partition function factorizes into momentum and configuration parts. One finds</p>
<div class="math notranslate nohighlight">
\[
Z_{\text{ideal}}(N,V,T)
= \frac{1}{N!}\left(\frac{V}{\Lambda^3}\right)^N,
\qquad
\Lambda = \frac{h}{\sqrt{2\pi m k_{\mathrm{B}}T}}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Lambda\)</span> is the thermal de~Broglie wavelength. From this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
F &amp;= -k_{\mathrm{B}}T \ln Z_{\text{ideal}}
  = -Nk_{\mathrm{B}}T \left[\ln\left(\frac{V}{N\Lambda^3}\right) + 1\right],\\
p &amp;= -\left(\frac{\partial F}{\partial V}\right)_{N,T}
   = \frac{Nk_{\mathrm{B}}T}{V},\\
U &amp;= -\frac{\partial}{\partial \beta}\ln Z_{\text{ideal}}
   = \frac{3}{2}Nk_{\mathrm{B}}T,\\
C_V &amp;= \left(\frac{\partial U}{\partial T}\right)_{V}
     = \frac{3}{2}Nk_{\mathrm{B}}.
\end{aligned}
\end{split}\]</div>
<p>This reproduces the ideal gas law and the equipartition theorem directly from the canonical partition function.</p>
</section>
<section id="energy-fluctuations-in-the-canonical-ensemble">
<h3><span class="section-number">3.3.4.2. </span>Energy fluctuations in the canonical ensemble<a class="headerlink" href="#energy-fluctuations-in-the-canonical-ensemble" title="Link to this heading">#</a></h3>
<p>In the canonical ensemble the energy is not fixed but fluctuates around its mean value <span class="math notranslate nohighlight">\(\langle E\rangle\)</span>. The variance of the energy can be expressed as</p>
<div class="math notranslate nohighlight">
\[
\mathrm{Var}(E) = \langle E^2\rangle - \langle E\rangle^2
= k_{\mathrm{B}}T^2 C_V,
\]</div>
<p>where <span class="math notranslate nohighlight">\(C_V\)</span> is the heat capacity at constant volume. The <em>relative</em> fluctuations scale as</p>
<div class="math notranslate nohighlight">
\[
\frac{\sqrt{\mathrm{Var}(E)}}{\langle E\rangle} \sim \frac{1}{\sqrt{N}},
\]</div>
<p>so for macroscopic systems (very large <span class="math notranslate nohighlight">\(N\)</span>) these fluctuations are negligible, but for simulations with modest <span class="math notranslate nohighlight">\(N\)</span> they are visible and physically important.</p>
</section>
<section id="nvt-in-practice-thermostats">
<h3><span class="section-number">3.3.4.3. </span>NVT in practice: thermostats<a class="headerlink" href="#nvt-in-practice-thermostats" title="Link to this heading">#</a></h3>
<p>In MD, we construct dynamics whose invariant probability distribution is the canonical one, <span class="math notranslate nohighlight">\(P(\Gamma)\propto e^{-\beta H(\Gamma)}\)</span>. Popular examples include:</p>
<ul class="simple">
<li><p>Nosé–Hoover and Nosé–Hoover chains (deterministic thermostats).</p></li>
<li><p>Langevin dynamics (stochastic thermostat; see below).</p></li>
<li><p>Stochastic velocity rescaling and related schemes.</p></li>
</ul>
<p>These methods modify the equations of motion so that time-averaged observables converge to canonical ensemble averages.</p>
</section>
</section>
<section id="other-standard-ensembles">
<h2><span class="section-number">3.3.5. </span>Other standard ensembles<a class="headerlink" href="#other-standard-ensembles" title="Link to this heading">#</a></h2>
<p>Real simulations often use other ensembles, depending on what is held fixed and what is allowed to fluctuate:</p>
<ul class="simple">
<li><p><strong>Isothermal–isobaric (NPT):</strong> <span class="math notranslate nohighlight">\(N\)</span>, <span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(T\)</span> fixed; <span class="math notranslate nohighlight">\(V\)</span> fluctuates.</p></li>
<li><p><strong>Grand canonical (<span class="math notranslate nohighlight">\(\mu\)</span>VT):</strong> chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(V\)</span>, <span class="math notranslate nohighlight">\(T\)</span> fixed; <span class="math notranslate nohighlight">\(N\)</span> fluctuates.</p></li>
</ul>
<p>Formally, these ensembles have their own partition functions (e.g. <span class="math notranslate nohighlight">\(Z_{NPT}\)</span>, <span class="math notranslate nohighlight">\(\Xi_{\mu VT}\)</span>) obtained by summing over the appropriate variables. In practice, MD codes implement NPT or <span class="math notranslate nohighlight">\(\mu\)</span>VT via barostats and particle-insertion/removal schemes that are designed to sample the correct distribution.</p>
<section id="isothermalisobaric-npt-ensemble">
<h3><span class="section-number">3.3.5.1. </span>Isothermal–isobaric (NPT) ensemble<a class="headerlink" href="#isothermalisobaric-npt-ensemble" title="Link to this heading">#</a></h3>
<p>In the NPT ensemble we imagine our system in contact with:</p>
<ul class="simple">
<li><p>a large heat bath at temperature <span class="math notranslate nohighlight">\(T\)</span>, and</p></li>
<li><p>a mechanical reservoir that fixes the external pressure <span class="math notranslate nohighlight">\(p\)</span> but allows the volume <span class="math notranslate nohighlight">\(V\)</span> to fluctuate.</p></li>
</ul>
<p>The NPT partition function is</p>
<div class="math notranslate nohighlight">
\[
\Delta(N,p,T)
= \int_0^{\infty} \mathrm{d}V\, e^{-\beta pV}\, Z(N,V,T),
\]</div>
<p>where <span class="math notranslate nohighlight">\(Z(N,V,T)\)</span> is the canonical partition function at fixed <span class="math notranslate nohighlight">\(N,V,T\)</span>. The equilibrium probability density of observing a particular volume <span class="math notranslate nohighlight">\(V\)</span> and microstate <span class="math notranslate nohighlight">\(i\)</span> (with energy <span class="math notranslate nohighlight">\(E_i(V)\)</span>) is then</p>
<div class="math notranslate nohighlight">
\[
P(i,V) = \frac{1}{\Delta(N,p,T)} e^{-\beta\bigl(E_i(V) + pV\bigr)}.
\]</div>
<p>The corresponding thermodynamic potential is the <strong>Gibbs free energy</strong>,</p>
<div class="math notranslate nohighlight">
\[
G(N,p,T) = -k_{\mathrm{B}}T \ln \Delta(N,p,T).
\]</div>
<p>From <span class="math notranslate nohighlight">\(G\)</span> we obtain:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\langle V \rangle &amp;= \left(\frac{\partial G}{\partial p}\right)_{N,T},\\
\kappa_T &amp;\equiv -\frac{1}{\langle V\rangle}
\left(\frac{\partial \langle V\rangle}{\partial p}\right)_{N,T}
= \frac{\beta}{\langle V\rangle}\bigl(\langle V^2\rangle - \langle V\rangle^2\bigr),
\end{aligned}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\kappa_T\)</span> is the isothermal compressibility. Thus, volume fluctuations in an NPT simulation are directly related to the material’s compressibility.</p>
</section>
<section id="npt-in-practice-barostats">
<h3><span class="section-number">3.3.5.2. </span>NPT in practice: barostats<a class="headerlink" href="#npt-in-practice-barostats" title="Link to this heading">#</a></h3>
<p>To realize the NPT ensemble in MD, we introduce a <em>barostat</em> that allows the box volume (and sometimes shape) to fluctuate. Standard algorithms include:</p>
<ul class="simple">
<li><p>Berendsen barostat (simple, but does not sample the correct distribution exactly).</p></li>
<li><p>Andersen, Parrinello–Rahman, or Martyna–Tobias–Klein (MTK) barostats, which are more rigorous.</p></li>
</ul>
<p>These methods, when combined with a thermostat, generate dynamics whose stationary distribution is the NPT distribution. In an MD input file, this typically appears as a directive like <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">barostat</span> <span class="pre">=</span> <span class="pre">NPT</span></code> with target pressure and temperature.</p>
</section>
<section id="grand-canonical-muvt-ensemble-very-briefly">
<h3><span class="section-number">3.3.5.3. </span>Grand canonical (<span class="math notranslate nohighlight">\(\mu\)</span>VT) ensemble (very briefly)<a class="headerlink" href="#grand-canonical-muvt-ensemble-very-briefly" title="Link to this heading">#</a></h3>
<p>In the grand canonical ensemble the system is allowed to exchange particles with a reservoir at fixed chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\Xi(\mu,V,T) = \sum_{N=0}^{\infty} e^{\beta \mu N} Z(N,V,T),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
P(N,i) = \frac{1}{\Xi(\mu,V,T)} e^{-\beta\bigl(E_i(N,V) - \mu N\bigr)}.
\]</div>
<p>Here <span class="math notranslate nohighlight">\(N\)</span> fluctuates, which is useful when studying adsorption, phase coexistence, or open systems. In simulations this is usually realized via Monte Carlo particle insertions and deletions rather than pure MD.</p>
</section>
</section>
<section id="classical-limit-and-maxwellboltzmann-distribution">
<h2><span class="section-number">3.3.6. </span>Classical limit and Maxwell–Boltzmann distribution<a class="headerlink" href="#classical-limit-and-maxwellboltzmann-distribution" title="Link to this heading">#</a></h2>
<p>In the classical limit, the canonical partition function can be written as an integral over phase space:</p>
<div class="math notranslate nohighlight">
\[
Z = \frac{1}{h^{3N}N!}
    \int \mathrm{d}^{3N}q\,\mathrm{d}^{3N}p\;
    \exp\bigl[-\beta H(\mathbf{q},\mathbf{p})\bigr],
\]</div>
<p>where <span class="math notranslate nohighlight">\(H = K + U\)</span> is the Hamiltonian (kinetic plus potential energy). If <span class="math notranslate nohighlight">\(H(\mathbf{q},\mathbf{p}) = K(\mathbf{p}) + U(\mathbf{q})\)</span>, then the integrals factor:</p>
<div class="math notranslate nohighlight">
\[
Z = \frac{1}{h^{3N}N!}
    \left(\int \mathrm{d}^{3N}p\,\exp[-\beta K(\mathbf{p})]\right)
    \left(\int \mathrm{d}^{3N}q\,\exp[-\beta U(\mathbf{q})]\right).
\]</div>
<p>The momentum integral produces the familiar Maxwell–Boltzmann (Gaussian) distribution of momenta:</p>
<div class="math notranslate nohighlight">
\[
P(\mathbf{p}) \propto \exp\!\left(-\beta \sum_{i=1}^N \frac{\mathbf{p}_i^2}{2m_i}\right),
\]</div>
<p>with the equipartition result</p>
<div class="math notranslate nohighlight">
\[
\langle K \rangle = \frac{3}{2} N k_{\mathrm{B}}T.
\]</div>
<p>The remaining configuration integral defines the <em>configurational</em> partition function used in many simulation contexts.</p>
<section id="one-particle-velocity-distribution">
<h3><span class="section-number">3.3.6.1. </span>One-particle velocity distribution<a class="headerlink" href="#one-particle-velocity-distribution" title="Link to this heading">#</a></h3>
<p>For a single particle of mass <span class="math notranslate nohighlight">\(m\)</span> in three dimensions, the Maxwell–Boltzmann velocity distribution is</p>
<div class="math notranslate nohighlight">
\[
P(\mathbf{v}) = \left(\frac{m}{2\pi k_{\mathrm{B}}T}\right)^{3/2}
\exp\!\left(-\frac{m v^2}{2k_{\mathrm{B}}T}\right),
\]</div>
<p>where <span class="math notranslate nohighlight">\(v = |\mathbf{v}|\)</span>. This is the distribution that many MD codes use to assign initial velocities when “velocity rescaling” or “temperature initialization” is requested.</p>
</section>
</section>
<section id="time-averages-vs-ensemble-averages">
<h2><span class="section-number">3.3.7. </span>Time averages vs ensemble averages<a class="headerlink" href="#time-averages-vs-ensemble-averages" title="Link to this heading">#</a></h2>
<p>In real experiments, we typically observe a single macroscopic system over time and take time averages. In statistical mechanics, ensemble averages are defined as averages over many copies (replicas) of the system, each in a different microstate consistent with the ensemble.</p>
<section id="ensemble-average">
<h3><span class="section-number">3.3.7.1. </span>Ensemble average<a class="headerlink" href="#ensemble-average" title="Link to this heading">#</a></h3>
<p>For an observable <span class="math notranslate nohighlight">\(A\)</span> with values <span class="math notranslate nohighlight">\(A_i\)</span> in microstate <span class="math notranslate nohighlight">\(i\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\langle A \rangle_{\text{ens}} = \sum_i P_i A_i.
\]</div>
</section>
<section id="time-average">
<h3><span class="section-number">3.3.7.2. </span>Time average<a class="headerlink" href="#time-average" title="Link to this heading">#</a></h3>
<p>For a single system evolving in time, we can define a time average:</p>
<div class="math notranslate nohighlight">
\[
\langle A \rangle_{\text{time}}
= \frac{1}{\tau}\int_0^{\tau} A\bigl(\Gamma(t)\bigr)\,\mathrm{d}t
\;\approx\; \frac{1}{M}\sum_{m=1}^M A\bigl(\Gamma(t_m)\bigr),
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Gamma(t)\)</span> is the trajectory in phase space.</p>
<p>In molecular dynamics, we simulate <em>one trajectory</em> and compute time-averaged quantities. The central assumption (to be discussed next) is that, under suitable conditions, time averages converge to ensemble averages.</p>
</section>
<section id="example-pressure-from-md">
<h3><span class="section-number">3.3.7.3. </span>Example: pressure from MD<a class="headerlink" href="#example-pressure-from-md" title="Link to this heading">#</a></h3>
<p>Suppose we are running an NVT simulation and we want the average pressure. We can compute the instantaneous pressure <span class="math notranslate nohighlight">\(p(t)\)</span> at each time step using the virial formula and then form a time average,</p>
<div class="math notranslate nohighlight">
\[
\bar{p} = \frac{1}{M} \sum_{m=1}^M p(t_m).
\]</div>
<p>If the simulation is equilibrated and sufficiently long, <span class="math notranslate nohighlight">\(\bar{p}\)</span> is our estimate of the canonical ensemble average <span class="math notranslate nohighlight">\(\langle p \rangle_{\text{NVT}}\)</span>.</p>
</section>
</section>
<section id="the-ergodic-hypothesis">
<h2><span class="section-number">3.3.8. </span>The ergodic hypothesis<a class="headerlink" href="#the-ergodic-hypothesis" title="Link to this heading">#</a></h2>
<p>The <strong>ergodic hypothesis</strong> states that, for an isolated system at fixed energy, a single trajectory in phase space will eventually come arbitrarily close to every accessible microstate compatible with the conserved quantities (energy, momentum, etc.). In that case,</p>
<div class="math notranslate nohighlight">
\[
\langle A \rangle_{\text{time}} = \langle A \rangle_{\text{ens}},
\]</div>
<p>for all “reasonable” observables <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Roughly speaking:</p>
<ul class="simple">
<li><p>The system relaxes from many different initial conditions to the same equilibrium macroscopic state.</p></li>
<li><p>Time correlations decay, and the trajectory explores the energy surface in a complicated, effectively random way.</p></li>
<li><p>A long, single MD run is “as good as” sampling many independent microstates from the equilibrium distribution.</p></li>
</ul>
<p>This hypothesis underpins the common practice in MD: we run one (or a few) trajectories and treat time averages as estimates of equilibrium ensemble averages.</p>
<section id="mixing-and-decorrelation">
<h3><span class="section-number">3.3.8.1. </span>Mixing and decorrelation<a class="headerlink" href="#mixing-and-decorrelation" title="Link to this heading">#</a></h3>
<p>Ergodicity is closely related to the idea of <em>mixing</em>: initial information about the microstate is gradually lost as the system evolves, and observables decorrelate in time. In practice we often estimate the <em>correlation time</em> <span class="math notranslate nohighlight">\(\tau_c\)</span> of an observable <span class="math notranslate nohighlight">\(A\)</span> and use it to determine how long we need to simulate to obtain statistically independent samples.</p>
</section>
</section>
<section id="non-ergodic-behavior-and-glasses">
<h2><span class="section-number">3.3.9. </span>Non-ergodic behavior and glasses<a class="headerlink" href="#non-ergodic-behavior-and-glasses" title="Link to this heading">#</a></h2>
<p>Real systems are often <em>not</em> perfectly ergodic, or at least not on accessible simulation timescales. Non-ergodic behavior means that the system fails to explore all of phase space compatible with its energy and constraints, either because:</p>
<ul class="simple">
<li><p>There are very high barriers in the energy landscape (metastable states).</p></li>
<li><p>The dynamics are nearly integrable or regular.</p></li>
<li><p>The timescale to cross barriers is astronomically large compared to our simulation time.</p></li>
</ul>
<p>A classical example is the Fermi–Pasta–Ulam (FPU) problem: a chain of particles connected by weakly anharmonic springs. Instead of energy spreading evenly among all modes (as equipartition would suggest), energy remains trapped in a few modes for a very long time, revealing non-ergodic dynamics.</p>
<p>Amorphous solids and structural glasses are another important example. If we cool a liquid too fast, it may fall out of equilibrium and get stuck in a disordered, metastable configuration. In such systems:</p>
<ul class="simple">
<li><p>The observed structure and dynamics depend sensitively on the <em>preparation protocol</em> (e.g. cooling rate).</p></li>
<li><p>There is no unique thermodynamic “glass transition temperature” independent of protocol.</p></li>
<li><p>Time averages depend on the history of the sample and are not equal to equilibrium ensemble averages.</p></li>
</ul>
<p>In simulations of glassy, non-ergodic systems, you can still measure useful quantities (structure factors, relaxation times, dynamic correlation functions), but you must always specify:</p>
<ul class="simple">
<li><p>How the system was prepared (cooling rate, initial configuration).</p></li>
<li><p>Over what time window quantities were averaged.</p></li>
<li><p>Whether results change if you modify the protocol.</p></li>
</ul>
<section id="toy-example-double-well-potential">
<h3><span class="section-number">3.3.9.1. </span>Toy example: double-well potential<a class="headerlink" href="#toy-example-double-well-potential" title="Link to this heading">#</a></h3>
<p>Even a single particle in a one-dimensional double-well potential can show non-ergodic behavior on finite timescales. If the barrier between wells is large compared to <span class="math notranslate nohighlight">\(k_{\mathrm{B}}T\)</span>, a trajectory starting in the left well may never cross to the right well during the simulation time, so the time average does not reflect the true equilibrium distribution over both wells.</p>
</section>
</section>
<section id="contact-with-a-heat-bath-thermostats-and-monte-carlo">
<h2><span class="section-number">3.3.10. </span>Contact with a heat bath: thermostats and Monte Carlo<a class="headerlink" href="#contact-with-a-heat-bath-thermostats-and-monte-carlo" title="Link to this heading">#</a></h2>
<p>In the lab, systems are rarely perfectly isolated: they exchange energy, momentum, and sometimes particles with their environment. In simulations we mimic this contact with a “bath” by modifying the equations of motion or using stochastic algorithms. Common approaches include:</p>
<ul>
<li><p><strong>Deterministic Molecular Dynamics (MD):</strong><br />
Integrates Newton’s equations of motion,
<span class="math notranslate nohighlight">\(m_i \frac{\mathrm{d}^2 \mathbf{r}_i}{\mathrm{d}t^2} = \mathbf{F}_i = -\nabla_{\mathbf{r}_i} U(\mathbf{r}_1,\dots,\mathbf{r}_N),\)</span>
usually sampling (approximately) the NVE ensemble. When combined with additional dynamical variables (e.g. Nosé–Hoover thermostat, barostat degrees of freedom), MD can also sample NVT or NPT ensembles.</p></li>
<li><p><strong>Langevin Dynamics:</strong><br />
Adds friction and random forces to mimic a thermal bath. The equation of motion is
$$
m_i \frac{\mathrm{d}^2 \mathbf{r}<em>i}{\mathrm{d}t^2}
= -\nabla</em>{\mathbf{r}_i} U</p>
<ul class="simple">
<li><p>\gamma m_i \frac{\mathrm{d}\mathbf{r}_i}{\mathrm{d}t}</p></li>
</ul>
<ul class="simple">
<li><p>\mathbf{R}_i(t),
$<span class="math notranslate nohighlight">\(
where \)</span>\gamma<span class="math notranslate nohighlight">\( is a friction coefficient and \)</span>\mathbf{R}_i(t)$ is a random force satisfying fluctuation–dissipation relations. This samples the canonical (NVT) ensemble.</p></li>
</ul>
<p>More precisely, the random forces are chosen to have
<span class="math notranslate nohighlight">\(\langle \mathbf{R}_i(t) \rangle = \mathbf{0}\)</span> and
<span class="math notranslate nohighlight">\(\langle R_{i\alpha}(t) R_{j\beta}(t') \rangle
= 2\gamma m_i k_{\mathrm{B}}T\,\delta_{ij}\,\delta_{\alpha\beta}\,\delta(t-t'),\)</span>
where <span class="math notranslate nohighlight">\(\alpha,\beta\)</span> label Cartesian components. These conditions ensure that, in equilibrium, momenta follow the Maxwell–Boltzmann distribution at temperature <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p><strong>Example: diffusion from Langevin dynamics.</strong><br />
Consider a single Brownian particle (e.g. a colloid) in a solvent modeled via Langevin dynamics. In the limit of long times, its mean-squared displacement grows linearly with time,
<span class="math notranslate nohighlight">\(\langle [\mathbf{r}(t) - \mathbf{r}(0)]^2 \rangle \approx 6 D t,\)</span>
with diffusion constant
<span class="math notranslate nohighlight">\(D = \frac{k_{\mathrm{B}}T}{\zeta}\)</span> and <span class="math notranslate nohighlight">\(\zeta = \gamma m,\)</span>
consistent with the Einstein relation. By tuning <span class="math notranslate nohighlight">\(\gamma\)</span>, we can interpolate between nearly Hamiltonian dynamics (small friction) and strongly damped Brownian motion (large friction).</p>
<p><strong>Langevin thermostats in MD codes.</strong><br />
In practice, Langevin thermostats are implemented using discrete-time integrators (e.g. BAOAB, OBABO, velocity Verlet with noise). Users typically choose a damping time <span class="math notranslate nohighlight">\(\tau_{\mathrm{damp}} = 1/\gamma\)</span> on the order of a fraction of a picosecond to a few picoseconds. Too small <span class="math notranslate nohighlight">\(\tau_{\mathrm{damp}}\)</span> (large friction) overdamps the dynamics and can slow down sampling of collective modes; too large <span class="math notranslate nohighlight">\(\tau_{\mathrm{damp}}\)</span> (weak coupling) leads to slow temperature control.</p>
</li>
<li><p><strong>Brownian Dynamics:</strong><br />
Overdamped limit where inertial terms are negligible compared to friction. The equation of motion reads
<span class="math notranslate nohighlight">\(\gamma \frac{\mathrm{d}\mathbf{r}_i}{\mathrm{d}t}
= -\nabla_{\mathbf{r}_i} U + \mathbf{R}_i(t),\)</span>
and velocities are not explicitly followed. This is useful for simulations of large particles in viscous environments where momentum relaxes very quickly (e.g. coarse-grained polymer or colloid models).</p></li>
<li><p><strong>Monte Carlo (MC):</strong><br />
Random moves in configuration space accepted or rejected with a rule that ensures detailed balance, e.g. Metropolis MC. For the canonical ensemble, a trial move from microstate <span class="math notranslate nohighlight">\(i\)</span> to <span class="math notranslate nohighlight">\(j\)</span> with energy change <span class="math notranslate nohighlight">\(\Delta E = E_j - E_i\)</span> is accepted with probability
<span class="math notranslate nohighlight">\(P_{\text{acc}}(i\to j) = \min\bigl[1,\exp(-\beta\Delta E)\bigr].\)</span>
Repeated moves generate configurations distributed according to <span class="math notranslate nohighlight">\(P_i \propto e^{-\beta E_i}\)</span>. MC algorithms can be designed to sample NVT, NPT, or other ensembles by including volume-change moves, particle insertions/deletions, etc.</p></li>
</ul>
<p>Once any randomness is introduced (Langevin, MC, etc.), ergodicity is usually improved, and convergence towards the canonical distribution is more robust—although for complex systems, equilibration can still be extremely slow.</p>
</section>
<section id="practical-issues-equilibration-windowing-and-diagnostics">
<h2><span class="section-number">3.3.11. </span>Practical issues: equilibration, windowing, and diagnostics<a class="headerlink" href="#practical-issues-equilibration-windowing-and-diagnostics" title="Link to this heading">#</a></h2>
<p>In practice, to obtain meaningful averages from simulations:</p>
<ol class="arabic simple">
<li><p><strong>Equilibration:</strong><br />
Start from some initial configuration (often artificial, e.g. a lattice or random packing). The early part of the trajectory is usually far from equilibrium. You should:</p>
<ul class="simple">
<li><p>Let the system evolve until observables (e.g. energy, pressure, structure) fluctuate around a steady mean.</p></li>
<li><p>Discard this initial <em>equilibration</em> segment from your averages.</p></li>
</ul>
</li>
<li><p><strong>Check stationarity:</strong><br />
Always plot the observable of interest <span class="math notranslate nohighlight">\(A(t)\)</span> versus time. Ask:</p>
<ul class="simple">
<li><p>Does <span class="math notranslate nohighlight">\(A(t)\)</span> fluctuate around a constant mean?</p></li>
<li><p>Or does it drift slowly (still evolving)?</p></li>
<li><p>How long does it take before the drift disappears?</p></li>
</ul>
</li>
<li><p><strong>Time-window averaging:</strong><br />
For non-stationary or slowly relaxing systems (e.g. glasses), be explicit about:</p>
<ul class="simple">
<li><p>The time window over which you averaged.</p></li>
<li><p>How the average changes if you use a different time window.</p></li>
<li><p>Whether results depend on when you start collecting data (early vs late segments).</p></li>
</ul>
</li>
<li><p><strong>Block averaging and error estimates:</strong><br />
Consecutive MD frames are correlated, so naive estimates of the standard error can be misleading. A common approach is <em>block averaging</em>:</p>
<ul class="simple">
<li><p>Split the production trajectory into <span class="math notranslate nohighlight">\(M\)</span> blocks of duration <span class="math notranslate nohighlight">\(\tau_{\text{block}}\)</span>.</p></li>
<li><p>Compute the block average <span class="math notranslate nohighlight">\(A_k\)</span> in each block <span class="math notranslate nohighlight">\(k = 1,\dots,M\)</span>.</p></li>
<li><p>Treat the <span class="math notranslate nohighlight">\(A_k\)</span> as approximately independent samples and estimate the mean and standard error from them:
<span class="math notranslate nohighlight">\(\bar{A} = \frac{1}{M}\sum_{k=1}^M A_k\)</span> and
<span class="math notranslate nohighlight">\(\sigma_{\bar{A}} = \sqrt{\frac{1}{M(M-1)} \sum_{k=1}^M (A_k - \bar{A})^2}.\)</span></p></li>
<li><p>Choosing <span class="math notranslate nohighlight">\(\tau_{\text{block}}\)</span> several times larger than the correlation time of <span class="math notranslate nohighlight">\(A\)</span> improves the reliability of these error estimates.</p></li>
</ul>
</li>
<li><p><strong>Protocol dependence:</strong><br />
If your results depend on preparation protocol (cooling rate, compression rate, etc.), then you are <em>not</em> measuring equilibrium ensemble averages, but still something physically meaningful. You must report the protocol clearly.</p></li>
</ol>
</section>
<section id="summary">
<h2><span class="section-number">3.3.12. </span>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Statistical mechanics connects microscopic variables from simulations to macroscopic thermodynamic quantities.</p></li>
<li><p>Microstates are points in a <span class="math notranslate nohighlight">\(6N\)</span>-dimensional phase space; macrostates are defined by a small set of constraints (e.g. <span class="math notranslate nohighlight">\(N,V,E\)</span>).</p></li>
<li><p>The density of states <span class="math notranslate nohighlight">\(\Omega(E)\)</span> and the partition function <span class="math notranslate nohighlight">\(Z\)</span> encode the structure of phase space and allow us to compute thermodynamic properties.</p></li>
<li><p>Different ensembles (NVE, NVT, NPT, <span class="math notranslate nohighlight">\(\mu\)</span>VT) correspond to different physical constraints and are implemented in simulations via thermostats, barostats, and MC schemes.</p></li>
<li><p>The ergodic hypothesis justifies using time averages from MD trajectories as approximations to ensemble averages.</p></li>
<li><p>Non-ergodic behavior (e.g. glasses, metastable states) is common and must be treated carefully; results are often protocol-dependent.</p></li>
<li><p>Good simulation practice always includes checking equilibration, estimating statistical errors, and carefully defining the ensemble and preparation protocol.</p></li>
</ul>
</section>
<section id="references">
<h2><span class="section-number">3.3.13. </span>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<section id="further-reading">
<h3><span class="section-number">3.3.13.1. </span>Further reading<a class="headerlink" href="#further-reading" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><span id="id1"><sup><a class="reference internal" href="../references/references.html#id30" title="David Chandler. Introduction to Modern Statistical Mechanics. Oxford University Press, 1987.">5</a></sup></span> – <em>Introduction to Modern Statistical Mechanics</em>.</p></li>
<li><p><span id="id2"><sup><a class="reference internal" href="../references/references.html#id31" title="Mark E. Tuckerman. Statistical Mechanics: Theory and Molecular Simulation. Oxford University Press, 2010.">42</a></sup></span> – <em>Statistical Mechanics: Theory and Molecular Simulation</em>.</p></li>
<li><p><span id="id3"><sup><a class="reference internal" href="../references/references.html#id32" title="Antonia Statt. Mse 485: atomistic-scale simulations – statistical mechanics and ensembles. 2025. Course notes, University of Illinois at Urbana–Champaign.">36</a></sup></span> – Course notes on statistical mechanics and ensembles (MSE 485 / atomistic-scale simulations).</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./statmech-thermo"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ensembles.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3.2. </span>Thermodyanmics and Ensembles</p>
      </div>
    </a>
    <a class="right-next"
       href="thermodynamic-properties.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3.4. </span>Thermodyanmics Properties</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#microstates-macrostates-and-phase-space">3.3.1. Microstates, macrostates, and phase space</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-gas-in-a-box">3.3.1.1. Example: gas in a box</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble">3.3.1.2. Ensemble</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#density-of-states-entropy-and-temperature">3.3.2. Density of states, entropy, and temperature</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-ideal-gas-very-briefly">3.3.2.1. Example: ideal gas (very briefly)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-microcanonical-nve-ensemble">3.3.3. The microcanonical (NVE) ensemble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-nve-md-of-a-lennardjones-fluid">3.3.3.1. Example: NVE MD of a Lennard–Jones fluid</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-canonical-nvt-ensemble-and-the-partition-function">3.3.4. The canonical (NVT) ensemble and the partition function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-ideal-gas-in-the-canonical-ensemble">3.3.4.1. Example: ideal gas in the canonical ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-fluctuations-in-the-canonical-ensemble">3.3.4.2. Energy fluctuations in the canonical ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nvt-in-practice-thermostats">3.3.4.3. NVT in practice: thermostats</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-standard-ensembles">3.3.5. Other standard ensembles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#isothermalisobaric-npt-ensemble">3.3.5.1. Isothermal–isobaric (NPT) ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#npt-in-practice-barostats">3.3.5.2. NPT in practice: barostats</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grand-canonical-muvt-ensemble-very-briefly">3.3.5.3. Grand canonical (<span class="math notranslate nohighlight">\(\mu\)</span>VT) ensemble (very briefly)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classical-limit-and-maxwellboltzmann-distribution">3.3.6. Classical limit and Maxwell–Boltzmann distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-particle-velocity-distribution">3.3.6.1. One-particle velocity distribution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averages-vs-ensemble-averages">3.3.7. Time averages vs ensemble averages</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-average">3.3.7.1. Ensemble average</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-average">3.3.7.2. Time average</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-pressure-from-md">3.3.7.3. Example: pressure from MD</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ergodic-hypothesis">3.3.8. The ergodic hypothesis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mixing-and-decorrelation">3.3.8.1. Mixing and decorrelation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-ergodic-behavior-and-glasses">3.3.9. Non-ergodic behavior and glasses</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy-example-double-well-potential">3.3.9.1. Toy example: double-well potential</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contact-with-a-heat-bath-thermostats-and-monte-carlo">3.3.10. Contact with a heat bath: thermostats and Monte Carlo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-issues-equilibration-windowing-and-diagnostics">3.3.11. Practical issues: equilibration, windowing, and diagnostics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">3.3.12. Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">3.3.13. References</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">3.3.13.1. Further reading</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Antonia Statt
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>