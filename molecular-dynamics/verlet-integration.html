
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.2. Verlet Integration &#8212; Atomistic Scale Simulations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/image_dark_mode.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myadmonitions.css?v=5b3d7684" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=80cd6c28" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"d": ["{\\operatorname{d}\\!{#1}}", 1], "dd": ["{\\d{}^{#1} #2 \\over \\d{#3}^{#1}}", 3], "pp": ["{\\partial^{#1} #2 \\over \\partial #3^{#1}}", 3], "td": ["{\\left(\\pp{#1}{#2}{#3} \\right)_{#4}}", 4], "ubar": ["\\underline{#1}", 1], "vv": ["\\mathbf{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'molecular-dynamics/verlet-integration';</script>
    <link rel="canonical" href="https://stattlab.github.io/atomistic-scale-simulations/molecular-dynamics/verlet-integration.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.3. Thermostats" href="thermostats.html" />
    <link rel="prev" title="4.1. Introduction" href="introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Atomistic Scale Simulations</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/index.html">1. Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/why-atomistic-scale.html">1.1. Why are we interested in the atomistic scale?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/what-are-simulations.html">1.2. What are Simulations?</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecular-models-and-interactions/index.html">2. Molecular Models and Interactions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/molecular-models.html">2.2. Molecular Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/periodic-boundary-conditions.html">2.3. Periodic Boundary Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/intramolecular-potentials.html">2.4. Intermolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/short-ranged-potentials.html">2.5. Short-Ranged Intramolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/electrostatics.html">2.6. Long-Range Potentials</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../statmech-thermo/index.html">3. Statistical Mechanics and Thermodynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/introduction.html">3.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/ensembles.html">3.2. Thermodyanmics and Ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/statmech-ergodicity.html">3.3. Statistical Mechanics: Ensembles, Ergodicity and other Stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/thermodynamic-properties.html">3.4. Thermodyanmics Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/entropy-temperature.html">3.5. Entropy and Temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/structural-correlations.html">3.6. Structural Correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/transport-coefficients.html">3.7. Transport Coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/statistical-errors.html">3.8. Statistical Errors</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">4. Molecular Dynamics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">4.1. Introduction</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">4.2. Verlet Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermostats.html">4.3. Thermostats</a></li>
<li class="toctree-l2"><a class="reference internal" href="langevin-dynamics.html">4.4. Langevin Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="md-packages.html">4.5. Using MD Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="neighbor-list.html">4.6. Initialization and Neighbor Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="high-performance-computing.html">4.7. HPC (High-Performance Computing)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../monte-carlo/index.html">5. Monte Carlo Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/introduction.html">5.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/random-numbers.html">5.2. Random Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/monte-carlo-method.html">5.3. Monte Carlo Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/sampling.html">5.4. Sampling Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/phase-coexistence.html">5.5. Gibbs Ensemble and Phase Coexistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/finite-size.html">5.6. Phase Transitions, Finite-size Scaling and Renormalization Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/variance-reduction.html">5.7. Variance Reduction Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/metropolis.html">5.8. Metropolis Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/ising-model.html">5.9. The Ising Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/directed-mc.html">5.10. Directed Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/kinetic-mc.html">5.11. Kinetic Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/free-energy-from-sims.html">5.12. Free Energy Estimation in Simulations</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../references/references.html">6. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">7. Credits</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations/issues/new?title=Issue%20on%20page%20%2Fmolecular-dynamics/verlet-integration.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/molecular-dynamics/verlet-integration.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Verlet Integration</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#liouvilles-theorem">4.2.1. 1. Liouville’s Theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#propagators-symplectic-time-reversible">4.2.2. 2. Propagators: Symplectic, Time Reversible</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#not-all-integrators-are-symplectic-or-reversible">4.2.2.1. Not all integrators are symplectic or reversible</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-explicit-euler">4.2.2.1.1. Example: Explicit Euler</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trotter-decomposition">4.2.3. 3. Trotter Decomposition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#velocity-verlet-algorithm">4.2.4. 4. Velocity Verlet Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps">4.2.4.1. Steps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equivalent-form">4.2.4.2. Equivalent form</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.2.4.3. </a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation-of-the-verlet-algorithm">4.2.4.4. Derivation of the Verlet algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#criteria-for-selecting-an-integrator">4.2.4.5. Criteria for selecting an integrator</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">4.2.5. References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="verlet-integration">
<h1><span class="section-number">4.2. </span>Verlet Integration<a class="headerlink" href="#verlet-integration" title="Link to this heading">#</a></h1>
<section id="liouvilles-theorem">
<h2><span class="section-number">4.2.1. </span>1. Liouville’s Theorem<a class="headerlink" href="#liouvilles-theorem" title="Link to this heading">#</a></h2>
<p>How does the probability distribution evolve?</p>
<p>Define ( \Gamma = (q, p) ) to be the phase space coordinate.</p>
<p>Probability is a conserved quantity, so:</p>
<div class="math notranslate nohighlight">
\[
\frac{df}{dt} = 0
\]</div>
<p>This is analogous to:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \vec{v}) = 0
\]</div>
<p>Apply the product rule and Hamilton’s equations:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial f}{\partial t} + \sum_i \left( \frac{\partial f}{\partial q_i} \frac{\partial H}{\partial p_i} - \frac{\partial f}{\partial p_i} \frac{\partial H}{\partial q_i} \right) = 0
\]</div>
<p>Therefore:</p>
<div class="math notranslate nohighlight">
\[
\frac{df}{dt} = 0
\]</div>
<p>This means <strong>phase space is incompressible</strong>.</p>
<p><strong>Liouville’s Theorem</strong>: The phase-space distribution is constant along trajectories of the system.</p>
<p>Alternative form using <strong>Poisson bracket</strong>:</p>
<div class="math notranslate nohighlight">
\[
\frac{df}{dt} = \{f, H\} = 0
\]</div>
<p>The Liouville operator is:</p>
<div class="math notranslate nohighlight">
\[
\mathcal{L} = \{., H\}
\]</div>
<p>This operator is <strong>Hermitian</strong> (important property).</p>
</section>
<section id="propagators-symplectic-time-reversible">
<h2><span class="section-number">4.2.2. </span>2. Propagators: Symplectic, Time Reversible<a class="headerlink" href="#propagators-symplectic-time-reversible" title="Link to this heading">#</a></h2>
<p>The phase-space trajectories follow from Hamilton’s equations and have a formal solution:</p>
<div class="math notranslate nohighlight">
\[
\Gamma(t) = e^{t \mathcal{L}} \Gamma(0)
\]</div>
<p>The exponential of the operator is a <strong>Taylor series</strong> and acts as a <strong>propagator</strong>.</p>
<p>This propagator is:</p>
<ul class="simple">
<li><p><strong>Unitary</strong>: ( e^{-t \mathcal{L}} = (e^{t \mathcal{L}})^{-1} )</p></li>
<li><p><strong>Volume-preserving</strong>: Jacobian of transformation is identity</p></li>
<li><p><strong>Symplectic</strong>: Canonical transformation</p></li>
<li><p><strong>Time reversible</strong></p></li>
</ul>
<section id="not-all-integrators-are-symplectic-or-reversible">
<h3><span class="section-number">4.2.2.1. </span>Not all integrators are symplectic or reversible<a class="headerlink" href="#not-all-integrators-are-symplectic-or-reversible" title="Link to this heading">#</a></h3>
<section id="example-explicit-euler">
<h4><span class="section-number">4.2.2.1.1. </span>Example: Explicit Euler<a class="headerlink" href="#example-explicit-euler" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>( x(t + \Delta t) = x(t) + \Delta t \cdot p(t) )</p></li>
<li><p>( p(t + \Delta t) = p(t) + \Delta t \cdot f(x(t)) )</p></li>
</ul>
<p>Not symplectic or reversible.</p>
</section>
</section>
</section>
<section id="trotter-decomposition">
<h2><span class="section-number">4.2.3. </span>3. Trotter Decomposition<a class="headerlink" href="#trotter-decomposition" title="Link to this heading">#</a></h2>
<p>Split the Liouville operator:</p>
<div class="math notranslate nohighlight">
\[
\mathcal{L} = \mathcal{L}_1 + \mathcal{L}_2
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p>( \mathcal{L}_1 = \sum_i \frac{\partial H}{\partial p_i} \frac{\partial}{\partial q_i} )</p></li>
<li><p>( \mathcal{L}_2 = -\sum_i \frac{\partial H}{\partial q_i} \frac{\partial}{\partial p_i} )</p></li>
</ul>
<p>In general, ( \mathcal{L}_1 ) and ( \mathcal{L}_2 ) do not commute.</p>
<p>Using <strong>Trotter decomposition</strong>:</p>
<div class="math notranslate nohighlight">
\[
e^{(\mathcal{L}_1 + \mathcal{L}_2) \Delta t} \approx e^{\frac{1}{2} \mathcal{L}_1 \Delta t} e^{\mathcal{L}_2 \Delta t} e^{\frac{1}{2} \mathcal{L}_1 \Delta t} + \mathcal{O}(\Delta t^3)
\]</div>
<p>This gives a <strong>single-step propagator</strong>:</p>
<ul class="simple">
<li><p><strong>Symplectic</strong>: Each sub-propagator is unitary</p></li>
<li><p><strong>Reversible</strong>: Symmetric operator sequence
Higher-order integrators exist but are more complex.</p></li>
</ul>
</section>
<section id="velocity-verlet-algorithm">
<h2><span class="section-number">4.2.4. </span>4. Velocity Verlet Algorithm<a class="headerlink" href="#velocity-verlet-algorithm" title="Link to this heading">#</a></h2>
<p>Apply Trotter decomposition to derive <strong>Velocity Verlet</strong>:</p>
<section id="steps">
<h3><span class="section-number">4.2.4.1. </span>Steps<a class="headerlink" href="#steps" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p><strong>Half-step velocity update</strong>:</p>
<div class="math notranslate nohighlight">
\[
   v(t + \frac{\Delta t}{2}) = v(t) + \frac{\Delta t}{2m} F(t)
   \]</div>
</li>
<li><p><strong>Full-step position update</strong>:</p>
<div class="math notranslate nohighlight">
\[
   x(t + \Delta t) = x(t) + \Delta t \cdot v(t + \frac{\Delta t}{2})
   \]</div>
</li>
<li><p><strong>Half-step velocity update with new force</strong>:</p>
<div class="math notranslate nohighlight">
\[
   v(t + \Delta t) = v(t + \frac{\Delta t}{2}) + \frac{\Delta t}{2m} F(t + \Delta t)
   \]</div>
</li>
</ol>
</section>
<section id="equivalent-form">
<h3><span class="section-number">4.2.4.2. </span>Equivalent form<a class="headerlink" href="#equivalent-form" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
x(t + \Delta t) = x(t) + \Delta t \cdot v(t) + \frac{\Delta t^2}{2m} F(t)
\]</div>
<ul class="simple">
<li><p><strong>Symplectic</strong></p></li>
<li><p><strong>Time reversible</strong></p></li>
<li><p><strong>Widely used in MD packages</strong></p></li>
</ul>
<p>Other variants: basic Verlet, leapfrog — less convenient than Velocity Verlet.</p>
</section>
<section id="id1">
<h3><span class="section-number">4.2.4.3. </span><a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
</section>
<section id="derivation-of-the-verlet-algorithm">
<h3><span class="section-number">4.2.4.4. </span>Derivation of the Verlet algorithm<a class="headerlink" href="#derivation-of-the-verlet-algorithm" title="Link to this heading">#</a></h3>
<p>Let us make a Taylor solution of trajectory about the current position:</p>
<div class="math notranslate nohighlight">
\[
r(t+h) = r(t) + v(t) h + 1/2 a(t) h2 + b(t) h3 + O(h4)
\]</div>
<p>Substitute in for -t:
$<span class="math notranslate nohighlight">\(
 r(t-h) = r(t) - v(t) h + 1/2 a(t) h2 - b(t) h3 + O(h4)
\)</span>$</p>
<p>Add the two expansions:</p>
<div class="math notranslate nohighlight">
\[
r(t+h) = 2 r(t) - r(t-h) + a(t) h2 + O(h4)
\]</div>
<p>Velocities are eliminated. One can estimate them as:</p>
<div class="math notranslate nohighlight">
\[
v(t) = (r(t+h) - r(t-h))/(2h)  + O(h2)
\]</div>
<p>Time reversal invariance and momentum conservation are built in. This implies that the energy has no drift. Probably the dynamics generated by the Verlet algorithm has a constant of motion which is nearly but not exactly equal to the total energy.</p>
<p><strong>Prove that the Verlet algorithm is time-reversal invariant. That is, show that if we use <span class="math notranslate nohighlight">\(r(t+h)\)</span> and <span class="math notranslate nohighlight">\(r(t)\)</span> as inputs we get <span class="math notranslate nohighlight">\(r(t-h)\)</span> (up to round-off errors). Why does this form have a possible problem with round-off errors?</strong></p>
<p>Velocity Verlet is algebraically equivalent but avoids taking differences between large numbers.</p>
<div class="math notranslate nohighlight">
\[
r(t+h) = r(t) + v(t) h + 1/2 a(t) h2
v(t+h) = v(t) + 1/2 (a(t) + a(t+h))h
\]</div>
<p><strong>Prove that this is equivalent.</strong></p>
<p>Higher order algorithms are available (Gear etc.) These are useful only when high accuracy is needed and the potential and several derivatives are smooth.</p>
<p>Berendsen and van Gunsteren (in MD simulation of Statistical-Mechanical Systems , 1986) is a study of energy conservation versus time step for the Verlet algorithm and higher order Gear algorithms on a protein. It is shown that for large time steps the Verlet algorithm is considerably more stable. Higher order algorithms have only a the marginal increase in efficiency and actually get worse beyond 7th order.</p>
<p>The following quote is from their article:</p>
<blockquote>
<div><p>How accurate a simulation has to be in order to provide reliable statistical results is still a matter of debate. The purpose is never to produce reliable trajectories. Whatever accuracy the forces and the algorithms have, significant deviations from the exact solution will inevitably occur. Also in the real physical world individual trajectories have no meaning: in a quantum mechanical sense they do not exist and even classically they become unpredictable in the long run due to the nonisolated character of any real system. So what counts are statistical averages. It seems that very little systematic evaluation of algorithms has been done with this in mind. We have the impression that a noise as high as 10% of the kinetic energy fluctuation is still acceptable, although the accuracy of fluctuations may not be sufficient to obtain thermodynamic date from them. With such a level of inaccuracy the Verlet of leap frog algorithm is always to be preferred.</p>
</div></blockquote>
</section>
<section id="criteria-for-selecting-an-integrator">
<h3><span class="section-number">4.2.4.5. </span>Criteria for selecting an integrator<a class="headerlink" href="#criteria-for-selecting-an-integrator" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>simplicity (How long does it take to write and debug?)</p></li>
<li><p>efficiency (How fast to advance a given system?)</p></li>
<li><p>stability (what is the long-term energy conservation?)</p></li>
<li><p>reliability (Can it handle a variety of temperatures, densities, potentials?)</p></li>
<li><p>vectorization/parallelization (What is the potential efficiency?)</p></li>
</ul>
<p><strong>Some additional questions:</strong></p>
<ul class="simple">
<li><p>Which algorithm will enable me to answer some physical question as quickly as possible? (i.e. minimize the scientist’s time assuming adequate computational resources).</p></li>
<li><p>Which algorithm is most efficient? That is which algorithm will calculate some physical quantity to a given accuracy in the smallest amount of CPU time or the least memory (on a given machine)? This is the situation for a mature problem and for writing a proposal to get computer time. You must justify that you are using the machine as efficiently as possible.</p></li>
<li><p>Have we balanced statistical errors (going as h-1/2 ) with time step errors which go as hp where p=2,3…? It doesn’t help to have an extremely accurate trajectory if the algorithm is so slow that it cannot sample enough of phase space.</p></li>
</ul>
<p><strong>Characteristics of simulations which affect choice of estimator.</strong></p>
<ul class="simple">
<li><p>Potentials are highly non-linear with discontinuous higher derivatives either at the origin or at the box edge. Harmonic oscillator is not a good test problem!</p></li>
<li><p>Small changes in accuracy lead to totally different trajectories. (the mixing or ergodic property)</p></li>
<li><p>We need low accuracy because the potentials are not very realistic. Universality saves us: a badly integrated system is probably similar to our original system. This is not true in the field of non-linear dynamics or, for example, in studying the solar system (we know gravity is correct.)</p></li>
<li><p>CPU time is totally dominated by the calculation of forces.</p></li>
<li><p>Memory considerations are not too important these days (but beware cache misses.)</p></li>
<li><p>Energy conservation is important. Energy stability is roughly equivalent to time-reversal invariance. A good test for your code is whether the algorithm can retrace its steps. The energy surface becomes a little fuzzy if energy is not conserved. Rule of thumb: allow 0.01kT fluctuation in the total energy.</p></li>
<li><p>Other symmetries may be important, momentum etc.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The nearly universal choice for an integrator is the velocity-Verlet or Verlet algorithm (L. Verlet, Phys. Rev. 159, 98 (1967)).</p>
</div>
</section>
</section>
<section id="references">
<h2><span class="section-number">4.2.5. </span>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Reversible multiple time scale molecular dynamics, J. Chem. Phys. 97, 1990 (1992); <a class="reference external" href="https://doi.org/10.1063/1.463137">https://doi.org/10.1063/1.463137</a>, M. Tuckerman, B. J. Berne and G. J. Martyna</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./molecular-dynamics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="introduction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4.1. </span>Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="thermostats.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.3. </span>Thermostats</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#liouvilles-theorem">4.2.1. 1. Liouville’s Theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#propagators-symplectic-time-reversible">4.2.2. 2. Propagators: Symplectic, Time Reversible</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#not-all-integrators-are-symplectic-or-reversible">4.2.2.1. Not all integrators are symplectic or reversible</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-explicit-euler">4.2.2.1.1. Example: Explicit Euler</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trotter-decomposition">4.2.3. 3. Trotter Decomposition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#velocity-verlet-algorithm">4.2.4. 4. Velocity Verlet Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps">4.2.4.1. Steps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equivalent-form">4.2.4.2. Equivalent form</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.2.4.3. </a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation-of-the-verlet-algorithm">4.2.4.4. Derivation of the Verlet algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#criteria-for-selecting-an-integrator">4.2.4.5. Criteria for selecting an integrator</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">4.2.5. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Antonia Statt
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>