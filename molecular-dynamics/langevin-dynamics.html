
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.4. Langevin Dynamics &#8212; Atomistic Scale Simulations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/image_dark_mode.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myadmonitions.css?v=5b3d7684" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=80cd6c28" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"d": ["{\\operatorname{d}\\!{#1}}", 1], "dd": ["{\\d{}^{#1} #2 \\over \\d{#3}^{#1}}", 3], "pp": ["{\\partial^{#1} #2 \\over \\partial #3^{#1}}", 3], "td": ["{\\left(\\pp{#1}{#2}{#3} \\right)_{#4}}", 4], "ubar": ["\\underline{#1}", 1], "vv": ["\\mathbf{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'molecular-dynamics/langevin-dynamics';</script>
    <link rel="canonical" href="https://stattlab.github.io/atomistic-scale-simulations/molecular-dynamics/langevin-dynamics.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.5. Using MD Packages" href="md-packages.html" />
    <link rel="prev" title="4.3. Thermostats" href="thermostats.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Atomistic Scale Simulations</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/index.html">1. Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/why-atomistic-scale.html">1.1. Why are we interested in the atomistic scale?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/what-are-simulations.html">1.2. What are Simulations?</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecular-models-and-interactions/index.html">2. Molecular Models and Interactions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/molecular-models.html">2.2. Molecular Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/periodic-boundary-conditions.html">2.3. Periodic Boundary Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/intramolecular-potentials.html">2.4. Intermolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/short-ranged-potentials.html">2.5. Short-Ranged Intramolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/electrostatics.html">2.6. Long-Range Potentials</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../statmech-thermo/index.html">3. Statistical Mechanics and Thermodynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/introduction.html">3.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/ensembles.html">3.2. Thermodyanmics and Ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/statmech-ergodicity.html">3.3. Statistical Mechanics: Ensembles, Ergodicity, and Other Stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/thermodynamic-properties.html">3.4. Thermodyanmics Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/entropy-temperature.html">3.5. Entropy and Temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/structural-correlations.html">3.6. Structural Correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/transport-coefficients.html">3.7. Transport Coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/statistical-errors.html">3.8. Statistical Errors</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">4. Molecular Dynamics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">4.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="verlet-integration.html">4.2. Verlet Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermostats.html">4.3. Thermostats</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">4.4. Langevin Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="md-packages.html">4.5. Using MD Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="neighbor-list.html">4.6. Initialization and Neighbor Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="high-performance-computing.html">4.7. HPC (High-Performance Computing)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../monte-carlo/index.html">5. Monte Carlo Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/introduction.html">5.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/random-numbers.html">5.2. Random Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/monte-carlo-method.html">5.3. Monte Carlo Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/sampling.html">5.4. Sampling Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/phase-coexistence.html">5.5. Gibbs Ensemble and Phase Coexistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/finite-size.html">5.6. Phase Transitions, Finite-Size Scaling and Renormalization Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/variance-reduction.html">5.7. Variance Reduction Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/metropolis.html">5.8. Metropolis Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/ising-model.html">5.9. The Ising Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/directed-mc.html">5.10. Directed Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/kinetic-mc.html">5.11. Kinetic Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/free-energy-from-sims.html">5.12. Free Energy Estimation in Simulations</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../references/references.html">6. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">7. Credits</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations/issues/new?title=Issue%20on%20page%20%2Fmolecular-dynamics/langevin-dynamics.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/molecular-dynamics/langevin-dynamics.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Langevin Dynamics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implicit-solvent-models">4.4.1. Implicit-Solvent Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.4.2. Langevin Dynamics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fluctuation-dissipation-theorem">4.4.3. Fluctuation-dissipation theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langevin-equation">4.4.4. Langevin Equation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brownian-dynamics">4.4.5. Brownian Dynamics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hydrodynamic-interactions">4.4.6. Hydrodynamic Interactions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langevin-thermostat-conclusion">4.4.7. Langevin Thermostat: Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">4.4.8. References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="langevin-dynamics">
<h1><span class="section-number">4.4. </span>Langevin Dynamics<a class="headerlink" href="#langevin-dynamics" title="Link to this heading">#</a></h1>
<section id="implicit-solvent-models">
<h2><span class="section-number">4.4.1. </span>Implicit-Solvent Models<a class="headerlink" href="#implicit-solvent-models" title="Link to this heading">#</a></h2>
<p>An implicit-solvent model represents average solvent molecules using the idea of “effective potentials”.</p>
<p>In previous discussions, we defined the forcefield and captured all molecular interactions using a microcanonical ensemble (NVE). However, when switching to the practical canonical ensemble (NVT), the computational cost increases with the thermostat dynamics. Especially for a large system, simulating non-target solvent molecules is neither meaningful nor necessary.</p>
<p>Example: Simulate nanoparticles in a solvent.
If we use an explicit solvent model, our system looks like this.</p>
<figure class="align-center" id="explicit-solvent-model-example">
<a class="reference internal image-reference" href="../_images/Explicit_solvent_model_example.jpg"><img alt="Visualization of explicit solvent model with Au nanoparticles in water." src="../_images/Explicit_solvent_model_example.jpg" style="width: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4.2 </span><span class="caption-text">Schematic of the visualization for a modeling of Au nanoparticles in water by explicit solvent model.</span><a class="headerlink" href="#explicit-solvent-model-example" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>While we need to define the detailed atomic arrangements in Au  Nanoparticles, we also need to model the structure of water molecules.</p></li>
<li><p>The slowest part of an MD simulation is calculating the distances and forces of all particles. In this case, we need to calculate these parameters at each timestep for each NPs and water molecule.</p></li>
<li><p>Note that in an actual simulation, there will be more than the number of water molecules drawn in the schematic (approximately <span class="math notranslate nohighlight">\(10^6\)</span> depending on the system).</p></li>
</ul>
<p>An implicit solvent model treats solvent molecules as a “bath”, which transfers the molecular interactions to averaged, continuum effects with the frictional drag and stochastic force.</p>
<ul class="simple">
<li><p>Frictional drag: Energy dissipation into the surrounding implicit solvent.</p></li>
<li><p>Stochastic force: A random kick from the solvent that simulates the collisions of solvent molecules and keeps the system at constant temperature.</p></li>
</ul>
<p>Example: Simulate nanoparticles in a solvent.</p>
<figure class="align-center" id="implicit-solvent-model-example">
<a class="reference internal image-reference" href="../_images/Implicit_solvent_model_example.jpg"><img alt="Visualization of implicit solvent model with Au nanoparticles in water." src="../_images/Implicit_solvent_model_example.jpg" style="width: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4.3 </span><span class="caption-text">Schematic of the visualization for a modeling of Au nanoparticles in water by implicit solvent model.</span><a class="headerlink" href="#implicit-solvent-model-example" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>The system only contains the Au nanoparticles. But the frictional drag and stochastic force are added in the force term.</p></li>
<li><p>The thermal bath can exchange heat with Au nanoparticles. Essentially, the Au nanoparticles can “feel” the solvent molecules.</p></li>
</ul>
</section>
<section id="id1">
<h2><span class="section-number">4.4.2. </span>Langevin Dynamics<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>The bridge connecting the explicit molecular interactions with the implicit forces is called the Langevin dynamics, as the “thermal bath” above.</p>
</section>
<section id="fluctuation-dissipation-theorem">
<h2><span class="section-number">4.4.3. </span>Fluctuation-dissipation theorem<a class="headerlink" href="#fluctuation-dissipation-theorem" title="Link to this heading">#</a></h2>
<p>“When there is a process that dissipates energy, turning into heat, then there is a reverse process related to thermal fluctuations.”</p>
<p>Example:</p>
<ul class="simple">
<li><p>The Au nanoparticles experience the drag (fluid resistance) from solvent molecules. Then, the drag dissipates kinetic energy, turning it into heat. (Kinetic energy to heat)</p></li>
<li><p>Conversely, the Au nanoparticles move around with a change in velocity when molecules collide based on the Brownian motion. (Heat to kinetic energy)</p></li>
</ul>
<p>Conceptually, Langevin dynamics can be split into 2 parts:</p>
<ul class="simple">
<li><p>Thermodynamics: Random thermal noise and dissipative processes (friction, damping) are not independent. Balancing the energy distribution ensures constant T.</p></li>
<li><p>Dynamics: Drag force from viscous friction is balanced with thermal kicks in damping. Allow the simulation of Brownian motion.</p></li>
</ul>
</section>
<section id="langevin-equation">
<h2><span class="section-number">4.4.4. </span>Langevin Equation<a class="headerlink" href="#langevin-equation" title="Link to this heading">#</a></h2>
<p>Mathematically, the Langevin dynamics can be defined in the same logic.</p>
<ul class="simple">
<li><p>Balancing the stochastic thermal noise with the viscous drag modify the momentum of the system.</p></li>
</ul>
<p><strong>Langevin Equation</strong>
$<span class="math notranslate nohighlight">\(
mdv = \big(F(r(t)) - \gamma v\big)\,dt + \sigma\,dW_t
\)</span>$</p>
<p><span class="math notranslate nohighlight">\(F(r(t))\)</span>: Conservative forces originate from the system, such as intermolecular potentials.</p>
<p><span class="math notranslate nohighlight">\(\gamma\)</span>: Friction coefficient, $$ represents the viscous drag force.</p>
<p>The friction coefficient <span class="math notranslate nohighlight">\(\gamma\)</span> can be approximated by <span class="math notranslate nohighlight">\(\gamma = 6 \pi \eta a\)</span>, where <span class="math notranslate nohighlight">\(\eta\)</span> is the the dynamic viscosity of the medium and <span class="math notranslate nohighlight">\(a\)</span> is the radius of particle.</p>
<p><span class="math notranslate nohighlight">\(\sigma\)</span>: Strength of fluctuations, $$ represents the stochastic thermal force.</p>
<p><span class="math notranslate nohighlight">\(W_t\)</span> is the Wiener process, which is the cumulative Brownian random motion. <span class="math notranslate nohighlight">\(d W_t\)</span> is the Wiener increment as the infinitesimal step of the Brownian motion with <span class="math notranslate nohighlight">\(\langle dW_t \rangle = 0, \,\,\langle dW_t^2 \rangle = dt\)</span>.</p>
<ul class="simple">
<li><p>To show the conservation of T for the canonical ensemble can be realized by linking thermal fluctuation and viscous drag, Itô’s lemma is used to capture the stochastic relationship in a 1-D example.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
mdv = \big(F(r(t)) - \gamma v\big)\,dt + \sigma\,dW_t \,\, \rightarrow \,\, dv = A(v,t) \,dt + B(v, t) \, dW_t
\]</div>
<p>Since <span class="math notranslate nohighlight">\(F(r(t))\)</span> is the deterministic Newton’s Second Law, it will not be included in the discussion of kinetic energy dissipation and injection.</p>
<p>Similar to the transformation of thermodynamic variables, for a given function <span class="math notranslate nohighlight">\(f = f(v, t)\)</span>, it can be expressed with the above equation.</p>
<div class="math notranslate nohighlight">
\[
df = \frac{\partial f}{\partial t}\, dt + \frac{\partial f}{\partial v}\, dv \,\, \rightarrow \,\, df = f_t \, dt + f_v \, dv
\]</div>
<p>As <span class="math notranslate nohighlight">\(\langle dW_t \rangle = 0, \,\, \langle dW_t^2 \rangle = dt\)</span>, substituting <span class="math notranslate nohighlight">\(dv\)</span> with <span class="math notranslate nohighlight">\(A(v,t) \,dt + B(v, t) \, dW_t\)</span>. Since <span class="math notranslate nohighlight">\(d W_t\)</span> is a stochastic term, it is expanded and considered up to 2nd order.</p>
<div class="math notranslate nohighlight">
\[
df = f_t \, dt + f_v \, dv + \frac{1}{2} f_{vv} \, (dv)^2
\]</div>
<div class="math notranslate nohighlight">
\[
df = f_t \, dt + f_v \, (A(v,t) \,dt + B(v, t) \, dW_t) + f_{vv} \, (A(v,t) \,dt + B(v, t) \, dW_t)^2
\]</div>
<p>Using Itô’s lemma, <span class="math notranslate nohighlight">\((dt)^2 = 0,\, dt dW_t = 0, \, (d W_t)^2 = dt\)</span>.</p>
<div class="math notranslate nohighlight">
\[
df = (f_t + A f_v + \frac{1}{2} B^2 f_{vv}) \ dt + B f_v \, dW_t
\]</div>
<p>The first part <span class="math notranslate nohighlight">\((f_t + A f_v + \frac{1}{2} B^2 f_{vv}) \ dt\)</span> describes the drift of the function <span class="math notranslate nohighlight">\(f(v, t)\)</span>, and the second part <span class="math notranslate nohighlight">\(B f_v \, dW_t\)</span> describes the random fluctuations. Taking the average using Itô’s lemma, we identify the relationship with the stochastic term average to 0.</p>
<div class="math notranslate nohighlight">
\[
\frac{d}{dt} \langle f \rangle = \langle A f_v + \frac{1}{2} B^2 f_{vv} \rangle
\]</div>
<p>To investigate thermal equilibrium, <span class="math notranslate nohighlight">\(f(v, t)\)</span> can be set as the kinetic energy and say <span class="math notranslate nohighlight">\(f \propto v^2\)</span>.  With <span class="math notranslate nohighlight">\(A(v,t) = - \frac{\gamma}{m}v, \, \, B(v,t) = \frac{\sigma}{m}\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\frac{d}{dt} \langle v^2 \rangle  = - \frac{2 \gamma}{m} \langle v^2 \rangle + \frac{\sigma^2}{m^2}
\]</div>
<p>At constant temperature, the Maxwell-Boltzmann distribution suggests that the velocity variance is no longer changed.</p>
<div class="math notranslate nohighlight">
\[
0  = - \frac{2 \gamma}{m} \langle v^2 \rangle + \frac{\sigma^2}{m^2} \,\, \rightarrow \,\, \langle v^2 \rangle = \frac{\sigma^2}{2m\gamma}
\]</div>
<p>From thermodynamics, the average kinetic energy per degree of freedom is:</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{2} m \langle v^2 \rangle = \frac{1}{2} k_B T \,\, \rightarrow \,\, \frac{1}{2} m (\frac{\sigma^2}{2m\gamma}) = \frac{1}{2} k_B T
\]</div>
<p><strong>Fluctuation-dissipation relation</strong></p>
<div class="math notranslate nohighlight">
\[
\sigma^2 = 2\gamma k_B T
\]</div>
<p>Therefore, the strength of fluctuations <span class="math notranslate nohighlight">\(\sigma\)</span> is dependent on the friction coefficient <span class="math notranslate nohighlight">\(\gamma\)</span> under this stochastic process. Intuitively, large friction between molecules requires larger thermal fluctuations to maintain the same T.</p>
<p>This coupling verifies that the Langevin dynamics is a valid thermostat, which maintains the correct thermal distribution.</p>
<p>To integrate the Langevin dynamics, one way is to add the viscous drag and thermal fluctuation directly to the Velocity Verlet algorithm.</p>
<p><strong>Example: Velocity Verlet</strong></p>
<ol class="arabic simple">
<li><p>Half-step velocity update:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
v\!\left(t+\frac{\Delta t}{2}\right)
= v(t) + \frac{\Delta t}{2m} F(t) \,\, \rightarrow \,\, v\!\left(t+\frac{\Delta t}{2}\right)
= v(t) + \frac{\Delta t}{2m} F(t)
- \frac{\gamma \Delta t}{2}v(t)
+ \frac{\sigma}{2m}G_1\sqrt{\Delta t}
\]</div>
<ol class="arabic simple" start="2">
<li><p>Full-step position update, note that the velocity includes drag and noise:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
x(t+\Delta t)
= x(t) + \Delta t \, v\!\left(t+\frac{\Delta t}{2}\right)
\]</div>
<ol class="arabic simple" start="3">
<li><p>Half-step velocity update:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
v(t+\Delta t)
&amp;= v\!\left(t+\frac{\Delta t}{2}\right)
 + \frac{\Delta t}{2m} F(t+\Delta t)
\\
&amp;\rightarrow v(t+\Delta t)
 = v\!\left(t+\frac{\Delta t}{2}\right)
 + \frac{\Delta t}{2m} F(t+\Delta t)
 - \frac{\gamma \Delta t}{2}v\!\left(t+\frac{\Delta t}{2}\right)
 + \frac{\sigma}{2m}G_2\sqrt{\Delta t}
\end{aligned}
\end{split}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(G_1 G_2\)</span> are random standardized Gaussian variables, they represent the thermal noise and are independent of each other so <span class="math notranslate nohighlight">\(\langle G_1 G_2\rangle = 0\)</span>.</p>
<p>However, to retain symplectic properties, sophisticated schemes are highly recommended. A good reference for sophisticated algorithms that implement Langevin dynamics is “[Robust and eﬀicient configurational molecular sampling via Langevin dynamics, Leimkuhler; Matthews, J. Chem. Phys. 138, 174102 (2013)]”.</p>
<p>One popular algorithm is “BAOAB”, which means “B (force) <span class="math notranslate nohighlight">\(\rightarrow\)</span> A (drift) <span class="math notranslate nohighlight">\(\rightarrow\)</span> O (thermostat) <span class="math notranslate nohighlight">\(\rightarrow\)</span> A (drift) <span class="math notranslate nohighlight">\(\rightarrow\)</span> B (force)”.</p>
<p><strong>Example: BAOAB Scheme</strong></p>
<p>Step 1: Half step momentum update.</p>
<div class="math notranslate nohighlight">
\[
\textbf{B:}\quad
\mathbf{p}_{\frac{1}{2}} (\frac{\Delta t}{2}) \;=\; \mathbf{p}(0)\;+\;\frac{\Delta t}{2}\,\mathbf{F}\!\big(\mathbf{r}(0)\big)
\]</div>
<p>Step 2: Half step position update.</p>
<div class="math notranslate nohighlight">
\[
\textbf{A:}\quad
\mathbf{r}_{\frac{1}{2}} (\frac{\Delta t}{2}) \;=\; \mathbf{r}(0)\;+\;\frac{\Delta t}{2m}\,\mathbf{p}_{\frac{1}{2}} (\frac{\Delta t}{2})
\]</div>
<p>Step 3: Ornstein - Uhlenbeck thermostat update for force.</p>
<div class="math notranslate nohighlight">
\[
\textbf{O:}\quad
\mathbf{p}'_{\frac{1}{2}} (\frac{\Delta t}{2}) \;=\; e^{-\frac{\gamma\,\Delta t}{m}}\mathbf{p}_{\frac{1}{2}} (\frac{\Delta t}{2})
\;+\;\sqrt{\,m k_B T\,\Big(1 - e^{-\frac{2\gamma\,\Delta t}{m}}\Big)}\,\mathbf{G},
\qquad \mathbf{G}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
\]</div>
<p>Step 4: Half step position update.</p>
<div class="math notranslate nohighlight">
\[
\textbf{A:}\quad
\mathbf{r}(\Delta t) \;=\; \mathbf{r}_{\frac{1}{2}} (\frac{\Delta t}{2})\;+\;\frac{\Delta t}{2m}\,\mathbf{p}'_{\frac{1}{2}} (\frac{\Delta t}{2})
\]</div>
<p>Step 5: Half step momentum update.</p>
<div class="math notranslate nohighlight">
\[
\textbf{B:}\quad
\mathbf{p}(\Delta t) \;=\; \mathbf{p}'_{\frac{1}{2}} (\frac{\Delta t}{2})\;+\;\frac{\Delta t}{2}\,\mathbf{F}\!\big(\mathbf{r}(\Delta t)\big)
\]</div>
<p>This structure symmetrically splits the deterministic and stochastic updates, which is time-reversible.</p>
<p>The BAOAB algorithm is superior in position space. The steady-state positional distribution is exact up to <span class="math notranslate nohighlight">\(O((\Delta t)^4)\)</span>. This is important for the NVT ensemble, which preserves the exact Maxwell-Boltzmann distribution for positions.</p>
<p>The A-step and B-step are the same as the half-step position and velocity updates in the Velocity Verlet algorithm. Therefore, the deterministic part of the BAOAB algorithm is symplectic. However, the O-step breaks Liouville’s theorem with the friction.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
\mathbf{r}' = \mathbf{r}, \\
\mathbf{p}' = e^{-\frac{\gamma \Delta t}{m}} \mathbf{p}
+ \sqrt{m k_B T \left( 1 - e^{-2 \frac{\gamma \Delta t}{m}} \right)}\, \mathbf{G}
\end{cases}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
\frac{\partial \mathbf{r}'}{\partial \mathbf{r}} = \mathbf{I}, \qquad
\frac{\partial \mathbf{r}'}{\partial \mathbf{p}} = 0, \qquad
\frac{\partial \mathbf{p}'}{\partial \mathbf{r}} = 0, \qquad
\frac{\partial \mathbf{p}'}{\partial \mathbf{p}} = c\,\mathbf{I}
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
J_O = 
\begin{pmatrix}
\mathbf{I} &amp; 0 \\
0 &amp; e^{-\frac{\gamma \Delta t}{m}}\,\mathbf{I}
\end{pmatrix} \;\Rightarrow\;
\det(J_O)
= \det(\mathbf{I}) \cdot \det\!\left(e^{-\frac{\gamma \Delta t}{m}}\,\mathbf{I}\right)
= e^{-3\,\frac{\gamma \Delta t}{m}} \leq 1
\end{split}\]</div>
<p>As the frictional coefficient <span class="math notranslate nohighlight">\(\gamma &gt; 0\)</span>, the frictional force leads to the contraction in phase space volume. Energy is lost to the heat bath, but the stochastic random noise reinjects the energy and balances the dissipation on average. So the average energy stays constant at equilibrium and yields the correct Boltzmann distribution at steady state.</p>
</section>
<section id="brownian-dynamics">
<h2><span class="section-number">4.4.5. </span>Brownian Dynamics<a class="headerlink" href="#brownian-dynamics" title="Link to this heading">#</a></h2>
<p>As we showed before <span class="math notranslate nohighlight">\(\sigma^2 = 2\gamma k_B T\)</span>, the friction coefficient <span class="math notranslate nohighlight">\(\gamma\)</span> is highly dependent on the strength of fluctuation <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(\gamma \rightarrow 0\)</span>, then from the equation <span class="math notranslate nohighlight">\(\sigma \rightarrow 0\)</span>, the equation left is the pure deterministic Newton’s second law <span class="math notranslate nohighlight">\(m \frac{d v}{dt} = F (\mathbf{r} (t))\)</span>.</p>
<p>For the Langevin equation <span class="math notranslate nohighlight">\(mdv = \big(F(\mathbf{r}(t)) - \gamma v\big)\,dt + \sigma\,dW_t\)</span>, the equation is very similar to the damping equation <span class="math notranslate nohighlight">\(m \ddot{x} + \gamma \dot{x} + kx = 0\)</span> with the damping ratio <span class="math notranslate nohighlight">\(\zeta = \frac{\gamma}{2 \sqrt{km}}\)</span>.</p>
<p>If the damping ratio <span class="math notranslate nohighlight">\(\zeta\)</span> is very large, which means the system is friction-dominated, then <span class="math notranslate nohighlight">\(\gamma\)</span> is very large. The system does not exhibit any oscillation behaviors, and the relaxation process is very slow. Conceptually, damping is the resistance to motion, which is the frictional drag that constantly pulls the system back to rest.</p>
<p>At high <span class="math notranslate nohighlight">\(\gamma\)</span>, the system velocity would not pick up, thus the friction overcomes the inertia term <span class="math notranslate nohighlight">\(m \frac{dv}{dt}\)</span>. Then, the system would only follow the random thermal kicks or other external forces in the environment. An analogy for this is “a pendulum in thick honey”, which would never oscillate but respond to the thermal kicks from the honey molecules if we try to heat the honey.</p>
<p>In the above scenario, at the overdamped limit, for a 1-D system:</p>
<div class="math notranslate nohighlight">
\[
0 = F(r(t)) - \gamma v + dW_t
\]</div>
<p>Solve for <span class="math notranslate nohighlight">\(v\)</span> then the equation changes to:</p>
<div class="math notranslate nohighlight">
\[
v(t) = \frac{F(r(t))}{\gamma} + \frac{\sigma}{\gamma} d W_t
\]</div>
<p>Then, substitute <span class="math notranslate nohighlight">\(dx = v dt\)</span> , the system reduces to position-only dynamics as the <strong>Brownian equation</strong>.</p>
<div class="math notranslate nohighlight">
\[
dx = \frac{F(r(t))}{\gamma} dt + \frac{\sigma}{\gamma} dW_t
\]</div>
<p>By the fluctuation-dissipation theorem <span class="math notranslate nohighlight">\(\sigma^2 = 2\gamma k_B T\)</span>, the thermal fluctuation strength can be substituted with <span class="math notranslate nohighlight">\(\gamma\)</span>.</p>
<div class="math notranslate nohighlight">
\[
dx = \frac{F(r(t))}{\gamma} dt + \sqrt{\frac{2 k_B T}{\gamma}} dW_t
\]</div>
<p>The Stokes-Einstein equation defines the diffusion coefficient <span class="math notranslate nohighlight">\(D\)</span> as <span class="math notranslate nohighlight">\(D = \frac{k_B T}{\gamma}\)</span>.</p>
<div class="math notranslate nohighlight">
\[
dx = \frac{F(r(t))}{\gamma} dt + \sqrt{2D} dW_t
\]</div>
<p>Different components of the random displacement are statistically independent, therefore, the correlation of the process can be described by the delta function:</p>
<div class="math notranslate nohighlight">
\[
\langle G_i\,G_j \rangle = 2D\,\Delta t\,\delta_{ij}
\]</div>
<p>The Brownian equation describes the motion of a particle in highly viscous environments. At each infinitesimal timestep, the particle moves in the direction of force with a velocity of <span class="math notranslate nohighlight">\(\frac{F(r(t))}{\gamma}\)</span> and diffuses due to the random thermal kick by the surrounding fluid.</p>
<p>A good example of the Brownian motion is the <strong>Perrin experiment</strong>, where the experiment used a microscope to observe the three tracings of the motion of colloidal particles of radius <span class="math notranslate nohighlight">\(0.53 \mu m\)</span>.</p>
<figure class="align-center" id="perrin-experiment">
<a class="reference internal image-reference" href="../_images/Perrin_Experiment.jpg"><img alt="The Colloidal motions under microscope in Perrin experiment." src="../_images/Perrin_Experiment.jpg" style="width: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4.4 </span><span class="caption-text">The Colloidal motions under microscope in Perrin experiment.</span><a class="headerlink" href="#perrin-experiment" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Recall from the previous discussion, the diffusion coefficient can also be measured by the mean-square displacement <span class="math notranslate nohighlight">\(\langle \Delta r(t)^2 \rangle\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\langle \Delta r(t)^2 \rangle = 2 d D t \,\, \text{(d: dimension)}
\]</div>
<p>For the Brownian equation, suppose <span class="math notranslate nohighlight">\(F = 0\)</span>, then the equation can be integrated, and take average can be taken to compare with the mean square displacement.</p>
<div class="math notranslate nohighlight">
\[
dx = \sqrt{2D} dW_t
\]</div>
<div class="math notranslate nohighlight">
\[
x(t) - x(0) = \int_0^t \sqrt{2D} \, dW_t = \sqrt{2D} (W_t - W_0)
\]</div>
<p>The mean of the motion is 0, as the expectation value of the Wiener process is 0.</p>
<div class="math notranslate nohighlight">
\[
\mathrm{E}[W_t] = 0 \rightarrow \mathrm{E}[\sqrt{2D} (W_t - W_0)] = 0
\]</div>
<p>The variance can be calculated through Itô’s isometry for any square-integrable process:</p>
<div class="math notranslate nohighlight">
\[
\mathrm{E}\!\left[\left(\int_0^t g_t\, dW_t \right)^2\right]
= 
\mathrm{E}\!\left[\int_0^t g_t^2\, dt \right]
\]</div>
<div class="math notranslate nohighlight">
\[
\mathrm{Var} [x(t) - x(0)] = \mathrm{E}\!\left[ \int_0^t \sqrt{2D} \, dW_t\right] = \mathrm{E}\!\left[ \int_0^t 2D \, dt\right] = 2Dt
\]</div>
<p>Therefore, the mean square can be calculated as:</p>
<div class="math notranslate nohighlight">
\[
\mathrm{E}[X^2] = \mathrm{E}[X]^2 + \mathrm{Var}[X] = 2Dt \rightarrow \text{MSD} = 2dDt \,\, \text{(d: dimension)}
\]</div>
<p>The Brownian motion equation is thus verified by the Perrin experiment and the Stokes-Einstein equation, confirming the fluctuation–dissipation picture that underlies Langevin dynamics.</p>
<p><strong>Discrete update rule for the Brownian Dynamics</strong></p>
<p>To implement in computational work, integrate the Brownian motion with a timestep <span class="math notranslate nohighlight">\(\Delta t\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\mathrm{d}\mathbf{x} = \frac{\mathbf{F}(\mathbf{r}(t))}{\gamma}\,\mathrm{d}t
+ \sqrt{\frac{2 k_B T}{\gamma}}\,\mathrm{d}\mathbf{W}_t \rightarrow \mathbf{x}(\Delta t)-\mathbf{x}(0)
= \int_{0}^{\Delta t}\frac{\mathbf{F}(\mathbf{r}(t))}{\gamma}\,\mathrm{d}t
+ \int_{0}^{\Delta t}\sqrt{\frac{2 k_B T}{\gamma}}\,\mathrm{d}\mathbf{W}_t
\]</div>
<p>For a small timestep <span class="math notranslate nohighlight">\(\Delta t\)</span>, we can approximate the results by Euler’s method:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{x}(\Delta t) \approx \mathbf{x}(0)
+ \frac{\mathbf{F}(\mathbf{x}(0))}{\gamma}\,\Delta t
+ \sqrt{\frac{2 k_B T}{\gamma}}\bigl(\mathbf{W}_{\Delta t}-\mathbf{W}_0\bigr)
\]</div>
<p>The change in the Wiener process can be assumed as Gaussian with a variance of <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\mathbf{W}_{\Delta t}-\mathbf{W}_0 = \sqrt{\Delta t}\,\mathbf{G},
\qquad \mathbf{G}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
\]</div>
<p>Therefore, the update rule can be expressed as:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{x}(\Delta t) = \mathbf{x}(0)
+ \frac{\mathbf{F}(\mathbf{x}(0))}{\gamma}\,\Delta t
+ \sqrt{\frac{2 k_B T\,\Delta t}{\gamma}}\,\mathbf{G} \qquad \mathbf{G}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
\]</div>
</section>
<section id="hydrodynamic-interactions">
<h2><span class="section-number">4.4.6. </span>Hydrodynamic Interactions<a class="headerlink" href="#hydrodynamic-interactions" title="Link to this heading">#</a></h2>
<p>When particles are under Brownian motion through a viscous solvent, they disturb the surrounding fluid and create a Stokes flow. However, the flow itself is not localized, but exerts a drag effect on nearby particles. Therefore, the motions of particles alter the velocity field that can be “felt” by all others. The phenomenon is called the <strong>hydrodynamic effect</strong>.</p>
<p>The displacement or force on one particle propagates through the viscous fluid, inducing correlated motion in the rest of the system.</p>
<p>A good reference that discussed hydrodynamic interaction is [Brownian dynamics with hydrodynamic interactions, Ermak; McCammon, J. Chem. Phys. 69, 1352 (1978); doi: 10.1063/1.436761].</p>
<p>For the Brownian particles, a generalized overdamped Langevin equation with the effect of the velocity field can be described by adjusting the velocity of each particle with a mobility tensor <span class="math notranslate nohighlight">\(\mathbf{M}\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\mathbf{v}_i = \sum_j \mathbf{M}_{ij} \mathbf{F}_j
\]</div>
<p>The full mobility tensor matrix is defined as a $$ symmetric matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\mathbf{M} =
\begin{pmatrix}
\mathbf{M}_{11} &amp; \mathbf{M}_{12} &amp; \cdots &amp; \mathbf{M}_{1N} \\
\mathbf{M}_{21} &amp; \mathbf{M}_{22} &amp; \cdots &amp; \mathbf{M}_{2N} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\mathbf{M}_{N1} &amp; \mathbf{M}_{N2} &amp; \cdots &amp; \mathbf{M}_{NN}
\end{pmatrix}
\end{equation}
\end{split}\]</div>
<p>where each block defines how a force on particle <span class="math notranslate nohighlight">\(j\)</span> produces a velocity on particle <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>To construct the mobility matrix, each term can be found by the following categories:</p>
<p>(a). Self-mobility (<span class="math notranslate nohighlight">\(i = j\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\mathbf{M}_{ii} = \frac{1}{6\pi\eta a}\,\mathbf{I}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is the solvent radius and <span class="math notranslate nohighlight">\(\eta\)</span> is the solvent viscosity.</p>
<p>(b). Long-range coupling - Oseen tensor (<span class="math notranslate nohighlight">\(i \neq j\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\mathbf{M}_{ij} = \frac{1}{8\pi\eta r_{ij}} 
\big( \mathbf{I} + \hat{\mathbf{r}}_{ij}\hat{\mathbf{r}}_{ij} \big),
\quad i \neq j
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{r}_{ij} = \mathbf{r}_i - \mathbf{r}_j\)</span> is the distance between 2 particles.</p>
<p>A long-range tensor can be found with Ewald sums through [Fiore et al., J. Chem. Phys., 146, 12416 (2019)], which decomposes <span class="math notranslate nohighlight">\(\mathbf{M}_{ij}\)</span> into a short-range “real-space” part and a long-range “wave-space” part using the Fourier transform. Then, the short range can be evaluated through the neighbor list, while the long range can be evaluated through the Fourier transform.</p>
<p>©. Rotne–Prager tensor (finite-size correction <span class="math notranslate nohighlight">\(r_{ij} \geq 2a\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\mathbf{M}_{ij} = \frac{1}{8\pi\eta r_{ij}} 
\left[
\left( 1 + \frac{2a^2}{3r_{ij}^2} \right)\mathbf{I}
+ \left( 1 - \frac{2a^2}{r_{ij}^2} \right)\hat{\mathbf{r}}_{ij}\hat{\mathbf{r}}_{ij}
\right]
\end{equation}
\]</div>
<p>This correction ensures that the final mobility tensor matrix is <strong>symmetric and positive definite</strong>, where <span class="math notranslate nohighlight">\(\mathbf{M}_{ij} = \mathbf{M}_{ji}\)</span>, thereby providing stable stochastic integration.</p>
<p>Physically, \mathbf{M}_{ij} is the hydrodynamic response tensor for interactions between particle <span class="math notranslate nohighlight">\(i\)</span> and particle <span class="math notranslate nohighlight">\(j\)</span>, which is the fluid velocity at <span class="math notranslate nohighlight">\(i\)</span> induced by a unit force on <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>For the particle <span class="math notranslate nohighlight">\(i\)</span>, a generalized overdamped Langevin equation with the solvent-mediated effect is described as:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\dot{\mathbf{x}}_i = \sum_j \mathbf{M}_{ij}(\mathbf{r})\,\mathbf{F}_j + \boldsymbol{\xi}_i(t)
\end{equation}
\]</div>
<p><span class="math notranslate nohighlight">\(\dot{\mathbf{x}}_i\)</span>: the velocity of particle <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\mathbf{F}_j\)</span>: the total deterministic force exerted on particle <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\boldsymbol{\xi}_i (t)\)</span>: random noise term of particle <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>For a given particle <span class="math notranslate nohighlight">\(i\)</span> and particle <span class="math notranslate nohighlight">\(j\)</span>, the fluctuation-dissipation theorem can be satisfied by the correlated fluctuations:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\left\langle \boldsymbol{\xi}_i(t)\, \boldsymbol{\xi}_j(t')^{\mathrm{T}} \right\rangle 
= 2 k_B T\, \mathbf{M}_{ij}(\mathbf{r})\, \delta(t - t')
\end{equation}
\]</div>
<p>Integrate over a small timestep <span class="math notranslate nohighlight">\(\Delta t\)</span>, the update rule can be expressed as:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\mathbf{x}(\Delta t) = \mathbf{x}(0) 
+ \big( \mathbf{M}\cdot\mathbf{f} + k_B T\, \nabla\cdot\mathbf{M} \big)\Delta t 
+ \mathbf{B}
\end{equation}
\]</div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\langle \mathbf{B}\mathbf{B}^{\mathrm{T}} \rangle = 2 k_B T\, \mathbf{M}\, \Delta t
\end{equation}
\]</div>
<p>In theory, the random thermal fluctuation term <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> can be calculated with the mobility matrix <span class="math notranslate nohighlight">\(\mathbf{M}\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\mathbf{B} = \sqrt{2k_B T\, \Delta t}\, \mathbf{M}^{1/2}\, \mathbf{G}
\end{equation} \qquad \mathbf{G}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
\]</div>
<p>While <span class="math notranslate nohighlight">\(\mathbf{M}^{1/2}\)</span> can be solved through the Eigen-decomposition method (not efficient), another way to solve this is to perform <strong>free drawing</strong> from the known covariance of the mobility operator. Based on [Fiore et al., J. Chem. Phys., 146, 12416 (2019)], a known Brownian noise can be drawn as:</p>
<div class="math notranslate nohighlight">
\[
\Delta\mathbf{x}_B
= \sqrt{2k_B T\,\Delta t}\;
\big(
\mathbf{M}^{(r)\,1/2}\,\mathbf{G}_r
+ 
\mathbf{M}^{(w)\,1/2}\,\mathbf{G}_w
\big)
\]</div>
<p>Here, both <span class="math notranslate nohighlight">\(\mathbf{M}^{(r)\,1/2}\)</span> (computed by local neighbor list) and <span class="math notranslate nohighlight">\(\mathbf{M}^{(w)\,1/2}\)</span> (computed by the Fourier transform) are known positive definite and symmetric matrices, then by drawing independent Gaussian vectors through <span class="math notranslate nohighlight">\(\mathbf{G}_r, \mathbf{G}_w \sim\mathcal{N}(\mathbf{0},\mathbf{I})\)</span> can still generate Brownian noise without solving a complicated linear system.</p>
<p>Therefore, for selected particles <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>, their motions are correlated based on the mobility matrix:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\left\langle \Delta\mathbf{r}_i\, \Delta\mathbf{r}_j^{\mathrm{T}} \right\rangle 
= 2 k_B T\, \mathbf{M}_{ij}\, \Delta t
\end{equation}
\]</div>
<p>As in the previous discussion, the Brownian motion describes the diffusion process in the stochastic term. It is noticeable that the above discussion can be connected to non-equilibrium thermodynamics.</p>
<div class="math notranslate nohighlight">
\[
\text{Fluxes} = \text{(transport coefficients)} \cdot \text{(driving forces)}
\]</div>
<ul class="simple">
<li><p>In Brownian dynamics, a force on one particle induces motion of another via solvent flow.</p></li>
<li><p>In kinetics, a gradient in one variable (say temperature) can drive another flux (say mass or charge).</p></li>
</ul>
<p>Onsager’s formalism, derived from nonequilibrium thermodynamics, provides a similar setup here:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{v}_i = \sum_j \mathbf{M}_{ij} \mathbf{F}_j  \Leftrightarrow \mathbf{J}_i = -\sum_j \mathbf{L}_{ij} \nabla \mathbf{\mu}_j
\]</div>
<p>In addition, the Onsager’s coefficients also have the property of being symmetric, positive definite, with <span class="math notranslate nohighlight">\(\mathbf{L}_{ij} = \mathbf{L}_{ji}\)</span> here, same as the mobility tensor <span class="math notranslate nohighlight">\(\mathbf{M}_{ij} = \mathbf{M}_{ji}\)</span>.</p>
<ul class="simple">
<li><p>If particle <span class="math notranslate nohighlight">\(j\)</span> induces motion in particle <span class="math notranslate nohighlight">\(i\)</span> through the solvent, then particle <span class="math notranslate nohighlight">\(i\)</span> would induce the same motion in <span class="math notranslate nohighlight">\(j\)</span> if their roles were reversed.</p></li>
<li><p>Every dissipative process in a near-equilibrium system has a symmetric, fluctuation-linked transport matrix that couples fluxes and forces.</p></li>
<li><p>The Hydrodynamics interactions, in essence, quantify how equilibrium fluctuations and dissipation are intertwined through microscopic reversibility.</p></li>
</ul>
</section>
<section id="langevin-thermostat-conclusion">
<h2><span class="section-number">4.4.7. </span>Langevin Thermostat: Conclusion<a class="headerlink" href="#langevin-thermostat-conclusion" title="Link to this heading">#</a></h2>
<p>By making γ small, the Langevin Dynamics can be used as a thermostat without significantly perturbing the system.</p>
<ul class="simple">
<li><p>A value γ ≈ 0.1 m/Å is usually considered “weak” coupling and good for thermostating.</p></li>
<li><p>Beware: Langevin thermostat does not conserve momentum (forces do not sum to zero). Hence, there are no zero degrees of freedom.</p></li>
<li><p>Hydrodynamics of an explicit solvent with Langevin thermostat may also get screened due to lack of momentum conservation.</p></li>
</ul>
<p>Langevin thermostat is an intermediate approach compared to Nosé–Hoover thermostat (deterministic and momentum conserved) and Andersen thermostat (stochastic reassignment but disrupts real dynamics). Hence, Langevin dynamics are often preferred for biomolecular, nanoparticle, and diffusive materials simulations, especially when realistic sampling of phase space is more critical than exact momentum conservation.</p>
</section>
<section id="references">
<h2><span class="section-number">4.4.8. </span>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Allen &amp; Tildesley, “Simulations of liquids” Appendix B - Reduced Units <span id="id2"><sup><a class="reference internal" href="../references/references.html#id11" title="Michael P Allen, Dominic J Tildesley, and others. Computer simulation of liquids. 1987.">2</a></sup></span></p></li>
<li><p>Seifert, U. (2025). Stochastic Thermodynamics. Cambridge University Press. <span id="id3"><sup><a class="reference internal" href="../references/references.html#id36" title="Udo Seifert. Stochastic Thermodynamics. Cambridge University Press, 2025.">33</a></sup></span></p></li>
<li><p>Gardiner, C. W. (2009). Stochastic Methods: A Handbook for the Natural and Social Sciences. Springer. <span id="id4"><sup><a class="reference internal" href="../references/references.html#id37" title="Crispin W. Gardiner. Stochastic Methods: A Handbook for the Natural and Social Sciences. Springer Series in Synergetics, 2009.">10</a></sup></span></p></li>
<li><p>Ermak, D. L., &amp; McCammon, J. A. (1978). <em>Brownian dynamics with hydrodynamic interactions</em>. <em>J. Chem. Phys.</em>, 69(4), 1352–1360. <span id="id5"><sup><a class="reference internal" href="../references/references.html#id38" title="Donald L. Ermak and J. Andrew McCammon. Brownian dynamics with hydrodynamic interactions. The Journal of Chemical Physics, 69(4):1352-1360, 1978.">7</a></sup></span></p></li>
<li><p>Kubo, R. (1966). <em>The fluctuation–dissipation theorem</em>. <em>Rep. Prog. Phys.</em>, 29(1), 255–284. <span id="id6"><sup><a class="reference internal" href="../references/references.html#id39" title="Ryogo Kubo. The fluctuation-dissipation theorem. Reports on Progress in Physics, 29(1):255-284, 1966.">18</a></sup></span></p></li>
<li><p>Risken, H. (1996). <em>The Fokker–Planck Equation: Methods of Solution and Applications</em>. Springer. <span id="id7"><sup><a class="reference internal" href="../references/references.html#id40" title="H. Risken. Fokker-planck equation: methods of solution and applications. Springer Series in Synergetics, 1996.">31</a></sup></span></p></li>
<li><p>van Kampen, N. G. (2007). <em>Stochastic Processes in Physics and Chemistry</em>. North-Holland. <span id="id8"><sup><a class="reference internal" href="../references/references.html#id41" title="N. G. van Kampen. Stochastic Processes in Physics and Chemistry. North-Holland, 2007.">44</a></sup></span></p></li>
<li><p>Leimkuhler, B., &amp; Matthews, C. (2013). <em>Robust and efficient configurational molecular sampling via Langevin dynamics</em>. <em>J. Chem. Phys.</em>, 138(17), 174102. <span id="id9"><sup><a class="reference internal" href="../references/references.html#id42" title="Benedict Leimkuhler and Charles Matthews. Robust and efficient configurational molecular sampling via langevin dynamics. The Journal of Chemical Physics, 138(17):174102, 2013.">20</a></sup></span></p></li>
<li><p>R. W. Balluffi, S. A. Allen, W. C. Carter (2005), <em>Kinetics of materials</em>, John Wiley  &amp; Sons, Inc. <span id="id10"><sup><a class="reference internal" href="../references/references.html#id43" title="R. W. Balluffi, S. M. Allen, and W. C. Carter. Kinetics of Materials. Wiley-Interscience, 2005.">3</a></sup></span></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./molecular-dynamics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="thermostats.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4.3. </span>Thermostats</p>
      </div>
    </a>
    <a class="right-next"
       href="md-packages.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.5. </span>Using MD Packages</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implicit-solvent-models">4.4.1. Implicit-Solvent Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.4.2. Langevin Dynamics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fluctuation-dissipation-theorem">4.4.3. Fluctuation-dissipation theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langevin-equation">4.4.4. Langevin Equation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brownian-dynamics">4.4.5. Brownian Dynamics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hydrodynamic-interactions">4.4.6. Hydrodynamic Interactions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langevin-thermostat-conclusion">4.4.7. Langevin Thermostat: Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">4.4.8. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Antonia Statt
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>