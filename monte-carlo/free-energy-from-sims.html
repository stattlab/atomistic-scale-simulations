
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.12. Free Energy Estimation in Simulations &#8212; Atomistic Scale Simulations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/image_dark_mode.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myadmonitions.css?v=5b3d7684" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=80cd6c28" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"d": ["{\\operatorname{d}\\!{#1}}", 1], "dd": ["{\\d{}^{#1} #2 \\over \\d{#3}^{#1}}", 3], "pp": ["{\\partial^{#1} #2 \\over \\partial #3^{#1}}", 3], "td": ["{\\left(\\pp{#1}{#2}{#3} \\right)_{#4}}", 4], "ubar": ["\\underline{#1}", 1], "vv": ["\\mathbf{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'monte-carlo/free-energy-from-sims';</script>
    <link rel="canonical" href="https://stattlab.github.io/atomistic-scale-simulations/monte-carlo/free-energy-from-sims.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. References" href="../references/references.html" />
    <link rel="prev" title="5.11. Kinetic Monte Carlo" href="kinetic-mc.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Atomistic Scale Simulations</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/index.html">1. Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/why-atomistic-scale.html">1.1. Why are we interested in the atomistic scale?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/what-are-simulations.html">1.2. What are Simulations?</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecular-models-and-interactions/index.html">2. Molecular Models and Interactions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/molecular-models.html">2.2. Molecular Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/periodic-boundary-conditions.html">2.3. Periodic Boundary Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/intramolecular-potentials.html">2.4. Intermolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/short-ranged-potentials.html">2.5. Short-Ranged Intramolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/electrostatics.html">2.6. Long-Range Potentials</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../statmech-thermo/index.html">3. Statistical Mechanics and Thermodynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/introduction.html">3.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/ensembles.html">3.2. Thermodyanmics and Ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/statmech-ergodicity.html">3.3. Statistical Mechanics: Ensembles, Ergodicity and other Stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/thermodynamic-properties.html">3.4. Thermodyanmics Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/entropy-temperature.html">3.5. Entropy and Temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/structural-correlations.html">3.6. Structural Correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/transport-coefficients.html">3.7. Transport Coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/statistical-errors.html">3.8. Statistical Errors</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecular-dynamics/index.html">4. Molecular Dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/introduction.html">4.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/verlet-integration.html">4.2. Verlet Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/thermostats.html">4.3. Thermostats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/langevin-dynamics.html">4.4. Langevin Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/md-packages.html">4.5. Using MD Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/neighbor-list.html">4.6. Initialization and Neighbor Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/high-performance-computing.html">4.7. HPC (High-Performance Computing)</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">5. Monte Carlo Simulations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">5.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="random-numbers.html">5.2. Random Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="monte-carlo-method.html">5.3. Monte Carlo Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="sampling.html">5.4. Sampling Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="phase-coexistence.html">5.5. Gibbs Ensemble and Phase Coexistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="finite-size.html">5.6. Phase Transitions, Finite-size Scaling and Renormalization Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="variance-reduction.html">5.7. Variance Reduction Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="metropolis.html">5.8. Metropolis Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="ising-model.html">5.9. The Ising Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="directed-mc.html">5.10. Directed Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="kinetic-mc.html">5.11. Kinetic Monte Carlo</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">5.12. Free Energy Estimation in Simulations</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../references/references.html">6. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">7. Credits</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations/issues/new?title=Issue%20on%20page%20%2Fmonte-carlo/free-energy-from-sims.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/monte-carlo/free-energy-from-sims.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Free Energy Estimation in Simulations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">5.12.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methods-for-free-energy-estimation">5.12.2. Methods for Free-Energy Estimation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-integration">5.12.3. Thermodynamic Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-methods">5.12.4. Direct Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#particle-insertion-deletion-methods">5.12.5. Particle Insertion/Deletion Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grand-canonical-ensemble-method">5.12.6. Grand Canonical Ensemble Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#artificial-thermodynamic-integration">5.12.7. Artificial Thermodynamic Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acceptance-ratio-method-bennett">5.12.8. Acceptance Ratio Method (Bennett)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#umbrella-sampling-histogram-method">5.12.9. Umbrella Sampling / Histogram Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">5.12.10. References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="free-energy-estimation-in-simulations">
<h1><span class="section-number">5.12. </span>Free Energy Estimation in Simulations<a class="headerlink" href="#free-energy-estimation-in-simulations" title="Link to this heading">#</a></h1>
<p>Free energy differences are needed to determine phase stability. Direct simulation is too expensive and unreliable due to size effects, critical slowing down, and hysteresis. Free energy is determined by integrating over a reversible path, not directly measured.</p>
<section id="overview">
<h2><span class="section-number">5.12.1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This is a brief overview of free energy estimation, much of which can be found in the article by D. Frenkel: \emph{Free-Energy Computation and First-Order Phase Transitions}, in \emph{MD simulation of Statistical Mechanical Systems}, edited by Ciccotti and Hoover. Generic remarks are given in A&amp;T on pg. 40. Specific methods refer to various relevant pages.</p>
<p>The free energy is related to the partition function by:</p>
<div class="amsmath math notranslate nohighlight" id="equation-04035ad8-0b83-4320-aef6-4f9fe4eb245b">
<span class="eqno">(5.1)<a class="headerlink" href="#equation-04035ad8-0b83-4320-aef6-4f9fe4eb245b" title="Permalink to this equation">#</a></span>\[\begin{equation}
    e^{-\beta F} = \frac{1}{N! \Lambda^{dN}} \int dR\, e^{-\beta V(R)} = Z
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the number of particles, <span class="math notranslate nohighlight">\(d\)</span> is the dimension, <span class="math notranslate nohighlight">\(\beta = (k_B T)^{-1}\)</span>, and <span class="math notranslate nohighlight">\(\Lambda = (4 \pi \lambda \beta)^{-3/2}\)</span> is the classical thermal de Broglie wavelength.</p>
<p>The Gibbs free energy is</p>
<div class="amsmath math notranslate nohighlight" id="equation-5f223fe7-750e-4258-b38c-830af129d970">
<span class="eqno">(5.2)<a class="headerlink" href="#equation-5f223fe7-750e-4258-b38c-830af129d970" title="Permalink to this equation">#</a></span>\[\begin{equation}
    G = \mu N = F + PV
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is the chemical potential per particle.</p>
<p>The entropy can be obtained from the free energy.
Free energy differences are needed to determine phase stability. Direct simulation of stability of a given phase is too expensive and unreliable. For example the different phases may have different size effects, there can be critical slowing down and hysteris effects. In experiment, the free energy is determined experimentally
by integrating over a reversible path; one cannot measure it directly.</p>
</section>
<section id="methods-for-free-energy-estimation">
<h2><span class="section-number">5.12.2. </span>Methods for Free-Energy Estimation<a class="headerlink" href="#methods-for-free-energy-estimation" title="Link to this heading">#</a></h2>
<p>We will briefly describe seven methods that may be used in order to calculate the free energies. Each method has its own difficulties and, therefore, the choice of method for a particular problem should be chosen with the specific application in mind. Careful checks and analysis are required to have trustworthy results.
For lattice Hamiltonians some of the methods described are not applicable because many ground states may compete at finite temperature, depending on the range and types (i.e., pair, triplet, etc.) of interactions. Therefore you usually need to know which and how many Free Energies are needed a priori via simulation to construct the temperature versus composition phase diagram, beyond simply performing the simulation</p>
</section>
<section id="thermodynamic-integration">
<h2><span class="section-number">5.12.3. </span>Thermodynamic Integration<a class="headerlink" href="#thermodynamic-integration" title="Link to this heading">#</a></h2>
<p>With this method one establishes the free energy in a reference state and then integrates the derivative of the free energy (which we can calculate) along a path from the reference state to the desired state with respect to the density or the temperature or even with respect to an artificial parameter. To integrate with respect to the density we have:</p>
<div class="math notranslate nohighlight">
\[
    \left( \frac{dF}{dV} \right)_{N,T} = -P \Rightarrow F(V) = F_0(V) + \int_0^\rho \frac{d\rho'}{N\beta \rho'} \left( \beta P/\rho' - 1 \right)
\]</div>
<p>Here, F0 is the free particle free energy, which is known exactly. For a fluid one is performing a density integration from ρ = 0 to the density of interest.</p>
<div class="math notranslate nohighlight">
\[
    \left( \frac{d(F\beta)}{d\beta} \right)_{N,V} = E \Rightarrow F(T) = F_0(T) + \beta^{-1} \int_0^\beta d\beta' \left( E(\beta') - E_0(\beta') \right)
\]</div>
<p>Here, F0 and E0 are the free energy and energy of a reference system, which must be known exactly. For a solid, a temperature integration is performed from <span class="math notranslate nohighlight">\(\beta = \infty\)</span> to the temperature of interest.
When performing these thermal integrations, you must not cross a phase boundary, since the derivatives needed will depend very sensitively on the size of system and may be subject to critical slowing down. Notice that many careful simulations are required but this method always works! Clever choices of the path can save much computer time.</p>
</section>
<section id="direct-methods">
<h2><span class="section-number">5.12.4. </span>Direct Methods<a class="headerlink" href="#direct-methods" title="Link to this heading">#</a></h2>
<p><strong>Hit or Miss Method</strong> Sample some probability distribution <span class="math notranslate nohighlight">\(p(R)\)</span> with <span class="math notranslate nohighlight">\(R dRp(R) = 1\)</span></p>
<div class="math notranslate nohighlight">
\[
e^{-\beta F} = \frac{1}{N! \Lambda^{3N}} \int dR\, p(R) \frac{e^{-\beta V(R)}}{p(R)} = e^{-\beta F_0} \left\langle \frac{e^{-\beta V(R)}}{p(R)} \right\rangle_p
\]</div>
<p>For non-trivial problems, this method gives a very large variance since it is very difficult to make p® large where V® is small.</p>
<p><strong>Sample <span class="math notranslate nohighlight">\(e^{-\beta V}Z\)</span> Method</strong>: Calculate the following estimator.</p>
<div class="amsmath math notranslate nohighlight" id="equation-bcc3e2b8-3f18-4874-a6b7-fbd8c326d0d9">
<span class="eqno">(5.3)<a class="headerlink" href="#equation-bcc3e2b8-3f18-4874-a6b7-fbd8c326d0d9" title="Permalink to this equation">#</a></span>\[\begin{equation}
    Z^{-1} = \left\langle e^{-\beta H} \right\rangle
\end{equation}\]</div>
<p>However, this has a very large variance unless V® is very weak.</p>
</section>
<section id="particle-insertion-deletion-methods">
<h2><span class="section-number">5.12.5. </span>Particle Insertion/Deletion Methods<a class="headerlink" href="#particle-insertion-deletion-methods" title="Link to this heading">#</a></h2>
<p>Calculate the following average to obtain directly the chemical potential relative to the ideal gas:
$<span class="math notranslate nohighlight">\(
    \mu = \mu_{\text{ideal}} - k_B T \ln \left\langle e^{-\beta(V_N(r_N) - V_{N-1}(r))} \right\rangle_{N-1}
\)</span><span class="math notranslate nohighlight">\(
Here we sample \)</span>e^{−\beta V_{N−1}} , a N-1 particle system, and add a particle uniformly at random and find the change in energy, VN - VN−1. Recall, <span class="math notranslate nohighlight">\(μ_\text{ideal} = k_BT ln(\Lambda^{cl}\rho)\)</span>. This method becomes very difficult as density increases and impossible for a solid. Also random deletion has infinite variance for hardcore systems.</p>
</section>
<section id="grand-canonical-ensemble-method">
<h2><span class="section-number">5.12.6. </span>Grand Canonical Ensemble Method<a class="headerlink" href="#grand-canonical-ensemble-method" title="Link to this heading">#</a></h2>
<p>Given the Grand Canonical Ensemble of constant μ, T, V, one may calculate from the Gibbs’ Free Energy the Free Energy as</p>
<div class="math notranslate nohighlight">
\[
    \frac{F}{N} = \mu - \frac{\langle P \rangle V}{\langle N \rangle}
\]</div>
<p>This technique had very slow convergence at high densities (i.e., solids) and roughly only good for <span class="math notranslate nohighlight">\(\rho &lt; \rho_\text{critical}\)</span>. In addition, there is a large size dependence.</p>
</section>
<section id="artificial-thermodynamic-integration">
<h2><span class="section-number">5.12.7. </span>Artificial Thermodynamic Integration<a class="headerlink" href="#artificial-thermodynamic-integration" title="Link to this heading">#</a></h2>
<p>Here one must sample from an artificial distribution <span class="math notranslate nohighlight">\((R, \lambda)\)</span> such that <span class="math notranslate nohighlight">\(\Pi(R, \lambda)\)</span> interpolates between two distributions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \Pi(R, 0) &amp;= \text{known reference state} \\
    \Pi(R, 1) &amp;= \frac{e^{-\beta V}}{Z}
\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\lambda\)</span> is an adjustable parameter to “turn on” the interactions: <span class="math notranslate nohighlight">\(H(\lambda) = H_0 + \lambda H_1\)</span>, where we know how to obtain the free energy, etc., for H0. The partition function may be obtained as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Z(\lambda) = \int d\vec{R} \Pi(R,\lambda)\\
    Z = Z_0 \exp\left[ \int_0^1 d\lambda \left\langle \ln \left( \frac{\Pi(R, 1)}{\Pi(R, 0)} \right) \right\rangle_\lambda \right]
\end{split}\]</div>
<p>Care must be taken when using this method.</p>
<ol class="arabic simple">
<li><p>Carefully pick a reference state <span class="math notranslate nohighlight">\(\Pi(R, 0)\)</span> as close to <span class="math notranslate nohighlight">\(\Pi(R, 1)\)</span> as possible.</p></li>
<li><p>Make sure there are no Phase Boundaries between <span class="math notranslate nohighlight">\(\Pi(R, 0)\)</span>  and <span class="math notranslate nohighlight">\(\Pi(R, 1)\)</span> .</p></li>
<li><p><span class="math notranslate nohighlight">\( \ln(\Pi(R, \lambda)) = \ln(\Pi(R, 0)) + \lambda \ln\left(\frac{\Pi(R,1)}{ \Pi(R,0)}\right) \)</span></p></li>
<li><p>simulate <span class="math notranslate nohighlight">\(\Pi(R, λ)\)</span> for several λ’s.</p></li>
</ol>
<p>We now obtain the Free Energy of system by</p>
<div class="math notranslate nohighlight">
\[
F=F_0+\beta^{-1} \int_0^1 d \lambda\left\langle\ln \left(\frac{\Pi(R, 1)}{\Pi(R, 0)}\right)\right\rangle_\lambda
\]</div>
<p>Beware of any non-analytic behavior as a function of λ. Also choose CPU time (<span class="math notranslate nohighlight">\(\propto \lambda's\)</span>) so that uncertainties are independent of λ.</p>
<p>Let us consider the case where only the potential matters. Here V(λ) = V0 + λ V1, and, therefore, λ=0 we have V(λ) = V0 with known F0, whereas, for λ=1 we have V(λ). Generally, then</p>
<div class="math notranslate nohighlight">
\[
    F(\lambda) = -k_B T \ln \left[ \frac{1}{N! \Lambda^{3N}} \int d^N q\, e^{-\beta V(\lambda)} \right]
\]</div>
<p>With F0 known,
$<span class="math notranslate nohighlight">\(
    \frac{dF(\lambda)}{d\lambda} = \left\langle \frac{dV(\lambda)}{d\lambda} \right\rangle_\lambda
\)</span>$</p>
<p>Notice that <span class="math notranslate nohighlight">\(\langle dV (λ)/d\lambda \rangle\)</span>, a canonical average of a mechanical quantity for a system with H(λ), can be obtained by a computer simulation, just as we have done for all other mechanical properties!</p>
<p>Examples of Artificial Integrations</p>
<ul class="simple">
<li><p>Map a complicated liquid into a simple liquid (e.g., Car-Parinello Si <span class="math notranslate nohighlight">\(\rightarrow\)</span> empirical force filed for Si).</p></li>
<li><p>Realistic solid <span class="math notranslate nohighlight">\(\rightarrow\)</span> Einstein solid, so as to use <span class="math notranslate nohighlight">\(V_E = K \sum(r_i − r_{0,i})^2\)</span>.</p></li>
<li><p>Perfect crystal <span class="math notranslate nohighlight">\(\rightarrow\)</span> defective crystal, e.g., turn off one atom.</p></li>
<li><p>Bcc crystal <span class="math notranslate nohighlight">\(\rightarrow\)</span> Fcc crystal, via distortion of simulation box.</p></li>
<li><p>Coiled protein <span class="math notranslate nohighlight">\(\rightarrow\)</span> straight protein, by applying end-to-end force.</p></li>
</ul>
</section>
<section id="acceptance-ratio-method-bennett">
<h2><span class="section-number">5.12.8. </span>Acceptance Ratio Method (Bennett)<a class="headerlink" href="#acceptance-ratio-method-bennett" title="Link to this heading">#</a></h2>
<p>Suppose you want to calculate the free energy distribution between Π0® and Π1®, where Zk = R Πk for k=0,1. We then are considering an enlarged sample space, i.e. (R,k). System is allowed to hop from 0 to 1. Thus, there are two types of moves: 1) usual R → R’, and 2) transition between k → k’, given by T. Here, Pk = probability that system is in state k (irrespective of R).</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Pi(R,k) &amp;=
\begin{cases}
    \Pi_0(R) &amp; k=0 \\
    c\, \Pi_1(R) &amp; k=1
\end{cases}
\end{split}\]</div>
<p>and “c” is the importance sampling parameter. Therefore, we find that</p>
<div class="math notranslate nohighlight">
\[
\frac{P_0}{P_1} &amp;= \frac{Z_0}{cZ_1}
\]</div>
<p>which is how we can calculate Z0/Z1. The optimal value of the importance sampling parameter is usually
c≈ Z0/Z1. Let T0→1 and T1→0 be the transition rates of hopping from 0 → 1, or vice-versa. We then have</p>
<div class="math notranslate nohighlight">
\[
\frac{P_0}{P_1} = \frac{\langle T_{1 \rightarrow 0} \rangle_1}{\langle T_{0 \rightarrow 1} \rangle_0}
\]</div>
<p>Use a heat bath for T:
$<span class="math notranslate nohighlight">\(
T_{1 \rightarrow 0} = \frac{c \Pi_1}{\Pi_0 + c \Pi_1} = \frac{1}{1 + \Pi_0 / (c \Pi_1)}
\)</span>$</p>
<p>Finally, we see that</p>
<div class="math notranslate nohighlight">
\[
   \frac{Z_0}{Z_1} &amp;= c \frac{ \left\langle \left(1 + \frac{\Pi_0}{c\Pi_1} \right)^{-1} \right\rangle_0 }{ \left\langle \left(1 + \frac{c\Pi_1}{\Pi_0} \right) \right\rangle_1 }
\]</div>
<p>whose variance will be large unless we can hop from 0 ↔ 1. Notice that by introducing more states 0 ≤ λi ≤ 1 leads to a continuous transition and, therefore, to exact thermodynamic integration.</p>
</section>
<section id="umbrella-sampling-histogram-method">
<h2><span class="section-number">5.12.9. </span>Umbrella Sampling / Histogram Method<a class="headerlink" href="#umbrella-sampling-histogram-method" title="Link to this heading">#</a></h2>
<p>Within this approach one applies importance sampling to
$<span class="math notranslate nohighlight">\(
\frac{Z_1}{Z_0}=\frac{\int d \mathbf{R} \Pi_1(R)}{\int d \mathbf{R} \Pi_0(R)}
\)</span>$</p>
<p>Sample R from <span class="math notranslate nohighlight">\(\Pi^*\)</span> within Metropolis Algorithm, thereby giving the estimator
$<span class="math notranslate nohighlight">\(
\frac{Z_1}{Z_0}=\frac{\left\langle\Pi_1 / \Pi^*\right\rangle_{\Pi^*}}{\left\langle\Pi_0 / \Pi^*\right\rangle_{\Pi^*}}
\)</span>$</p>
<p>Here is an example with <span class="math notranslate nohighlight">\(\Pi^*=\sqrt{\Pi_0 \Pi_1}\)</span>. In this case,
$<span class="math notranslate nohighlight">\(
\frac{Z_1}{Z_0}=\frac{\left\langle\sqrt{\Pi_1 / \Pi_0}\right\rangle_{\Pi^*}}{\left\langle\sqrt{\Pi_0 / \Pi_1}\right\rangle_{\Pi^*}}
\)</span>$</p>
<p>Thus, the optimal <span class="math notranslate nohighlight">\(\Pi^*\)</span> is found by usual method:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Pi^* &amp; \propto \sqrt{\Pi_0 \Pi_1}\left|f(R)-f(R)^{-1}\right| \\
&amp; =\left|\Pi_0 / Z_0-\Pi_1 / Z_1\right|
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(f=\sqrt{\left(\Pi_1 Z_0\right) /\left(\Pi_0 Z_1\right)}\)</span>. We can introduce an uncertainty in <span class="math notranslate nohighlight">\(Z_1 / Z_0\)</span> as</p>
<div class="math notranslate nohighlight">
\[
\Pi^* \approx \sqrt{\left(\Pi_0-c \Pi_1\right)^2+\epsilon c \Pi_0 \Pi_1}
\]</div>
<p>where c is an estimator of <span class="math notranslate nohighlight">\(Z_0 / Z_1\)</span> and <span class="math notranslate nohighlight">\(\epsilon\)</span> is chosen to minimize variance (arising from undersampling and convergence).</p>
<p>In lattice models this method is know as the histogram method.</p>
</section>
<section id="references">
<h2><span class="section-number">5.12.10. </span>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>D. Frenkel, ``Free-Energy Computation and First-Order Phase Transitions’’ in \textit{MD Simulation of Statistical Mechanical Systems}, ed. Ciccotti and Hoover.</p></li>
<li><p>Allen and Tildesley</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./monte-carlo"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="kinetic-mc.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5.11. </span>Kinetic Monte Carlo</p>
      </div>
    </a>
    <a class="right-next"
       href="../references/references.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>References</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">5.12.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methods-for-free-energy-estimation">5.12.2. Methods for Free-Energy Estimation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-integration">5.12.3. Thermodynamic Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-methods">5.12.4. Direct Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#particle-insertion-deletion-methods">5.12.5. Particle Insertion/Deletion Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grand-canonical-ensemble-method">5.12.6. Grand Canonical Ensemble Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#artificial-thermodynamic-integration">5.12.7. Artificial Thermodynamic Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acceptance-ratio-method-bennett">5.12.8. Acceptance Ratio Method (Bennett)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#umbrella-sampling-histogram-method">5.12.9. Umbrella Sampling / Histogram Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">5.12.10. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Antonia Statt
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>