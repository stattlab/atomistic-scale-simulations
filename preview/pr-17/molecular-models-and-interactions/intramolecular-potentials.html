
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.4. Intermolecular Potentials &#8212; Atomistic Scale Simulations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/image_dark_mode.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myadmonitions.css?v=5b3d7684" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=80cd6c28" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"d": ["{\\operatorname{d}\\!{#1}}", 1], "dd": ["{\\d{}^{#1} #2 \\over \\d{#3}^{#1}}", 3], "pp": ["{\\partial^{#1} #2 \\over \\partial #3^{#1}}", 3], "td": ["{\\left(\\pp{#1}{#2}{#3} \\right)_{#4}}", 4], "ubar": ["\\underline{#1}", 1], "vv": ["\\mathbf{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'molecular-models-and-interactions/intramolecular-potentials';</script>
    <link rel="canonical" href="https://stattlab.github.io/atomistic-scale-simulations/molecular-models-and-interactions/intramolecular-potentials.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.5. Short-Ranged Intramolecular Potentials" href="short-ranged-potentials.html" />
    <link rel="prev" title="2.3. Periodic Boundary Conditions" href="periodic-boundary-conditions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Atomistic Scale Simulations</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/index.html">1. Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/why-atomistic-scale.html">1.1. Why are we interested in the atomistic scale?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/what-are-simulations.html">1.2. What are Simulations?</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">2. Molecular Models and Interactions</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="molecular-models.html">2.2. Molecular Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="periodic-boundary-conditions.html">2.3. Periodic Boundary Conditions</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.4. Intermolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="short-ranged-potentials.html">2.5. Short-Ranged Intramolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="electrostatics.html">2.6. Long-Range Potentials</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../statmech-thermo/index.html">3. Statistical Mechanics and Thermodynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/introduction.html">3.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/ensembles.html">3.2. Thermodyanmics and Ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/statmech-ergodicity.html">3.3. Statistical Mechanics: Ensembles, Ergodicity, and Other Stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/thermodynamic-properties.html">3.4. Thermodyanmics Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/entropy-temperature.html">3.5. Entropy and Temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/structural-correlations.html">3.6. Structural Correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/transport-coefficients.html">3.7. Transport Coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statmech-thermo/statistical-errors.html">3.8. Statistical Errors</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecular-dynamics/index.html">4. Molecular Dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/introduction.html">4.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/verlet-integration.html">4.2. Verlet Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/thermostats.html">4.3. Thermostats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/langevin-dynamics.html">4.4. Langevin Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/md-packages.html">4.5. Using MD Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/neighbor-list.html">4.6. Initialization and Neighbor Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/high-performance-computing.html">4.7. HPC (High-Performance Computing)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../monte-carlo/index.html">5. Monte Carlo Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/introduction.html">5.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/random-numbers.html">5.2. Random Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/monte-carlo-method.html">5.3. Monte Carlo Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/sampling.html">5.4. Sampling Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/phase-coexistence.html">5.5. Gibbs Ensemble and Phase Coexistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/finite-size.html">5.6. Phase Transitions, Finite-size Scaling and Renormalization Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/variance-reduction.html">5.7. Variance Reduction Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/metropolis.html">5.8. Metropolis Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/ising-model.html">5.9. The Ising Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/directed-mc.html">5.10. Directed Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/kinetic-mc.html">5.11. Kinetic Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/free-energy-from-sims.html">5.12. Free Energy Estimation in Simulations</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../references/references.html">6. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">7. Credits</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations/issues/new?title=Issue%20on%20page%20%2Fmolecular-models-and-interactions/intramolecular-potentials.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/molecular-models-and-interactions/intramolecular-potentials.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Intermolecular Potentials</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bond-potentials">2.4.1. Bond Potentials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonic">2.4.1.1. Harmonic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fene-finite-extensible-nonlinear-elastic">2.4.1.2. FENE (Finite Extensible Nonlinear Elastic)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#angle-potentials">2.4.2. Angle Potentials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.4.2.1. Harmonic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cosine">2.4.2.2. Cosine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cosine-squared">2.4.2.3. Cosine squared</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dihedral-potentials">2.4.3. Dihedral Potentials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic">2.4.3.1. Periodic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ryckaert-bellemans">2.4.3.2. Ryckaert-Bellemans</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier">2.4.3.3. Fourier</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#improper-dihedrals">2.4.4. Improper Dihedrals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">2.4.5. References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">2.4.6. References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="intermolecular-potentials">
<h1><span class="section-number">2.4. </span>Intermolecular Potentials<a class="headerlink" href="#intermolecular-potentials" title="Link to this heading">#</a></h1>
<p>In addition to nonbonded interactions (e.g. Lennard–Jones and Coulomb), molecular simulations must describe the <em>internal</em> geometry of molecules:
how atoms are held together by covalent bonds and how those bonds can bend and twist. These “bonded” or “intramolecular” interactions are usually written in terms of:</p>
<ul class="simple">
<li><p>bond lengths between pairs of atoms <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>,</p></li>
<li><p>bond angles between triplets <span class="math notranslate nohighlight">\(i,j,k\)</span>, and</p></li>
<li><p>dihedral (torsional) angles between quadruplets <span class="math notranslate nohighlight">\(i,j,k,\ell\)</span>,</p></li>
</ul>
<p>in <a class="reference internal" href="#bonds-angles-fig"><span class="std std-numref">Fig. 2.12</span></a> most typical intermolecular potentials for a molecule are shown.</p>
<figure class="align-center" id="bonds-angles-fig">
<a class="reference internal image-reference" href="../_images/intramolecular-def.png"><img alt="Visualization of bonds, angles, and dihedrals in a molecule" src="../_images/intramolecular-def.png" style="width: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2.12 </span><span class="caption-text">Visualization of bonds, angles, and dihedrals in a molecule with four atoms.</span><a class="headerlink" href="#bonds-angles-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The total bonded <strong>intramolecular</strong> energy is conventionally written as:</p>
<div class="math notranslate nohighlight">
\[
 U = \sum_{\text{bonds}, {i,j} } U_b(r_{ij}) + \sum_{\text{angles}, {i,j,k}} U_\theta(\theta_{ijk}) + \sum_{\text{dihedrals}, {i,j,k,l} } U_\varphi(\varphi_{ijkl})
 \]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r_{ij} = \lVert \mathbf r_i - \mathbf r_j \rVert\)</span> is the bond length,</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta_{ijk}\)</span> is the angle at atom <span class="math notranslate nohighlight">\(j\)</span> between bonds <span class="math notranslate nohighlight">\(ij\)</span> and <span class="math notranslate nohighlight">\(jk\)</span>, and</p></li>
<li><p><span class="math notranslate nohighlight">\(\varphi_{ijkl}\)</span> is the dihedral angle defined by the two planes
<span class="math notranslate nohighlight">\((i,j,k)\)</span> and <span class="math notranslate nohighlight">\((j,k,\ell)\)</span>.</p></li>
</ul>
<p>For molecular dynamics, we do not only need energies but also forces. For any potential <span class="math notranslate nohighlight">\(U({\mathbf r_i})\)</span> the force on atom <span class="math notranslate nohighlight">\(i\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[
\mathbf F_i = - \nabla_i U
= - \left(
    \frac{\partial U}{\partial x_i},
    \frac{\partial U}{\partial y_i},
    \frac{\partial U}{\partial z_i}
  \right) .
\]</div>
<p>For bonded terms this is slightly more involved than for a simple pair potential, because we must use the chain rule:</p>
<p>we differentiate <span class="math notranslate nohighlight">\(U\)</span> with respect to <span class="math notranslate nohighlight">\(r_{ij}\)</span>, <span class="math notranslate nohighlight">\(\theta_{ijk}\)</span>, or <span class="math notranslate nohighlight">\(\phi_{ijkl}\)</span>,
and then differentiate those geometric quantities with respect to the atomic coordinates.</p>
<p>In actual simulations under periodic boundary conditions, distances such as <span class="math notranslate nohighlight">\(r_{ij}\)</span> are almost always computed with a ``minimum image’’ distance function, so that a bond crossing a periodic boundary still has the correct length.</p>
<p>To compute a conservative force in general:
<span class="math notranslate nohighlight">\( \vec{F}_i = -\nabla_i U \)</span> where <span class="math notranslate nohighlight">\(\nabla_i = \frac{\partial}{\partial r_i}\)</span> is
the gradient with respect to <span class="math notranslate nohighlight">\(r_i\)</span>.</p>
<section id="bond-potentials">
<h2><span class="section-number">2.4.1. </span>Bond Potentials<a class="headerlink" href="#bond-potentials" title="Link to this heading">#</a></h2>
<p>As shown in <a class="reference internal" href="#bond-def-fig"><span class="std std-numref">Fig. 2.13</span></a>, the <strong>bond length</strong> between particle <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> is given by</p>
<p><span class="math notranslate nohighlight">\( r_{ij} = \| \vec{r}_i - \vec{r}_j \| = \sqrt{(x_j-x_i)^2 + (y_j-y_i)^2 + (z_j-z_i)^2}\)</span>.</p>
<p>The <strong>bond vector</strong> is <span class="math notranslate nohighlight">\( \vec r_{ij} =  \vec{r}_i - \vec{r}_j \)</span>.</p>
<figure class="align-center" id="bond-def-fig">
<a class="reference internal image-reference" href="../_images/bond.png"><img alt="Definition of bond distance." src="../_images/bond.png" style="width: 200px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2.13 </span><span class="caption-text">Definition of bond distance.</span><a class="headerlink" href="#bond-def-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>To obtain the force on a bond we need to compute</p>
<div class="math notranslate nohighlight">
\[
 F_i = - \nabla_i U_b(r_{ij}) = - \frac{\partial U_b}{\partial r_i} \nabla_i r_{ij}\quad .
\]</div>
<p>For this, we need <span class="math notranslate nohighlight">\(\nabla_i r_{ij}\)</span>, which is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\nabla_i r_{ij} 
&amp;= \frac{\partial}{\partial x_{i,\alpha}} \left[ \sqrt{(x_{j,\alpha}-x_{i,\alpha})(x_{j,\alpha}-x_{i,\alpha})} \right]\\
&amp;= \frac{1}{2} \frac{-2 x_{j,\alpha}+2x_{i,\alpha}}{\sqrt{(x_{j,\alpha}-x_{i,\alpha})(x_{j,\alpha}-x_{i,\alpha})}}\\
&amp;= - \frac{x_{j,\alpha}-x_{i,\alpha}}{\sqrt{(x_{j,\alpha}-x_{i,\alpha})(x_{j,\alpha}-x_{i,\alpha})}}\\
&amp;= - \frac{r_{ij}}{|r_{ij}|}\\
&amp;= - \hat r_{ij} \, .
\end{aligned}
\end{split}\]</div>
<p>which is the unit vector pointing in the direction of the bond!</p>
<p>The force then is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
F_i &amp;= - \frac{\partial U_b(r_{ij})}{\partial r_{ij}} \, (-\hat r_{ij}) \\
    &amp;= - F_b(r_{ij}) \hat r_{ij}, \quad 
       F_b(r_{ij}) \equiv - \frac{\partial U_b(r_{ij})}{\partial r_{ij}} \, .
\end{aligned}
\end{split}\]</div>
<p>By symmetry we should have <span class="math notranslate nohighlight">\(\nabla_j r_{ij}=-\nabla_i r_{ji}\)</span>, meaning that</p>
<div class="math notranslate nohighlight">
\[
F_j = F_b(r_{ij}) \hat r_{ij} \quad.
\]</div>
<p>This shows that for a bond, <span class="math notranslate nohighlight">\(F_i = -F_j\)</span>, which illustrates that action has a equal and opposite reaction.</p>
<p>Thus the bond force is always collinear with the bond and equal and opposite on the two atoms — a direct manifestation of Newton’s third law. In code, one can compute the force once and apply <span class="math notranslate nohighlight">\(\mathbf F_i\)</span> and <span class="math notranslate nohighlight">\(-\mathbf F_i\)</span> to save work.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Once can use the action reaction principle to save on computations by only computing either <span class="math notranslate nohighlight">\(F_i\)</span> OR <span class="math notranslate nohighlight">\(F_j\)</span> and then applying the equal action-reaction principle to save on calculations.</p>
</div>
<section id="harmonic">
<h3><span class="section-number">2.4.1.1. </span>Harmonic<a class="headerlink" href="#harmonic" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\( U(r) = \frac{1}{2}k(r - r_0)^2 \)</span></p>
<p>Here:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r_0\)</span> is the equilibrium bond length,</p></li>
<li><p><span class="math notranslate nohighlight">\(k_b\)</span> is the force constant (spring constant) with units of
energy / length<span class="math notranslate nohighlight">\(^2\)</span>.</p></li>
</ul>
<p>This fixes the bond length to fluctuate around an average of <span class="math notranslate nohighlight">\(r_0\)</span>.</p>
<ul class="simple">
<li><p>Watch for factor of 2!</p></li>
<li><p>Typically <span class="math notranslate nohighlight">\( k \sim 10^3 \epsilon/l^2\)</span> for “stiff” bond</p></li>
</ul>
<p>This potential has a single minimum at <span class="math notranslate nohighlight">\(r_{ij} = r_0\)</span> and grows quadratically as the bond is stretched or compressed. The factor of <span class="math notranslate nohighlight">\(1/2\)</span> is conventional and very convenient: when we differentiate to obtain the force, the factor <span class="math notranslate nohighlight">\(2\)</span> from the exponent cancels the <span class="math notranslate nohighlight">\(1/2\)</span> in front, so <span class="math notranslate nohighlight">\(k_b\)</span> directly controls the strength of the force.</p>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="s1">&#39;../_matplotlib/book.mplstyle&#39;</span><span class="p">])</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Harmonic bond potential</span>
<span class="k">def</span><span class="w"> </span><span class="nf">harmonic_bond_potential</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">r0</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Harmonic bond force</span>
<span class="k">def</span><span class="w"> </span><span class="nf">harmonic_bond_force</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">r0</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r0</span><span class="p">)</span>

<span class="c1"># Parameters</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">r0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">r_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">U_values</span> <span class="o">=</span> <span class="n">harmonic_bond_potential</span><span class="p">(</span><span class="n">r_values</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">r0</span><span class="p">)</span>
<span class="n">F_values</span> <span class="o">=</span> <span class="n">harmonic_bond_force</span><span class="p">(</span><span class="n">r_values</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">r0</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mf">3.5</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_values</span><span class="p">,</span> <span class="n">U_values</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$r_0$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$r$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$U_{\mathrm</span><span class="si">{bond}</span><span class="s1">}(r)$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Harmonic Bond Potential&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_values</span><span class="p">,</span> <span class="n">F_values</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;seagreen&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$r_0$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$r$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$F_{\mathrm</span><span class="si">{bond}</span><span class="s1">}(r)$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Harmonic Bond Force&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./_figures/harmonic_bond.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:26: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:33: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:26: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:33: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_2185/129747257.py:26: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  axs[0].set_ylabel(&#39;$U_{\mathrm{bond}}(r)$&#39;)
/tmp/ipykernel_2185/129747257.py:33: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  axs[1].set_ylabel(&#39;$F_{\mathrm{bond}}(r)$&#39;)
</pre></div>
</div>
<img alt="../_images/b6c0481e239f9054b4e69e23ff3eaab33a2648211e48b8953ca5f38597dbbc31.png" src="../_images/b6c0481e239f9054b4e69e23ff3eaab33a2648211e48b8953ca5f38597dbbc31.png" />
</div>
</details>
</div>
<div class="admonition-example-harmonic-bond-force admonition">
<p class="admonition-title">Example: Harmonic bond force</p>
<p><span class="math notranslate nohighlight">\( U_b = \frac{1}{2}k(r - r_0)^2 \)</span>, so</p>
<p><span class="math notranslate nohighlight">\( F_b = \frac{\partial U_b}{\delta r_{ij}} = -k (r_{ij}-r_0)\)</span>, leading to</p>
<div class="math notranslate nohighlight">
\[\begin{split}
F_i &amp;= + (r_{ij}-r_0) \hat r_{ij}\\
F_j &amp;= - (r_{ij}-r_0) \hat r_{ij} \quad .
\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(r_{ij}&gt;r_0\)</span>, the bond is streched past <span class="math notranslate nohighlight">\(r_0\)</span> and particle <span class="math notranslate nohighlight">\(i\)</span> moves toward <span class="math notranslate nohighlight">\(j\)</span>, and <span class="math notranslate nohighlight">\(j\)</span> toward <span class="math notranslate nohighlight">\(i\)</span>. If <span class="math notranslate nohighlight">\(r_{ij}&lt;r_0\)</span>, the bond is compressed below the set point <span class="math notranslate nohighlight">\(r_0\)</span> and particle <span class="math notranslate nohighlight">\(i\)</span> moves away from <span class="math notranslate nohighlight">\(j\)</span>, and <span class="math notranslate nohighlight">\(j\)</span> away from <span class="math notranslate nohighlight">\(i\)</span>.</p>
<figure class="align-center" id="bond-fig">
<a class="reference internal image-reference" href="../_images/harmonic_bond.png"><img alt="Plot of the harmonic bond potential and force" src="../_images/harmonic_bond.png" style="width: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2.14 </span><span class="caption-text">Bond potential and force as function of bond length <span class="math notranslate nohighlight">\(r\)</span>.</span><a class="headerlink" href="#bond-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<p><strong>Physical picture</strong>.</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(r_{ij} &gt; r_0\)</span>, the bond is stretched:
<span class="math notranslate nohighlight">\(r_{ij} - r_0 &gt; 0\)</span>, so <span class="math notranslate nohighlight">\(F_b &lt; 0\)</span> and the force pulls the atoms
\emph{toward} each other to restore the equilibrium distance.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(r_{ij} &lt; r_0\)</span>, the bond is compressed:
<span class="math notranslate nohighlight">\(r_{ij} - r_0 &lt; 0\)</span>, so <span class="math notranslate nohighlight">\(F_b &gt; 0\)</span> and the force pushes the atoms
\emph{apart}.</p></li>
</ul>
<p><strong>Example</strong>.</p>
<p>In an all-atom force field, a typical stiff covalent bond might use
<span class="math notranslate nohighlight">\(k_b \sim 10^3\)</span> (in reduced units) so that the bond length fluctuates only
slightly around <span class="math notranslate nohighlight">\(r_0\)</span> during the simulation.</p>
</section>
<section id="fene-finite-extensible-nonlinear-elastic">
<h3><span class="section-number">2.4.1.2. </span>FENE (Finite Extensible Nonlinear Elastic)<a class="headerlink" href="#fene-finite-extensible-nonlinear-elastic" title="Link to this heading">#</a></h3>
<p>For polymers and coarse-grained models it is often desirable to prevent bonds from stretching arbitrarily far. The FENE potential does exactly this:</p>
<p><span class="math notranslate nohighlight">\( U(r) = -\frac{1}{2}k r_0^2 \ln\left(1 - \left(\frac{r}{r_0}\right)^2\right) \)</span></p>
<p>Diverges at <span class="math notranslate nohighlight">\(r_0\)</span>, minimum at 0. This is usually used in conjuction with a repulsive, short-ranged force (WCA = cut LJ at minimum and shift up to get a purely repulsive potential).<span id="id1"><sup><a class="reference internal" href="../references/references.html#id26" title="John D Weeks, David Chandler, and Hans C Andersen. Role of repulsive forces in determining the equilibrium structure of simple liquids. The Journal of Chemical Physics, 54(12):5237–5247, 1971.">43</a></sup></span></p>
<p>with parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k_f\)</span> — FENE spring constant,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_0\)</span> — maximum bond extension.</p></li>
</ul>
<p>Key properties:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(U_b^{\text{FENE}}\)</span> has a minimum at <span class="math notranslate nohighlight">\(r_{ij}=0\)</span>.</p></li>
<li><p>As <span class="math notranslate nohighlight">\(r_{ij} \to R_0\)</span>, the logarithm diverges and the potential
goes to <span class="math notranslate nohighlight">\(+\infty\)</span>:
the bond cannot extend beyond <span class="math notranslate nohighlight">\(R_0\)</span> (<em>finite extensibility</em>).</p></li>
<li><p>For moderate extensions (<span class="math notranslate nohighlight">\(r_{ij} \ll R_0\)</span>), the potential is roughly
quadratic and behaves similarly to a harmonic spring.</p></li>
</ul>
<p>In practice FENE bonds are almost always combined with a short-range repulsive nonbonded potential (e.g.\ a Weeks–Chandler–Andersen or purely repulsive Lennard–Jones) so that the overall interaction has a finite minimum at a nonzero distance. A widely used parameter set in coarse-grained polymer
simulations is :</p>
<p><span class="math notranslate nohighlight">\(k_f = 30\)</span>, <span class="math notranslate nohighlight">\(r_0 = 1.5\)</span></p>
<p>(in reduced Lennard–Jones units), which allows bonds to stretch up to about 1.5 times their typical length before the potential diverges.</p>
<p><strong>Example.</strong>
In the Kremer–Grest polymer model, beads connected by FENE+WCA bonds behave like flexible springs that can fluctuate but never break, making them ideal for studying polymer melts and entangled chains.<span id="id2"><sup><a class="reference internal" href="../references/references.html#id27" title="Kurt Kremer and Gary S Grest. Dynamics of entangled linear polymer melts: a molecular-dynamics simulation. The Journal of Chemical Physics, 92(8):5057–5086, 1990.">15</a></sup></span></p>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="s1">&#39;../_matplotlib/book.mplstyle&#39;</span><span class="p">])</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Define parameters for the potentials</span>
<span class="n">k_harmonic</span> <span class="o">=</span> <span class="mf">850.0</span>  <span class="c1"># Harmonic bond constant</span>
<span class="n">r0_harmonic</span> <span class="o">=</span> <span class="mf">0.96</span>  <span class="c1"># Harmonic equilibrium bond length</span>

<span class="n">k_fene</span> <span class="o">=</span> <span class="mf">30.0</span>      <span class="c1"># FENE bond constant</span>
<span class="n">R0_fene</span> <span class="o">=</span> <span class="mf">1.5</span>      <span class="c1"># FENE maximum bond extension</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Define the range of bond distances (r)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span> <span class="c1"># Adjust range based on potential parameters</span>

<span class="n">V_harmonic</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k_harmonic</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r0_harmonic</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">arg_fene</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">R0_fene</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">V_fene</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">k_fene</span> <span class="o">*</span> <span class="n">R0_fene</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">arg_fene</span><span class="p">)</span>

<span class="n">V_fene_wca</span> <span class="o">=</span> <span class="n">V_fene</span>
<span class="n">r_rep</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">r</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">V_fene_wca</span><span class="p">[</span><span class="n">r</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="o">*</span><span class="p">((</span><span class="n">sigma</span><span class="o">/</span><span class="n">r_rep</span><span class="p">)</span><span class="o">**</span><span class="mi">12</span><span class="o">-</span><span class="p">(</span><span class="n">sigma</span><span class="o">/</span><span class="n">r_rep</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span> <span class="n">epsilon</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_harmonic</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">V_harmonic</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;harmonic&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_fene_wca</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">V_fene_wca</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FENE+WCA&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$r$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$U_{\mathrm</span><span class="si">{bond}</span><span class="s1">}(r)-U_\mathrm</span><span class="si">{min}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">axs</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./_figures/FENE_bond.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:31: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:31: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_2185/912570185.py:31: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  axs.set_ylabel(&#39;$U_{\mathrm{bond}}(r)-U_\mathrm{min}$&#39;)
</pre></div>
</div>
<img alt="../_images/735b873e66e986296ee0bdb0ced125639e92b67d0737e253aed71d6092b749d5.png" src="../_images/735b873e66e986296ee0bdb0ced125639e92b67d0737e253aed71d6092b749d5.png" />
</div>
</details>
</div>
<figure class="align-center" id="fene-bond-fig">
<a class="reference internal image-reference" href="../_images/FENE_bond.png"><img alt="Plot of the harmonic bond potential and force" src="../_images/FENE_bond.png" style="width: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2.15 </span><span class="caption-text">FENE+WCA bond potential with standard parameters <span class="math notranslate nohighlight">\(R_0=1.5\)</span> and <span class="math notranslate nohighlight">\(k=30\)</span> compared to a harmonic bond potential with <span class="math notranslate nohighlight">\(r_0=0.96\)</span> and <span class="math notranslate nohighlight">\(k=850\)</span>.</span><a class="headerlink" href="#fene-bond-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="angle-potentials">
<h2><span class="section-number">2.4.2. </span>Angle Potentials<a class="headerlink" href="#angle-potentials" title="Link to this heading">#</a></h2>
<p>The <strong>angle</strong> between three particles <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, and <span class="math notranslate nohighlight">\(k\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[
\cos \theta_{ijk} = \frac{(\vec{r}_{ji} \cdot \vec{r}_{jk})}{|\vec{r}_{ji}||\vec{r}_{jk}|} = - \frac{(\vec{r}_{ij} \cdot \vec{r}_{jk})}{|\vec{r}_{ij}||\vec{r}_{jk}|}\quad .
\]</div>
<figure class="align-center" id="angle-def-fig">
<a class="reference internal image-reference" href="../_images/angle.png"><img alt="Definition of angle ." src="../_images/angle.png" style="width: 200px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2.16 </span><span class="caption-text">Definition of angle.</span><a class="headerlink" href="#angle-def-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Note the negative sign, i.e the two bond vectors point out from the middle particle <span class="math notranslate nohighlight">\(j\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In polymers, angle θ is sometimes defined as the outer angle. This is less common in atomistic models, but be careful!</p>
<figure class="align-center" id="angle2-def-fig">
<a class="reference internal image-reference" href="../_images/outer-angle.png"><img alt="Definition of angle." src="../_images/outer-angle.png" style="width: 200px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2.17 </span><span class="caption-text">Alternative definition of angle as the outer angle.</span><a class="headerlink" href="#angle2-def-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>These two definitions can be easily converted into each other     <span class="math notranslate nohighlight">\(\theta_{ijk} = \pi - \theta'_{ijk}\)</span>. This is just a different convention, but it matters when specifying equilibrium
angles and when interpreting the potential. Computing <span class="math notranslate nohighlight">\(\theta_{ijk}\)</span> explicitly requires an <span class="math notranslate nohighlight">\(\arccos\)</span> operation, which is relatively expensive. Many force fields therefore write angle potentials
directly in terms of <span class="math notranslate nohighlight">\(\cos\theta_{ijk}\)</span> to avoid calling <span class="math notranslate nohighlight">\(\arccos\)</span> inside tight inner loops.</p>
</div>
<p>To compute the angle potential between three particles, we need to:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
F_i &amp;= -\nabla_i U_\theta (\theta_{ijk}) \\
    &amp;= - \frac{\partial U_\theta}{\partial \theta_{ijk}} \,\nabla_i \theta_{ijk}, \\
\text{where } - \frac{\partial U_\theta}{\partial \theta_{ijk}} &amp;= F_\theta \, .
\end{aligned}
\end{split}\]</div>
<p>Getting <span class="math notranslate nohighlight">\(\cos^{-1}\)</span> is computationally expensive, which would be needed above.
Once can try to avoid that by using the chain rule:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
F_i &amp;= - \frac{\partial U_\theta}{\partial \theta_{ijk}} \nabla_i \theta_{ijk} \\
    &amp;= F_\theta \frac{\partial \theta_{ijk}}{\partial \cos(\theta_{ijk})} \nabla_i \cos\theta_{ijk} \\
    &amp;= -F_\theta \frac{1}{\sin(\theta_{ijk})} \nabla_i \cos\theta_{ijk} \, .
\end{aligned}
\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(F_\theta = -\partial U_\theta / \partial \theta_{ijk}\)</span>.
The explicit expression for <span class="math notranslate nohighlight">\(\nabla_i \cos\theta_{ijk}\)</span> is algebraically long, so in practice one reuses known formulas from the literature or trusted implementations.</p>
<p>One must also be careful with units: some force fields use <em>degrees</em> in the input files and convert internally to radians when evaluating the potential.</p>
<p>For this, we then need <span class="math notranslate nohighlight">\( \nabla_i \cos\theta_{ijk}\)</span>. Eq. 7 of <a class="reference external" href="https://doi.org/10.1063/1.4985251">J. Chem. Phys. 146, 226101 (2017)</a><span id="id3"><sup><a class="reference internal" href="../references/references.html#id19" title="Michael P Howard, Antonia Statt, and Athanassios Z Panagiotopoulos. Note: smooth torsional potentials for degenerate dihedral angles. The Journal of chemical physics, 2017.">13</a></sup></span> offers a compact form.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><span class="math notranslate nohighlight">\(F_i\)</span> is singlular if <span class="math notranslate nohighlight">\(\theta_{ijk}=0^\circ\)</span> or <span class="math notranslate nohighlight">\(180^\circ\)</span> if <span class="math notranslate nohighlight">\(F_\theta\)</span> is not zero at these points!</p>
</div>
<section id="id4">
<h3><span class="section-number">2.4.2.1. </span>Harmonic<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>The harmonic angle potential mirrors the harmonic bond:</p>
<div class="math notranslate nohighlight">
\[
U_\theta(\theta) = \frac{k}{2} (\theta - \theta_O)^2
\]</div>
<p>Here:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\theta_0\)</span> is the equilibrium angle (straight line: <span class="math notranslate nohighlight">\(180^\circ\)</span>,
tetrahedral: <span class="math notranslate nohighlight">\(\approx 109.5^\circ\)</span>, etc.),</p></li>
<li><p><span class="math notranslate nohighlight">\(k_\theta\)</span> is the angle force constant, controlling how stiffly the molecule resists bending away from <span class="math notranslate nohighlight">\(\theta_0\)</span></p></li>
</ul>
<p>Harmonic angle potentia fixes average angle around set point of <span class="math notranslate nohighlight">\(\theta_0\)</span>. Like with the harmonic bond potential, whatch for the factor of two in the spring constant.</p>
<p><strong>Interpretation.</strong></p>
<ul class="simple">
<li><p>Near <span class="math notranslate nohighlight">\(\theta_0\)</span> the distribution of angles is approximately Gaussian.</p></li>
<li><p>Larger <span class="math notranslate nohighlight">\(k_\theta\)</span> means narrower fluctuations (stiffer angle).</p></li>
<li><p>The same “factor of <span class="math notranslate nohighlight">\(1/2\)</span>” remark as for harmonic bonds applies here:
check whether your simulation package includes it in the definition of
<span class="math notranslate nohighlight">\(k_\theta\)</span> or not.</p></li>
</ul>
</section>
<section id="cosine">
<h3><span class="section-number">2.4.2.2. </span>Cosine<a class="headerlink" href="#cosine" title="Link to this heading">#</a></h3>
<p>A common alternative that avoids computing <span class="math notranslate nohighlight">\(\arccos\)</span> is a cosine angle potential. One simple form is:</p>
<div class="math notranslate nohighlight">
\[
U_\theta(\theta) = k (1 + \cos{\theta})
\]</div>
<p>Minimum is when the particles are in colinear <span class="math notranslate nohighlight">\(\theta =180^\circ\)</span> arrangement. There are forms with a set angle different from that, by using <span class="math notranslate nohighlight">\(k (1 - \cos{(\theta - \theta_0)}) \)</span> as functional form.</p>
<p>More generally, we can allow an arbitrary equilibrium angle by shifting:</p>
<div class="math notranslate nohighlight">
\[
U_\theta^{\cos}(\theta)
= k_\theta \left[ 1 - \cos(\theta - \theta_0) \right].
\]</div>
<p>Here the minimum is located at <span class="math notranslate nohighlight">\(\theta = \theta_0\)</span>.
In both cases the potential depends smoothly on <span class="math notranslate nohighlight">\(\cos\theta\)</span>, which is
straightforward to compute from the dot product of bond vectors.</p>
<p><strong>Practical point.</strong>
Cosine angle forms are often preferred in coarse-grained models because the force expressions are simpler and cheaper than those obtained from a harmonic potential written in terms of <span class="math notranslate nohighlight">\(\theta\)</span> itself.</p>
</section>
<section id="cosine-squared">
<h3><span class="section-number">2.4.2.3. </span>Cosine squared<a class="headerlink" href="#cosine-squared" title="Link to this heading">#</a></h3>
<p>A third popular choice is the cosine-squared potential:</p>
<div class="math notranslate nohighlight">
\[
U_\theta(\theta) = \frac{k}{2} (\cos\theta - \cos\theta_O)^2
\]</div>
<p>This form has several nice properties:</p>
<ul class="simple">
<li><p>It has a minimum at <span class="math notranslate nohighlight">\(\theta = \theta_0\)</span>.</p></li>
<li><p>The potential is symmetric around <span class="math notranslate nohighlight">\(\theta_0\)</span> when expressed in terms of
<span class="math notranslate nohighlight">\(\cos\theta\)</span>.</p></li>
<li><p>In some cases it naturally produces two symmetric minima (e.g.\ near <span class="math notranslate nohighlight">\(\theta_0\)</span> and <span class="math notranslate nohighlight">\(\pi-\theta_0\)</span>) when combined with other constraints.</p></li>
</ul>
<p>Cosine-squared forms appear in various coarse-grained force fields where the
angle potential is expressed entirely in terms of <span class="math notranslate nohighlight">\(\cos\theta\)</span>.</p>
<p>Watch out for the exact definition of the parameters, sometimes <span class="math notranslate nohighlight">\(1/2\)</span> is included in the definition of <span class="math notranslate nohighlight">\(k\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For specific models and force fields, always check if the angles are given in degree or radians.</p>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="s1">&#39;../_matplotlib/book.mplstyle&#39;</span><span class="p">])</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Define the range of angles (in radians)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>  <span class="c1"># From 0 to pi radians</span>

<span class="c1"># Define potential parameters (example values)</span>
<span class="n">k_harmonic</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Force constant for harmonic potential</span>
<span class="n">theta_0_harmonic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># Equilibrium angle for harmonic potential</span>

<span class="n">k_cosine</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Pre-factor for cosine potential</span>
<span class="n">theta_0_cosine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1"># Equilibrium angle for cosine potential</span>

<span class="n">k_cosine_squared</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Pre-factor for cosine-squared potential</span>
<span class="n">theta_0_cosine_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1"># Equilibrium angle for cosine-squared potential</span>

<span class="c1"># Calculate the potentials</span>
<span class="n">harmonic_potential</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k_harmonic</span> <span class="o">*</span> <span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">theta_0_harmonic</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">cosine_potential</span> <span class="o">=</span> <span class="n">k_cosine</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">theta_0_cosine</span><span class="p">))</span> <span class="c1"># Often defined as 1-cos(theta) for a minimum at theta=theta_0</span>
<span class="n">cosine_squared_potential</span> <span class="o">=</span> <span class="n">k_cosine_squared</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">theta_0_cosine_squared</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># Often defined as 1-cos^2(theta) for a minimum at theta=theta_0</span>

<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">harmonic_potential</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Harmonic Potential&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">cosine_potential</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cosine Potential&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">cosine_squared_potential</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cosine Squared Potential&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Angle (radians)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Potential Energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of Angle Potentials&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./_figures/angle_potentials.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/77324d6601039ccbbe218779c11af9159325878b7e3a11c85bbdd12db85c3536.png" src="../_images/77324d6601039ccbbe218779c11af9159325878b7e3a11c85bbdd12db85c3536.png" />
</div>
</details>
</div>
<figure class="align-center" id="angle-comp-fig">
<a class="reference internal image-reference" href="../_images/angle_potentials.png"><img alt="Plot of different angle potentials" src="../_images/angle_potentials.png" style="width: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2.18 </span><span class="caption-text">Comparison of harmonic, cosine, and cosine-squared angle potentials, all with an angle constant <span class="math notranslate nohighlight">\(k=1\)</span> and a set angle <span class="math notranslate nohighlight">\(\theta_0\)</span> of <span class="math notranslate nohighlight">\(\pi/2\)</span>.</span><a class="headerlink" href="#angle-comp-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="dihedral-potentials">
<h2><span class="section-number">2.4.3. </span>Dihedral Potentials<a class="headerlink" href="#dihedral-potentials" title="Link to this heading">#</a></h2>
<p><strong>Torsional</strong> or <strong>dihedral</strong> angles are defined as shown in <a class="reference internal" href="#dihedral-def-fig"><span class="std std-numref">Fig. 2.19</span></a>. Dihedral (torsional) angles involve four atoms <span class="math notranslate nohighlight">\(i,j,k,\ell\)</span>. They are defined via the angle between the two planes spanned by <span class="math notranslate nohighlight">\((i,j,k)\)</span> and <span class="math notranslate nohighlight">\((j,k,\ell)\)</span> (see Fig.~<a class="reference internal" href="#dihedral-def-fig"><span class="std std-numref">Fig. 2.19</span></a>). Equivalently, one can ``look down’’ the central bond <span class="math notranslate nohighlight">\(j\)</span>–<span class="math notranslate nohighlight">\(k\)</span> and measure the rotation of atom <span class="math notranslate nohighlight">\(i\)</span> relative to atom <span class="math notranslate nohighlight">\(\ell\)</span>.</p>
<figure class="align-center" id="dihedral-def-fig">
<a class="reference internal image-reference" href="../_images/dihedral.png"><img alt="Definition of dihedral or torsional angle." src="../_images/dihedral.png" style="width: 250px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2.19 </span><span class="caption-text">Definition of dihedral or torsional angle.</span><a class="headerlink" href="#dihedral-def-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Angle between two plane (A,B) normals:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \vec{n}_A = \vec{r}_{ij} \times \vec{r}_{jk} \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\( \vec{n}_B = \vec{r}_{jk} \times \vec{r}_{kl} \)</span></p></li>
</ul>
<p>Then the angle is</p>
<p><span class="math notranslate nohighlight">\(\varphi_{ijkl} = \frac{\vec n_A \cdot \vec n_B}{|n_A||n_B|}\)</span></p>
<p>Similar to the angle, alternative definitions exist, <span class="math notranslate nohighlight">\(\psi = \pi -\varphi\)</span>.</p>
<p>To compute dihedral forces on four particles, we need to compute</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
F_i &amp;= -\nabla_i U_\phi(\phi_{ijkl})\\
    &amp;= - \frac{\partial U_\phi}{\partial \phi_{ijkl}} \nabla_i \phi_{ijkl} \\
    &amp;= - \frac{\partial U_\phi}{\partial \phi_{ijkl}} 
       \frac{\partial \phi_{ijkl}}{\partial \cos(\phi_{ijkl})} \nabla_i \cos\phi_{ijkl} \\
    &amp;= -F_\phi \frac{1}{\sin(\phi_{ijkl})} \nabla_i \cos\phi_{ijkl} \, .
\end{aligned}
\end{split}\]</div>
<p>with: <span class="math notranslate nohighlight">\(F_\phi = -\partial U_\phi / \partial \phi_{ijkl}\)</span>.</p>
<p>The explicit expressions for the gradients are rather involved and are usually
taken from standard references rather than derived from scratch each time.</p>
<p><strong>Singular configurations.</strong>
Because of the <span class="math notranslate nohighlight">\(1 / \sin\phi_{ijkl}\)</span> factor, dihedral forces can become
singular at <span class="math notranslate nohighlight">\(\phi_{ijkl}=0^\circ\)</span> or <span class="math notranslate nohighlight">\(180^\circ\)</span> if <span class="math notranslate nohighlight">\(F_\phi\)</span> is nonzero there. Similarly, if either of the adjacent bond angles <span class="math notranslate nohighlight">\(\theta_{ijk}\)</span> or <span class="math notranslate nohighlight">\(\theta_{jk\ell}\)</span> becomes <span class="math notranslate nohighlight">\(0^\circ\)</span> or <span class="math notranslate nohighlight">\(180^\circ\)</span>, the two planes become ill-defined and the dihedral angle is degenerate. Realistic force fields and simulation conditions are chosen to avoid such problematic configurations or to make the potential smooth as these limits are approached.</p>
<p>This results in some involved computations, see Allen &amp; Tildesley<span id="id5"><sup><a class="reference internal" href="../references/references.html#id11" title="Michael P Allen, Dominic J Tildesley, and others. Computer simulation of liquids. 1987.">2</a></sup></span> for a step by step derivation in Appendix C.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The same singularities as for the angle forces show up at <span class="math notranslate nohighlight">\(\phi_{ijkl}=0^\circ\)</span> and <span class="math notranslate nohighlight">\(180^\circ\)</span> but one can eliminate them (details in <a class="reference external" href="https://doi.org/10.1002/(SICI)1096-987X(19960715)17:9%3C1132::AID-JCC5%3E3.0.CO;2-T">Bondel, Karplus, J. Comput. Chem., 17: 1132-1141, 1996</a>)<span id="id6"><sup><a class="reference internal" href="../references/references.html#id18" title="Arnaud Blondel and Martin Karplus. New formulation for derivatives of torsion angles and improper torsion angles in molecular mechanics: elimination of singularities. Journal of computational chemistry, 17(9):1132–1141, 1996.">4</a></sup></span>.</p>
<p>However, <span class="math notranslate nohighlight">\(\phi\)</span> becomes also degenerate if <span class="math notranslate nohighlight">\(\theta_{ijk}\)</span> or <span class="math notranslate nohighlight">\(\theta_{jkl}\)</span> approaches <span class="math notranslate nohighlight">\(0^\circ\)</span> or <span class="math notranslate nohighlight">\(180^\circ\)</span> because the two planes to define the dihedral cannot be defined in these cases. This is important for models with “soft” interactions, where these configurations are possible, e.g. coarse-grained models.</p>
</div>
<section id="periodic">
<h3><span class="section-number">2.4.3.1. </span>Periodic<a class="headerlink" href="#periodic" title="Link to this heading">#</a></h3>
<p>A very common torsional form is the simple periodic function:</p>
<div class="math notranslate nohighlight">
\[
V_\phi(\phi_{ijkl}) = k_{\phi}(1 + \cos(n \phi - \phi_s)) \quad .
\]</div>
<p>Used in the CHARMM force field</p>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k_\phi\)</span> controls the barrier height,</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the multiplicity (number of minima per <span class="math notranslate nohighlight">\(360^\circ\)</span>),</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta\)</span> is a phase shift that moves the minima to the desired
dihedral angles.</p></li>
</ul>
<p>This form is used, for example, in the CHARMM force field.</p>
<p><strong>Example.</strong>
For a simple alkane C–C–C–C dihedral, one often chooses <span class="math notranslate nohighlight">\(n=3\)</span> to generate three minima (one \emph{trans} and two \emph{gauche}) over <span class="math notranslate nohighlight">\(360^\circ\)</span>. The phase shift <span class="math notranslate nohighlight">\(\delta\)</span> is then chosen so that the global minimum corresponds to the chemically preferred conformation.</p>
</section>
<section id="ryckaert-bellemans">
<h3><span class="section-number">2.4.3.2. </span>Ryckaert-Bellemans<a class="headerlink" href="#ryckaert-bellemans" title="Link to this heading">#</a></h3>
<p>The Ryckaert–Bellemans (RB) form is widely used for alkanes and other chain molecules:</p>
<div class="math notranslate nohighlight">
\[
V_{\phi}(\phi_{ijkl}) = \sum_{n=0}^5 C_n( \cos(\psi ))^n, \text{ where } \psi = \phi -180^\circ\quad .
\]</div>
<p>The coefficients <span class="math notranslate nohighlight">\(C_n\)</span> are parameters fitted so that the torsion potential reproduces quantum chemistry data or experimental observables.</p>
<p><strong>Interpretation.</strong></p>
<ul class="simple">
<li><p>This is effectively a polynomial in <span class="math notranslate nohighlight">\(\cos\psi\)</span> and can approximate
fairly complicated periodic shapes.</p></li>
<li><p>Shifting by <span class="math notranslate nohighlight">\(\pi\)</span> (using <span class="math notranslate nohighlight">\(\psi\)</span>) is convenient for alkanes where
the \emph{trans} conformation near <span class="math notranslate nohighlight">\(180^\circ\)</span> is often of special
interest.</p></li>
</ul>
<p>The RB form is mathematically closely related to a truncated Fourier series, as we will see next.</p>
</section>
<section id="fourier">
<h3><span class="section-number">2.4.3.3. </span>Fourier<a class="headerlink" href="#fourier" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
V_{F} (\phi_{ijkl})= \frac{1}{2} \sum_{n=1}^4 C_n (1-(-1)^n\cos(n\phi))
\]</div>
<ul class="simple">
<li><p>Used in the OPLS force field. Each term with index <span class="math notranslate nohighlight">\(n\)</span> contributes a periodic component with <span class="math notranslate nohighlight">\(n\)</span> minima or maxima per <span class="math notranslate nohighlight">\(360^\circ\)</span>, and the <span class="math notranslate nohighlight">\((-1)^n\)</span> factor flips the sign of the contribution depending on <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
<li><p>There is a direct mapping between the Fourier coefficients <span class="math notranslate nohighlight">\(C_n\)</span> and the Ryckaert–Bellemans coefficients via trigonometric identities. In practice, force fields may be parameterized in one representation and converted to the other depending on the software.</p></li>
</ul>
</section>
</section>
<section id="improper-dihedrals">
<h2><span class="section-number">2.4.4. </span>Improper Dihedrals<a class="headerlink" href="#improper-dihedrals" title="Link to this heading">#</a></h2>
<p>In addition to the dihedrals defined between four bounded particles in a row, there are also
so called <strong>improper</strong> dihedrals, that can be applied to keep planar groups planar, or prevent flipping into mirror images. These are commonly applied between four points in configurations as sketched in <a class="reference internal" href="#improper-dihedral-fig"><span class="std std-numref">Fig. 2.20</span></a>.</p>
<figure class="align-center" id="improper-dihedral-fig">
<a class="reference internal image-reference" href="../_images/improper_dihedral.png"><img alt="Improper dihedral configuration." src="../_images/improper_dihedral.png" style="width: 100px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2.20 </span><span class="caption-text">Configuration to which an improper dihedral can be applied to.</span><a class="headerlink" href="#improper-dihedral-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The functional form is often a simple harmonic potential in the improper dihedral angle <span class="math notranslate nohighlight">\(\xi\)</span>:</p>
<div class="math notranslate nohighlight">
\[
U_{\text{imp}}(\xi)
= \frac{1}{2} k_{\text{imp}} (\xi - \xi_0)^2 ,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\xi_0\)</span> is usually <span class="math notranslate nohighlight">\(0^\circ\)</span> (to enforce planarity) or some other
target angle.</p>
<p><strong>Typical uses.</strong></p>
<ul class="simple">
<li><p>Keeping aromatic rings or peptide planes planar.</p></li>
<li><p>Preventing a stereocenter from flipping into its mirror image.</p></li>
<li><p>Stabilizing certain local geometries that are underdetermined by
normal bonds and angles alone.</p></li>
</ul>
<p>Mathematically, the computation of improper dihedral forces is very similar to that for proper dihedrals; only the connectivity pattern of the four atoms differs.</p>
</section>
<section id="references">
<h2><span class="section-number">2.4.5. </span>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
</section>
<section id="id7">
<h2><span class="section-number">2.4.6. </span>References<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Allen, Michael P., and Dominic J. Tildesley. <em>Computer Simulation of Liquids</em>. Clarendon Press, Oxford (1987). Appendix C.2: “Calculation of forces and torques.” <span id="id8"><sup><a class="reference internal" href="../references/references.html#id11" title="Michael P Allen, Dominic J Tildesley, and others. Computer simulation of liquids. 1987.">2</a></sup></span></p></li>
<li><p>Howard, Michael P., Antonia Statt, and Athanassios Z. Panagiotopoulos. “Note: Smooth torsional potentials for degenerate dihedral angles.” <em>The Journal of Chemical Physics</em> 146, 226101 (2017). <span id="id9"><sup><a class="reference internal" href="../references/references.html#id19" title="Michael P Howard, Antonia Statt, and Athanassios Z Panagiotopoulos. Note: smooth torsional potentials for degenerate dihedral angles. The Journal of chemical physics, 2017.">13</a></sup></span></p></li>
<li><p>Blondel, Arnaud, and Martin Karplus. “New formulation for derivatives of torsion angles and improper torsion angles in molecular mechanics: Elimination of singularities.” <em>Journal of Computational Chemistry</em> 17, 1132–1141 (1996). <span id="id10"><sup><a class="reference internal" href="../references/references.html#id18" title="Arnaud Blondel and Martin Karplus. New formulation for derivatives of torsion angles and improper torsion angles in molecular mechanics: elimination of singularities. Journal of computational chemistry, 17(9):1132–1141, 1996.">4</a></sup></span></p></li>
<li><p>Weeks, John D., David Chandler, and Hans C. Andersen. “Role of repulsive forces in determining the equilibrium structure of simple liquids.” <em>The Journal of Chemical Physics</em> 54, 5237–5247 (1971). <span id="id11"><sup><a class="reference internal" href="../references/references.html#id26" title="John D Weeks, David Chandler, and Hans C Andersen. Role of repulsive forces in determining the equilibrium structure of simple liquids. The Journal of Chemical Physics, 54(12):5237–5247, 1971.">43</a></sup></span></p></li>
<li><p>Kremer, Kurt, and Gary S. Grest. “Dynamics of entangled linear polymer melts: A molecular-dynamics simulation.” <em>The Journal of Chemical Physics</em> 92, 5057–5086 (1990). <span id="id12"><sup><a class="reference internal" href="../references/references.html#id27" title="Kurt Kremer and Gary S Grest. Dynamics of entangled linear polymer melts: a molecular-dynamics simulation. The Journal of Chemical Physics, 92(8):5057–5086, 1990.">15</a></sup></span></p></li>
<li><p>GROMACS development team. <em>GROMACS Reference Manual</em>: “Bonded interactions” section. (Accessed 2025.) <span id="id13"><sup><a class="reference internal" href="../references/references.html#id28" title="GROMACS development team. Gromacs reference manual: bonded interactions. https://manual.gromacs.org/current/reference-manual/functions/bonded-interactions.html, 2025.">47</a></sup></span></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./molecular-models-and-interactions"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="periodic-boundary-conditions.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2.3. </span>Periodic Boundary Conditions</p>
      </div>
    </a>
    <a class="right-next"
       href="short-ranged-potentials.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.5. </span>Short-Ranged Intramolecular Potentials</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bond-potentials">2.4.1. Bond Potentials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonic">2.4.1.1. Harmonic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fene-finite-extensible-nonlinear-elastic">2.4.1.2. FENE (Finite Extensible Nonlinear Elastic)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#angle-potentials">2.4.2. Angle Potentials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.4.2.1. Harmonic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cosine">2.4.2.2. Cosine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cosine-squared">2.4.2.3. Cosine squared</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dihedral-potentials">2.4.3. Dihedral Potentials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic">2.4.3.1. Periodic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ryckaert-bellemans">2.4.3.2. Ryckaert-Bellemans</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier">2.4.3.3. Fourier</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#improper-dihedrals">2.4.4. Improper Dihedrals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">2.4.5. References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">2.4.6. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Antonia Statt
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>