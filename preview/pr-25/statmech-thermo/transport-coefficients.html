
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.7. Transport Coefficients &#8212; Atomistic Scale Simulations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/image_dark_mode.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myadmonitions.css?v=5b3d7684" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=80cd6c28" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"d": ["{\\operatorname{d}\\!{#1}}", 1], "dd": ["{\\d{}^{#1} #2 \\over \\d{#3}^{#1}}", 3], "pp": ["{\\partial^{#1} #2 \\over \\partial #3^{#1}}", 3], "td": ["{\\left(\\pp{#1}{#2}{#3} \\right)_{#4}}", 4], "ubar": ["\\underline{#1}", 1], "vv": ["\\mathbf{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'statmech-thermo/transport-coefficients';</script>
    <link rel="canonical" href="https://stattlab.github.io/atomistic-scale-simulations/statmech-thermo/transport-coefficients.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.8. Statistical Errors" href="statistical-errors.html" />
    <link rel="prev" title="3.6. Structural Correlations" href="structural-correlations.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Atomistic Scale Simulations</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/index.html">1. Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/why-atomistic-scale.html">1.1. Why are we interested in the atomistic scale?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/what-are-simulations.html">1.2. What are Simulations?</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecular-models-and-interactions/index.html">2. Molecular Models and Interactions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/molecular-models.html">2.2. Molecular Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/periodic-boundary-conditions.html">2.3. Periodic Boundary Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/intramolecular-potentials.html">2.4. Intermolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/short-ranged-potentials.html">2.5. Short-Ranged Intramolecular Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-models-and-interactions/electrostatics.html">2.6. Long-Range Potentials</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">3. Statistical Mechanics and Thermodynamics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">3.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensembles.html">3.2. Thermodyanmics and Ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="statmech-ergodicity.html">3.3. Statistical Mechanics: Ensembles, Ergodicity and other Stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermodynamic-properties.html">3.4. Thermodyanmics Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="entropy-temperature.html">3.5. Entropy and Temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="structural-correlations.html">3.6. Structural Correlations</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.7. Transport Coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="statistical-errors.html">3.8. Statistical Errors</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecular-dynamics/index.html">4. Molecular Dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/introduction.html">4.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/verlet-integration.html">4.2. Verlet Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/thermostats.html">4.3. Thermostats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/langevin-dynamics.html">4.4. Langevin Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/md-packages.html">4.5. Using MD Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/neighbor-list.html">4.6. 4.6 Initialization and Neighbor Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecular-dynamics/high-performance-computing.html">4.7. HPC (High-Performance Computing)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../monte-carlo/index.html">5. Monte Carlo Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/introduction.html">5.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/random-numbers.html">5.2. 5.2 Random Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/monte-carlo-method.html">5.3. Monte Carlo Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/sampling.html">5.4. Sampling Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/phase-coexistence.html">5.5. Gibbs Ensemble and Phase Coexistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/finite-size.html">5.6. Phase Transitions, Finite-size Scaling and Renormalization Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/variance-reduction.html">5.7. Variance Reduction Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/metropolis.html">5.8. Metropolis Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/ising-model.html">5.9. The Ising Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/directed-mc.html">5.10. Directed Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/kinetic-mc.html">5.11. Kinetic Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte-carlo/free-energy-from-sims.html">5.12. Free Energy Estimation in Simulations</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../references/references.html">6. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">7. Credits</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/stattlab/atomistic-scale-simulations/issues/new?title=Issue%20on%20page%20%2Fstatmech-thermo/transport-coefficients.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/statmech-thermo/transport-coefficients.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Transport Coefficients</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-functions-for-dynamical-response">3.7.1. Correlation Functions for Dynamical Response</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-response-functions">3.7.1.1. Linear-Response Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#static-perturbation">3.7.1.2. Static perturbation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-constant">3.7.1.3. Diffusion Constant</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#response-to-a-time-varying-perturbation">3.7.1.4. Response to a time varying perturbation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-details-on-time-correlation-functions">3.7.1.5. Some Details on Time Correlation Functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-correlation-functions">3.7.2. 1. Time Correlation Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">3.7.2.1. Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ways-to-compute-autocorrelation">3.7.3. 2. Ways to Compute Autocorrelation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#methods">3.7.3.1. Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#brute-force-steps">3.7.3.2. Brute Force Steps</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#green-kubo-and-einstein-relations">3.7.4. 3. Green-Kubo and Einstein Relations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#green-kubo-formula">3.7.4.1. Green-Kubo Formula</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#einstein-relation">3.7.4.2. Einstein Relation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion">3.7.5. 4. Diffusion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-coefficient-d">3.7.5.1. Diffusion Coefficient ( D )</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-walker-in-1d">3.7.5.2. Random Walker in 1D</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="transport-coefficients">
<h1><span class="section-number">3.7. </span>Transport Coefficients<a class="headerlink" href="#transport-coefficients" title="Link to this heading">#</a></h1>
<section id="correlation-functions-for-dynamical-response">
<h2><span class="section-number">3.7.1. </span>Correlation Functions for Dynamical Response<a class="headerlink" href="#correlation-functions-for-dynamical-response" title="Link to this heading">#</a></h2>
<p>This section continues the discussion of the calculation of properties, in particular the calculation of dynamical properties and the response to perturbation. For static properties it would probably be more convenient to do Monte Carlo methods since they are more robust. Dynamics is the reason that we do MD.</p>
<section id="linear-response-functions">
<h3><span class="section-number">3.7.1.1. </span>Linear-Response Functions<a class="headerlink" href="#linear-response-functions" title="Link to this heading">#</a></h3>
<p>The simplest dynamical properties are the linear response to an external perturbation. Most macroscopic measurements are in the linear regime because macroscopic perturbations are very small on the scale of microscopic forces.</p>
<p>Onsager’s made a well known conjecture (1935), called the Regression Hypothesis. (also known as the fluctuation-dissipation theorem.) It states that the linear response of the system to a time-varying perturbation is the same as fluctuations that naturally occur in statistical equilibrium. So there are 2 basic ways to calculate response: either wait for the system to fluctuate by itself or apply a perturbation and see what happens. (the first is often referred to as the Kubo method.)</p>
</section>
<section id="static-perturbation">
<h3><span class="section-number">3.7.1.2. </span>Static perturbation<a class="headerlink" href="#static-perturbation" title="Link to this heading">#</a></h3>
<p>First let us consider static perturbations. Suppose our total Hamiltonian has the form:</p>
<div class="math notranslate nohighlight">
\[
H = H0 + c A
\]</div>
<p>where H0 is the unperturbed Hamiltonian, A is a perturbation and ‘c’ is the coupling constant. As shown on the formula page one can write the free energy as a power series in ‘c’. The linear response is simply the expectation of A in the unperturbed system. The second order term is the fluctuation about the mean. In fact if we neglect all terms above the first order we always get an upper bound to the free energy. Finally to calculate the free energy difference between the system at c=0 and c=1 we just need to integrate the average A over ensembles for various values of c between 0 and 1.</p>
<p>We can also find the response of some property (B) to the perturbation; it equals the correlation between A and B.</p>
<p>In class I did the application of cutting off the potential. Generally one expects that if the neglected potential is smooth it is pretty much independent of the phase space point R, and hence terms higher order than first can be neglected.</p>
<p>A second example is to apply a sinusoidal potential and look at the response of the density. It is simply S k, the structure factor. That is essentially how neutrons and X-rays measure the structure factor.</p>
</section>
<section id="diffusion-constant">
<h3><span class="section-number">3.7.1.3. </span>Diffusion Constant<a class="headerlink" href="#diffusion-constant" title="Link to this heading">#</a></h3>
<p>Now consider the simplest dynamical experiment, mix two types of atoms and see how quickly diffusion makes the system a homogeneous mixture. The diffusion constant D, together with the diffusion equation, governs this process on a macroscopic scale. The Green’s function for the diffusion equation is a spreading Gaussian with the mean squared displacement equal to 6 D t. A little thought shows that a way to microscopically calculate D is to study the diffusion of a single atom. Again the equation is on the formula page. One can easily transform this expression to the integral of the velocity autocorrelation function.</p>
<p>The transformation assumes that one is using the <em>unwound or unwrapped coordinates</em>; the positions of the atoms such that:</p>
<div class="math notranslate nohighlight">
\[
r(t+h) = r(t) + h v(t) + ...
\]</div>
<p>Don’t use periodic boundary conditions to put particles back in the central cell.</p>
<p>One of the key discoveries in the early days of computer simulation was the long-time tails on the v-v function. by Alder and Wainwright. The v-v correlation functions decay algebraically in time. (as t-d/2) where d is the spatial dimension.) This implies that diffusion may not really exist in 2D. This is not Markovian (random) behavior which would decay exponentially in time. The momentum of a fast moving particle gets stored in the nearby liquid as a vortex and helps to keep it moving in the same direction for a very long time. (citation)</p>
</section>
<section id="response-to-a-time-varying-perturbation">
<h3><span class="section-number">3.7.1.4. </span>Response to a time varying perturbation<a class="headerlink" href="#response-to-a-time-varying-perturbation" title="Link to this heading">#</a></h3>
<p>If we measure the response to A of a perturbation B it is the correlation between A and the time derivative of B (or vice versa) which enters. The coefficent (called chi) or the susceptibility is the linear response, or transport coefficient. Some examples are the electrical and thermal conductivity, the bulk and shear viscosity, the mass diffusion coefficient and the dynamical structure factor. . In linear response the perturbation and the response are at the same frequency and wavelength. Macroscopically one is often interested in only the zero-frequency, zero-wavelength limit of the response. A peak at finite frequency shows the presence of a collective mode, for example a sound wave. The derivation of the fluctuation dissipation theorem is in many textbooks. The general result for a perturbation is</p>
<div class="math notranslate nohighlight">
\[
\chi(\omega)=\beta \int_0^{\infty} d t e^{i t \omega}\left\langle B(t) \frac{d A(0)}{d t}\right\rangle
\]</div>
<p>The dynamic structure factor is a key quantity (also known as the density-density response function). If you push the system at time and place (<strong>r</strong>,t) how does it respond at (<strong>r</strong>’,t’)? This is what neutron scattering does. It is not hard to see that sound waves of various kinds will show up as prominent features of Sk (<em>w</em>). The book The Theory of Simple Liquids by Hansen and MacDonald contains a thorough treatment of the theoretical properties of this function.</p>
</section>
<section id="some-details-on-time-correlation-functions">
<h3><span class="section-number">3.7.1.5. </span>Some Details on Time Correlation Functions<a class="headerlink" href="#some-details-on-time-correlation-functions" title="Link to this heading">#</a></h3>
<p>The Time correlation functions given by CAB(T)= &lt; A(t)B(t + T)&gt;. As this is an equilibrium property and it depends only on the time delay, T, this must be independent of time origin, t. This means that the function C(T) is stationary with respect to time origin, or d/dt C(T) = 0. This time-origin invariance can be seen as C(T)= &lt;A(t) B(t + T)&gt; = &lt;A(t + s) B(t + s + T)&gt;. Let s = -T, then C(T)= &lt;A(t - T) B(t)&gt;. In other words, you either shift B forward by time delay T, or A backwards by T, both are same average.</p>
<p>For T=0, C(0) = &lt;A(t)B(t)&gt;, and this is the time-averaged pair-correlation that we normally calculated for thermodynamic quantities, etc. Here it is important to note that for <strong>non-periodic</strong> or <strong>chaotic</strong> functions, limit of t-&gt; infinity C(0)=<A><B>, whereas for periodic functions (which are not ergodic) this is not true. Typically, we choose to normalized the time correlation functions by C(0), i.e. c(T)= C(T)/C(0), so that c(T) ranges from 1 to its uncorrelated value <A><B>/&lt;A(0)B(0)&gt;. Clearly, in cases where either <A> or <B> are zero, such as for a non-flowing (or a stationary center-of-mass) system of particles where A=v=velocity and <v>=0, c(T) varies from 1 at time zero to 0 at long times. It can be negative in between.</p>
<p>One of the most important correlations is the <strong>auto-correlation</strong> function, which is defined as &lt;A(t) A(t + T)&gt;, the time correlation of a function with itself. By considering &lt;(A(t + T) - A(t))2&gt; which is always positive definite, we may expand and find that it equals 2&lt;A2(t)&gt; - 2&lt;A(t)A(t + T)&gt;. Hence, the normalized auto-correlation function is bounded, i.e. |c(T)| &lt; or = 1. For dynamics, one example is that velocity-velocity autocorrelation functions Cvv(T)=&lt;vi(T) * vi(0)&gt;, which is related to the Diffusion coefficient. So Cvv(T) is 1 at T=0 and &lt;vi&gt;2 at long times. <strong>Importantly, for indistinguishable particles, statistical precision is improved greatly if one considers that average over all particles in the simulation</strong> , i.e. (<span class="math notranslate nohighlight">\(1/N) \sum_i &lt;(vi(T) \* vi(0 )&gt;\)</span>.</p>
</section>
</section>
<section id="time-correlation-functions">
<h2><span class="section-number">3.7.2. </span>1. Time Correlation Functions<a class="headerlink" href="#time-correlation-functions" title="Link to this heading">#</a></h2>
<p>Let ( X(t) ) be a fluctuating variable sampled at time ( t ). When are two samples “independent”?</p>
<ul class="simple">
<li><p>Autocorrelation function:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
C(t) = \langle X(0) X(t) \rangle
\]</div>
<ul class="simple">
<li><p>Normalized: ( C(0) = \langle X^2 \rangle ), and ( C(t) \to 0 ) as ( t \to \infty )</p></li>
</ul>
<p>An “independent” sample can be taken after a time ( \tau ) has passed, where ( C(\tau) ) is sufficiently small.</p>
<p>To improve averaging, use multiple <strong>independent time origins</strong>:</p>
<div class="math notranslate nohighlight">
\[
\langle X(t_0) X(t_0 + t) \rangle
\]</div>
<section id="example">
<h3><span class="section-number">3.7.2.1. </span>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h3>
<p>A random variable ( X ) is chosen every time step from a uniform distribution over ([-1, 1]).</p>
<ul class="simple">
<li><p>( \langle X^2 \rangle = \int_{-1}^1 x^2 \cdot \frac{1}{2} dx = \frac{1}{3} )</p></li>
<li><p>For two independent samples: ( \langle X(t_0) X(t_0 + 1) \rangle = 0 )</p></li>
<li><p>( \langle X(t_0) X(t_0 + 2) \rangle = 0 )</p></li>
</ul>
</section>
</section>
<section id="ways-to-compute-autocorrelation">
<h2><span class="section-number">3.7.3. </span>2. Ways to Compute Autocorrelation<a class="headerlink" href="#ways-to-compute-autocorrelation" title="Link to this heading">#</a></h2>
<section id="methods">
<h3><span class="section-number">3.7.3.1. </span>Methods<a class="headerlink" href="#methods" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>FFT (Fast Fourier Transform)</strong>: Efficient for computing ( C(t) ) over long times.</p></li>
<li><p><strong>Brute Force</strong>: Common for short-time correlations.</p></li>
</ul>
</section>
<section id="brute-force-steps">
<h3><span class="section-number">3.7.3.2. </span>Brute Force Steps<a class="headerlink" href="#brute-force-steps" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Choose ( X_i ) in data series as ( t_0 )</p></li>
<li><p>For ( j = i ) to ( i + \text{window} ):</p>
<ul class="simple">
<li><p>Accumulate ( C_{j-i} += X_i X_j )</p></li>
</ul>
</li>
<li><p>Advance to next origin ( i ) and repeat</p></li>
<li><p>Normalize: ( C_k = \frac{C_k}{N - k} )</p></li>
</ol>
</section>
</section>
<section id="green-kubo-and-einstein-relations">
<h2><span class="section-number">3.7.4. </span>3. Green-Kubo and Einstein Relations<a class="headerlink" href="#green-kubo-and-einstein-relations" title="Link to this heading">#</a></h2>
<p>Using <strong>linear response theory</strong> (small perturbations), we can show:</p>
<section id="green-kubo-formula">
<h3><span class="section-number">3.7.4.1. </span>Green-Kubo Formula<a class="headerlink" href="#green-kubo-formula" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
X = \int_0^\infty dt \, \langle A(0) A(t) \rangle
\]</div>
<ul class="simple">
<li><p>( X ): transport coefficient</p></li>
<li><p>( A(t) ): dynamic observable</p></li>
</ul>
</section>
<section id="einstein-relation">
<h3><span class="section-number">3.7.4.2. </span>Einstein Relation<a class="headerlink" href="#einstein-relation" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
X = \lim_{t \to \infty} \frac{1}{2t} \langle [A(t) - A(0)]^2 \rangle
\]</div>
<p>This is a <strong>fluctuation-dissipation relation</strong>.</p>
</section>
</section>
<section id="diffusion">
<h2><span class="section-number">3.7.5. </span>4. Diffusion<a class="headerlink" href="#diffusion" title="Link to this heading">#</a></h2>
<section id="diffusion-coefficient-d">
<h3><span class="section-number">3.7.5.1. </span>Diffusion Coefficient ( D )<a class="headerlink" href="#diffusion-coefficient-d" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
D = \lim_{t \to \infty} \frac{1}{2d} \frac{d}{dt} \langle [x(t) - x(0)]^2 \rangle
\]</div>
<p>If isotropic:</p>
<div class="math notranslate nohighlight">
\[
D = \frac{1}{3} (D_{xx} + D_{yy} + D_{zz})
\]</div>
<p>Or:</p>
<div class="math notranslate nohighlight">
\[
D = \lim_{t \to \infty} \frac{1}{2d} \langle \Delta x(t)^2 \rangle
\]</div>
</section>
<section id="random-walker-in-1d">
<h3><span class="section-number">3.7.5.2. </span>Random Walker in 1D<a class="headerlink" href="#random-walker-in-1d" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Hop left or right with ( p = \frac{1}{2} )</p></li>
<li><p>( \langle \Delta x \rangle = 0 )</p></li>
<li><p>( \langle \Delta x^2 \rangle = n l^2 ) (binomial distribution)</p></li>
</ul>
<p>Hence:</p>
<div class="math notranslate nohighlight">
\[
D = \frac{l^2}{2 \Delta t}
\]</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./statmech-thermo"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="structural-correlations.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3.6. </span>Structural Correlations</p>
      </div>
    </a>
    <a class="right-next"
       href="statistical-errors.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3.8. </span>Statistical Errors</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-functions-for-dynamical-response">3.7.1. Correlation Functions for Dynamical Response</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-response-functions">3.7.1.1. Linear-Response Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#static-perturbation">3.7.1.2. Static perturbation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-constant">3.7.1.3. Diffusion Constant</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#response-to-a-time-varying-perturbation">3.7.1.4. Response to a time varying perturbation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-details-on-time-correlation-functions">3.7.1.5. Some Details on Time Correlation Functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-correlation-functions">3.7.2. 1. Time Correlation Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">3.7.2.1. Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ways-to-compute-autocorrelation">3.7.3. 2. Ways to Compute Autocorrelation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#methods">3.7.3.1. Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#brute-force-steps">3.7.3.2. Brute Force Steps</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#green-kubo-and-einstein-relations">3.7.4. 3. Green-Kubo and Einstein Relations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#green-kubo-formula">3.7.4.1. Green-Kubo Formula</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#einstein-relation">3.7.4.2. Einstein Relation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion">3.7.5. 4. Diffusion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-coefficient-d">3.7.5.1. Diffusion Coefficient ( D )</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-walker-in-1d">3.7.5.2. Random Walker in 1D</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Antonia Statt
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>